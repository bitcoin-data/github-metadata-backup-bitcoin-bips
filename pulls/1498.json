{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/1498",
    "id": 1527704385,
    "node_id": "PR_kwDOAN28mc5bDutB",
    "html_url": "https://github.com/bitcoin/bips/pull/1498",
    "diff_url": "https://github.com/bitcoin/bips/pull/1498.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/1498.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/1498/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/1498/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1498/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/75dc363d201072579289cc6d20d40ef7a67db291",
    "number": 1498,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "bip324: Remove garbage authentication packet (breaking change)",
    "user": {
      "login": "real-or-random",
      "id": 1071625,
      "node_id": "MDQ6VXNlcjEwNzE2MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/real-or-random",
      "html_url": "https://github.com/real-or-random",
      "followers_url": "https://api.github.com/users/real-or-random/followers",
      "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
      "organizations_url": "https://api.github.com/users/real-or-random/orgs",
      "repos_url": "https://api.github.com/users/real-or-random/repos",
      "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/real-or-random/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "by merging it with the version packet. Or more accurately, by merging it with the first packet sent after garbage termination, which may be a decoy packet or the version packet.\r\n\r\nThe new protocol simplifies implementations:\r\n - A protocol state machine won't need separate states for garbage authentication and version phases.\r\n - The special case of \"ignoring the ignore bit\" is removed.\r\n - The freedom to choose the contents of the garbage authentication packet is removed. This simplifies testing.\r\n\r\nThe reason for having a separate garbage authentication packet was to materialize the separation of the key exchange phase and version negotiation phase even in the bytestream on the wire. However, this is not necessary, and arguably, these phases are still properly separated: Since the AEAD will ensure that AAD (=garbage) is checked before looking at the contents (=version), the peers won't interpret version data before having authenticated the garbage.",
    "labels": [],
    "created_at": "2023-09-24T13:30:04Z",
    "updated_at": "2023-09-28T15:54:56Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merge_commit_sha": "5f02787bc88ec9f8b958615ba4c95f9aa774eca1",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "real-or-random:202309-0324-garbauth",
      "ref": "202309-0324-garbauth",
      "sha": "75dc363d201072579289cc6d20d40ef7a67db291",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 45248362,
        "node_id": "MDEwOlJlcG9zaXRvcnk0NTI0ODM2Mg==",
        "name": "bips",
        "full_name": "real-or-random/bips",
        "owner": {
          "login": "real-or-random",
          "id": 1071625,
          "node_id": "MDQ6VXNlcjEwNzE2MjU=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/real-or-random",
          "html_url": "https://github.com/real-or-random",
          "followers_url": "https://api.github.com/users/real-or-random/followers",
          "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
          "organizations_url": "https://api.github.com/users/real-or-random/orgs",
          "repos_url": "https://api.github.com/users/real-or-random/repos",
          "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/real-or-random/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/real-or-random/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/real-or-random/bips",
        "archive_url": "https://api.github.com/repos/real-or-random/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/real-or-random/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/real-or-random/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/real-or-random/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/real-or-random/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/real-or-random/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/real-or-random/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/real-or-random/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/real-or-random/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/real-or-random/bips/contributors",
        "deployments_url": "https://api.github.com/repos/real-or-random/bips/deployments",
        "downloads_url": "https://api.github.com/repos/real-or-random/bips/downloads",
        "events_url": "https://api.github.com/repos/real-or-random/bips/events",
        "forks_url": "https://api.github.com/repos/real-or-random/bips/forks",
        "git_commits_url": "https://api.github.com/repos/real-or-random/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/real-or-random/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/real-or-random/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/real-or-random/bips.git",
        "issue_comment_url": "https://api.github.com/repos/real-or-random/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/real-or-random/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/real-or-random/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/real-or-random/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/real-or-random/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/real-or-random/bips/languages",
        "merges_url": "https://api.github.com/repos/real-or-random/bips/merges",
        "milestones_url": "https://api.github.com/repos/real-or-random/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/real-or-random/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/real-or-random/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/real-or-random/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:real-or-random/bips.git",
        "stargazers_url": "https://api.github.com/repos/real-or-random/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/real-or-random/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/real-or-random/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/real-or-random/bips/subscription",
        "tags_url": "https://api.github.com/repos/real-or-random/bips/tags",
        "teams_url": "https://api.github.com/repos/real-or-random/bips/teams",
        "trees_url": "https://api.github.com/repos/real-or-random/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/real-or-random/bips.git",
        "hooks_url": "https://api.github.com/repos/real-or-random/bips/hooks",
        "svn_url": "https://github.com/real-or-random/bips",
        "homepage": "bitcoin.org",
        "language": "Protocol Buffer",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 14025,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-28T08:20:07Z",
        "created_at": "2015-10-30T11:57:39Z",
        "updated_at": "2016-01-11T09:56:19Z"
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "7004ad1a825a0422b78bbf1a96bf748d5e380569",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5579,
        "stargazers_count": 8348,
        "watchers_count": 8348,
        "size": 13657,
        "default_branch": "master",
        "open_issues_count": 118,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-28T15:36:34Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2023-09-28T13:37:34Z"
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 33,
    "deletions": 28,
    "changed_files": 1,
    "commits": 1,
    "review_comments": 11,
    "comments": 17
  },
  "events": [
    {
      "event": "convert_to_draft",
      "id": 10455240426,
      "node_id": "CTDE_lADOAN28mc5x29_4zwAAAAJvLk7q",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455240426",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:30:40Z"
    },
    {
      "event": "commented",
      "id": 1732571219,
      "node_id": "IC_kwDOAN28mc5nRPBT",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1732571219",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:31:05Z",
      "updated_at": "2023-09-24T13:31:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "cc @sipa @dhruv",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1732571219",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "mentioned",
      "id": 10455241318,
      "node_id": "MEE_lADOAN28mc5x29_4zwAAAAJvLlJm",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455241318",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:31:06Z"
    },
    {
      "event": "subscribed",
      "id": 10455241322,
      "node_id": "SE_lADOAN28mc5x29_4zwAAAAJvLlJq",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455241322",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:31:06Z"
    },
    {
      "event": "mentioned",
      "id": 10455241324,
      "node_id": "MEE_lADOAN28mc5x29_4zwAAAAJvLlJs",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455241324",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:31:06Z"
    },
    {
      "event": "subscribed",
      "id": 10455241327,
      "node_id": "SE_lADOAN28mc5x29_4zwAAAAJvLlJv",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455241327",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:31:06Z"
    },
    {
      "event": "referenced",
      "id": 10455256913,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJvLo9R",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455256913",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "22d3f610d45e727ec279a35f480df312aaa8539e",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/22d3f610d45e727ec279a35f480df312aaa8539e",
      "created_at": "2023-09-24T13:42:25Z"
    },
    {
      "event": "referenced",
      "id": 10455258956,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJvLpdM",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455258956",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "796d21cdfd196d18cc9e4e5c4b338c1701144eb3",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/796d21cdfd196d18cc9e4e5c4b338c1701144eb3",
      "created_at": "2023-09-24T13:44:07Z"
    },
    {
      "event": "referenced",
      "id": 10455260202,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJvLpwq",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10455260202",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "created_at": "2023-09-24T13:45:04Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:46:51Z",
      "updated_at": "2023-09-24T13:46:51Z",
      "source": {
        "issue": {
          "id": 1910240070,
          "node_id": "PR_kwDOABII585bDvp1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28525",
          "number": 28525,
          "state": "open",
          "state_reason": null,
          "title": "net: Drop v2 garbage authentication packet",
          "body": "Note that this is a breaking change, see also https://github.com/bitcoin/bips/pull/1498\r\n\r\nThe benefit is a simpler implementation:\r\n - The protocol state machine does not need separate states for garbage authentication and version phases.\r\n - The special case of \"ignoring the ignore bit\" is removed.\r\n - The freedom to choose the contents of the garbage authentication packet is removed. This simplifies testing.",
          "user": {
            "login": "real-or-random",
            "id": 1071625,
            "node_id": "MDQ6VXNlcjEwNzE2MjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/real-or-random",
            "html_url": "https://github.com/real-or-random",
            "followers_url": "https://api.github.com/users/real-or-random/followers",
            "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
            "organizations_url": "https://api.github.com/users/real-or-random/orgs",
            "repos_url": "https://api.github.com/users/real-or-random/repos",
            "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/real-or-random/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28525",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28525.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28525.patch"
          },
          "created_at": "2023-09-24T13:46:50Z",
          "updated_at": "2023-09-28T14:55:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1732615102,
      "node_id": "IC_kwDOAN28mc5nRZu-",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1732615102",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T16:34:30Z",
      "updated_at": "2023-09-24T23:48:58Z",
      "author_association": "MEMBER",
      "body": "ACK, though I want to wait for some more opinions - the BIP is fine as is, and I'm not sure whether this minor improvement is worth the breaking change at this point.\n\nFor a bit of history, this was a conscious decision earlier, to separate the garbage phase from the version negotiation phase. But arguably, the result isn't all that consistent either. The idea was to use the \"packet\" interface for everything after garbage terminator, but the abstraction is not perfect: packets have a decoy bit, but the decoy bit of the garbage authentication is ignored. In retrospect, seeing both specification and (one) implementation, it appears simpler to merge the auth packet and version packet.\n\nAs for conceptual way of looking at it, I believe this makes sense:\n* We see the packet abstraction as consisting of two layers:\n  * The lower-level length encoding + aead\n  * The higher-level notion of header byte and decoy packets.\n* The change here is moving the garbage auth functionality to the lower-level layer: whenever additional authentication is needed, the first packet (at this layer decoy or not does not matter, so the first whether that's a decoy or not) after it does that authentication. And the higher-level header/decoy functionality remains for version and application level packets, where this feature makes sense.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1732615102",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1733614153,
      "node_id": "IC_kwDOAN28mc5nVNpJ",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1733614153",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T12:28:15Z",
      "updated_at": "2023-09-25T12:28:15Z",
      "author_association": "MEMBER",
      "body": "ACK\r\nI reviewed changes to the BIP and changes to the codebase (bitcoin#28525). I think at this point, it's worth breaking the current version, it makes everything cleaner and better (although I see the intuition behind the initial logic).\r\n\r\n>Either peer may send such decoy packets at any point after this.\r\n\r\nShould be clearer saying that a `garbage authentication package` could be a decoy package (answering \"after which point exactly?\").\r\n\r\n>So the first two phases together, jointly called the handshake, comprise just 1.5 roundtrips:\r\n\r\nKinda confusing now that `garbage authentication` is not there.\r\n\r\n",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1733614153",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10462410742,
      "node_id": "HRFPE_lADOAN28mc5x29_4zwAAAAJvm7f2",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10462410742",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T13:01:24Z"
    },
    {
      "event": "commented",
      "id": 1733671734,
      "node_id": "IC_kwDOAN28mc5nVbs2",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1733671734",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T13:04:17Z",
      "updated_at": "2023-09-25T13:04:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "\r\n> > Either peer may send such decoy packets at any point after this.\r\n> \r\n> Should be clearer saying that a `garbage authentication package` could be a decoy package (answering \"after which point exactly?\").\r\n\r\nRephrased and restructured this to improve clarity.\r\n\r\n> > So the first two phases together, jointly called the handshake, comprise just 1.5 roundtrips:\r\n> \r\n> Kinda confusing now that `garbage authentication` is not there.\r\n\r\nHappy to improve here, but I can't follow. It's still 3 phases altogether, and the first two are 1.5 roundtrips. What do you find confusing?",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1733671734",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1733673874,
      "node_id": "IC_kwDOAN28mc5nVcOS",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1733673874",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T13:05:33Z",
      "updated_at": "2023-09-25T13:05:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "> ACK\r\n> I reviewed changes to the BIP and changes to the codebase (bitcoin#28525)\r\n\r\nWant to leave a review or (Concept) ACK also in https://github.com/bitcoin/bitcoin/pull/28525 then? :)",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1733673874",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1735078030,
      "node_id": "IC_kwDOAN28mc5nazCO",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735078030",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T08:33:22Z",
      "updated_at": "2023-09-26T08:33:22Z",
      "author_association": "MEMBER",
      "body": ">Happy to improve here, but I can't follow. It's still 3 phases altogether, and the first two are 1.5 roundtrips. What do you find confusing?\r\n\r\nIt was not immediately clear why garbage authentication is not in the list following `comprise just 1.5 roundtrips`. Now I agree that it doesn't add much value in that description.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735078030",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1735122192,
      "node_id": "IC_kwDOAN28mc5na90Q",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735122192",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T09:00:18Z",
      "updated_at": "2023-09-26T09:00:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK -- fewer states seems like a win, and it seems like the simpler this is, the more easily it could be used for other applications\r\n\r\nThe 1.5 round trip handshake could arguably be more obscure if described/implemented as:\r\n\r\n * the initiator sends public key + garbage-part-1\r\n * the responder sends public key + garbage + garbage terminator + version packet + decoy packet\r\n * the initiator sends garbage-part-2 + garbage terminator + version packet + decoy packet\r\n\r\n(otherwise the \"garbage-terminator + version packet\" may be identifiable as a fixed size response?)\r\n\r\nDoes it make sense to have a decoy packet before the version packet rather than after it? The version packet tells you how to interpret the header, so it seems slightly odd to be parsing headers before you've actually figured out what the header format is.\r\n\r\nPerhaps it would it be simpler but still workable to just have the first packet after the garbage terminator always be the version packet, and have its entire contents (with no header) be interpreted as the version negotiation? In that case, an initial \"empty\" version message could literally be empty, with no header and no content. In that case after the first version message, you'd pass every message's content to a version-specific decoder that splits out the header, and routes the body to the appropriate application handler.\r\n\r\n(In order for the responder to be able to append decoy packets before receiving the initiator's version packet, you'd still need to guarantee that packets with the high-bit of the first byte are ignored no matter what version ends up being negotiated)\r\n\r\nIt might be slightly clearer to make the pseudocode more stateful as far as the aad info goes, ie drop it as a parameter to `v2_enc_packet` and `v2_receive_packet` and instead initialize it based on `peer.sent_garbage` and `peer.recv_garbage`, and clear them after first use?",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735122192",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "referenced",
      "id": 10473972168,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJwTCHI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10473972168",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
      "created_at": "2023-09-26T11:39:53Z"
    },
    {
      "event": "commented",
      "id": 1735363745,
      "node_id": "IC_kwDOAN28mc5nb4yh",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735363745",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T11:40:41Z",
      "updated_at": "2023-09-26T11:40:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The 1.5 round trip handshake could arguably be more obscure if described/implemented as:\r\n\r\nJust for my understanding: You're saying that the handshake could look more obscure to wiretappers, right? And not that the description of the handshake in the BIP would be more obscure to readers? ;)\r\n\r\n\r\n> (otherwise the \"garbage-terminator + version packet\" may be identifiable as a fixed size response?)\r\n\r\nI don't think so. The \"garbage-terminator + version packet\" is always preceded by some form \"garbage\". So if you want to get rid of the fixed-size response, you can also just send garbage. And yes, if you need more bytes, you can always send more decoys after the version packet, but I don't think this needs to be in the handshake description. (You can *always* send decoys.) \r\n\r\n > Does it make sense to have a decoy packet before the version packet rather than after it? The version packet tells you how to interpret the header, so it seems slightly odd to be parsing headers before you've actually figured out what the header format is.\r\n\r\nI agree that it seems odd to parse headers before you've agreed on a version. And @sipa had similar remarks when we talked about this somewhere else. The thing is that we bootstrap communications, so we build up the layers step by step. And yes, you can argue that at the point when we've just received the garbage terminator, we have not agreed on a header format yet. \r\n\r\nAnd I agree that the possibility to send decoy packets before the version packet doesn't really add functionality. Instead of ignoring the ignore bit (what we do in the current BIP), we could also get rid of this by dropping the header byte entirely (what you suggest). Another way is to simply disallow packages where the ignore bit is set. Though, I don't believe that this will make things simpler. It's adding back a special rule again. \r\n\r\nSo I think if we agree that it makes sense to drop the explicit garbage authentication packet and get rid of one state in the state machine, then I see the following possibilities after the garbage terminator.\r\n1. Switch to \"normal\" packet handling, but the first packet has AAD set: This is what this PR proposes.\r\n2. Like 1, but additionally ignore the ignore bit: This is what the current BIP says, and it has a special case which could be avoided.\r\n3. Like 1, but additionally reject the first packet if it's a decoy packet and disconnect: On one hand, that's just a different special case. On the other hand, then it's then always the case that the AAD is in the version packet.\r\n4. Switch to a simpler headerless packet format just for the version negotiation: This is what you propose. It seems conceptually cleaner, but this requires that we expose a way to parse headerless packets to the high-level net code. In that sense. I don't see how a rule \"parse a raw version packet and delegate further packets to version-specific decoder\" is much simpler than a rule \"parse a v2 version packet, and delegate further packets to version-specific decoder\".  The former will always need one parser more, namely one for raw packets.\r\n\r\nAmong these approaches, I like 1 and 3 most. \r\n\r\nI think approach 1 (in this PR) is conceptually nice because it decouples the AAD stuff from the protocol states. You simply keep a variable around that tells what you expect as AAD in the next received packet [1]. Approach 3 does not need this variable and just needs an `if (ignore) return false` in the VERSION state in the C code. That's also pretty simple. Happy to switch to this approach, I guess it's really on par with approach 1.   \r\n\r\n> It might be slightly clearer to make the pseudocode more stateful as far as the aad info goes, ie drop it as a parameter to `v2_enc_packet` and `v2_receive_packet` and instead initialize it based on `peer.sent_garbage` and `peer.recv_garbage`, and clear them after first use?\r\n\r\nWill probably give this a shot later.\r\n\r\n[1] Note that when you wrote your comment here, the way I was implementing this  (https://github.com/real-or-random/bitcoin/blob/8753b6af9bf8767be50d71d1bf7e3711738fcfd2/src/net.cpp#L1239-L1278) technically did not achieve this decoupling yet. I've improved this now in the implementation PR this by renaming the `m_recv_buffer` to `m_recv_aad` and handling AAD independently of whether the receiver is in `VERSION` state or not. This also means that the handling of the ignore bit does not depend on the state. ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735363745",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "mentioned",
      "id": 10473980094,
      "node_id": "MEE_lADOAN28mc5x29_4zwAAAAJwTEC-",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10473980094",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T11:40:41Z"
    },
    {
      "event": "subscribed",
      "id": 10473980107,
      "node_id": "SE_lADOAN28mc5x29_4zwAAAAJwTEDL",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10473980107",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T11:40:41Z"
    },
    {
      "event": "commented",
      "id": 1735401793,
      "node_id": "IC_kwDOAN28mc5ncCFB",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735401793",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T11:58:17Z",
      "updated_at": "2023-09-26T12:12:14Z",
      "author_association": "MEMBER",
      "body": "The purpose of having decoy functionality available during the VERSION phase is mostly for future extensions that may extend the number of messages that can be sent in that phase. I agree it's rather pointless right now, but with the prospect of extensions, I think it's cleaner to have it available for the entirety of the phase.\r\n\r\nJust as a note, if we'd go for an approach with 2 layers, where some parts use headerless packets and other parts use headerful packets, the length descriptor semantics need to change too (because they're currently excluding the header byte length).\r\n\r\n@ajtowns I don't believe there is a benefit to splitting up the garbage into a part sent before and after the other side's key; whatever you sent as garbage part 2 can instead be sent as decoy data (even if only possible after the version packet).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735401793",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "mentioned",
      "id": 10474374392,
      "node_id": "MEE_lADOAN28mc5x29_4zwAAAAJwUkT4",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10474374392",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T12:12:14Z"
    },
    {
      "event": "subscribed",
      "id": 10474374405,
      "node_id": "SE_lADOAN28mc5x29_4zwAAAAJwUkUF",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10474374405",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T12:12:14Z"
    },
    {
      "event": "commented",
      "id": 1735504801,
      "node_id": "IC_kwDOAN28mc5ncbOh",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735504801",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T13:04:54Z",
      "updated_at": "2023-09-26T13:04:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Just for my understanding: You're saying that the handshake could look more obscure to wiretappers, right? And not that the description of the handshake in the BIP would be more obscure to readers? ;)\r\n\r\nYeah, that's what I mean, and your further reply makes sense. Still kinda think mentioning decoy packets as well as garbage in the 1.5 round trip summary would be clearer; but the rest of the BIP already makes it pretty clear anyway, so :man_shrugging: \r\n\r\n> The purpose of having decoy functionality available during the VERSION phase is mostly for future extensions that may extend the number of messages that can be sent in that phase.\r\n\r\nHmm, I guess I look at the layers as:\r\n\r\n * \"over the wire\":\r\n   - negotiate a key\r\n   - send packets\r\n   - handle rekeying\r\n   - negotiate \"application support\" for future extensibility\r\n   - do all that while looking like a pseudorandom stream\r\n * \"application layer\":\r\n   - is dispatched to different applications (decoy -> /dev/null, bitcoin p2p -> net_processing)\r\n   - application layer just sees packet contents (and the session key)\r\n   - someday, when the decoy \"application\" actually sends data, it might become an actual complicated application in its own right, eg in order to mimic traffic patterns of some other protocol\r\n   - someday, if we get really worried about obscuring things, messages being sent might go through a third layer that delays them a bit to try to make it harder to do timing analysis or figure out packet boundaries\r\n\r\nie, I guess I think \"negotiate for future extensibility\" is essentially a \"meta application\" that's built into the bip324 (or future extension bip) implementation, that while it gets data from packets just like a regular application, also controls how data from packets goes to applications, so it's really a low-level thing, not a high-level thing. Maybe \"built-in as part of the implementation\" vs \"user of the API\" is more the distinction that I'm thinking of.\r\n\r\n> Just as a note, if we'd go for an approach with 2 layers, where some parts use headerless packets and other parts use headerful packets, the length descriptor semantics need to change too (because they're currently excluding the header byte length).\r\n\r\nYeah, I guess that makes sense: better to be able to have a full 0xFF_FFFF bytes of application data in a packet than be off by two instead of just one. I also guess that's easy enough to extend in some future version if it's ever desirable:\r\n\r\n * 16MiB isn't enough: if bit 6 of the header is set, concatenate the contents of the next packet, and repeat, until you can send gigameg blocks back to the application as a single unit\r\n * 8 bits of header isn't enough: if bit 5 of the header is set, the first however many bytes of the contents is a varint header\r\n \r\nLGTM :+1:",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735504801",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1735583511,
      "node_id": "IC_kwDOAN28mc5ncucX",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1735583511",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T13:49:58Z",
      "updated_at": "2023-09-26T13:52:59Z",
      "author_association": "MEMBER",
      "body": "I'm really not convinced that separating headerless and headerful packets is worth it.\r\n\r\nAt a conceptual level you can say:\r\n* (1) In the BIP right now, garbage auth packets are headerless, while version and application packets are headerful. The rationale arguably is that the initial phase has its own traffic shaping mechanism (garbage) so it has no need for decoy packets anyway. However, the instantiation of the garbage auth packets still used header bytes, leading to the inconsistency (ignoring decoy bits) that led to this PR.\r\n* (2) In the proposed BIP change in this PR, garbage auth packets are gone, and the remaining packets (version and application) are headerful both conceptually and in the way they are instantiated. While it's true that the version phase right now needs no traffic shaping (because it's so short the shaping can be done by the phase that follows), it's not true conceptually that version negotiation needs no shaping entirely (something that could become apparent with future extensions).\r\n* (3) In what we're discussing now, version packets become conceptually headerless, but application packets stay headerful. That can be done with or without getting rid of the header byte entirely, but I'm not sure any either is all that appealing:\r\n  * (3a) Version packets retain a header byte, but it is ignored (resulting in a similar inconsistency to how garbage auth packets has ignored header bytes right now).\r\n  * (3b) Version packets have no header byte at all (meaning implementations gain some complexity due to distinguishing the two types of packets). This means changing the meaning of length descriptors (either make them depend on the phase, or deal with application level packets that are too short to contain a header). Version extensions may need a traffic shaping mechanism, but this could be done by enabling headers mid-phase, or having their own ad-hoc shaping mechanism (or extensions could of course overhaul the decoy mechanism entirely).\r\n\r\nSo while it does make sense to see the version negotiation as the thing that negotiates there being a decoy mechanism, and so logically that phase itself shouldn't already have them, I don't think this practically gains us anything:\r\n* Right now (ignoring future extensions) the specification and implementation seem simpler with (2) simply because there is only one type of packet, and its semantics are always the same.\r\n* For future extensions, it may or may not be desirable to have the same decoy mechanism present during the version negotiation, but if it isn't, it can still be changed.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1735583511",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "reviewed",
      "id": 1645008928,
      "node_id": "PRR_kwDOAN28mc5iDNgg",
      "url": null,
      "actor": null,
      "commit_id": "3d0f725b2287f5bd55a316167045184fa38c09dd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#pullrequestreview-1645008928",
      "submitted_at": "2023-09-26T19:12:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10484749388,
      "node_id": "HRFPE_lADOAN28mc5x29_4zwAAAAJw8JRM",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10484749388",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:07:39Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10484793255,
      "node_id": "HRFPE_lADOAN28mc5x29_4zwAAAAJw8T-n",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10484793255",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:11:14Z"
    },
    {
      "event": "commented",
      "id": 1737046407,
      "node_id": "IC_kwDOAN28mc5niTmH",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1737046407",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:32:18Z",
      "updated_at": "2023-09-27T09:32:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've forced-push to address the comments. I'm undrafting the PR because there seems to be broad agreement that we want to do this.\r\n\r\n@ajtowns \r\n\r\n> Still kinda think mentioning decoy packets as well as garbage in the 1.5 round trip summary would be clearer; but the rest of the BIP already makes it pretty clear anyway, so \r\n\r\nOk, that makes sense. We mentioned it everywhere in the BIP except in this summary. Added it to the summary for consistency.\r\n\r\n> It might be slightly clearer to make the pseudocode more stateful as far as the aad info goes, ie drop it as a parameter to `v2_enc_packet` and `v2_receive_packet` and instead initialize it based on `peer.sent_garbage` and `peer.recv_garbage`, and clear them after first use?\r\n\r\nI tried this, but I'm not convinced that this will make it clearer: Keeping the state local to `complete_handshake` also has its merits and keeping the AAD logic there keeps it close to where this logic is explained in prose. ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1737046407",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "mentioned",
      "id": 10485039322,
      "node_id": "MEE_lADOAN28mc5x29_4zwAAAAJw9QDa",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485039322",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:32:19Z"
    },
    {
      "event": "subscribed",
      "id": 10485039350,
      "node_id": "SE_lADOAN28mc5x29_4zwAAAAJw9QD2",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485039350",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:32:19Z"
    },
    {
      "event": "ready_for_review",
      "id": 10485040538,
      "node_id": "RFRE_lADOAN28mc5x29_4zwAAAAJw9QWa",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485040538",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:32:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10485052638,
      "node_id": "HRFPE_lADOAN28mc5x29_4zwAAAAJw9TTe",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485052638",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T09:33:32Z"
    },
    {
      "event": "referenced",
      "id": 10485519364,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJw_FQE",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485519364",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a90bde593c32f088c42ce7b978a12e59583d9c7b",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/a90bde593c32f088c42ce7b978a12e59583d9c7b",
      "created_at": "2023-09-27T10:17:17Z"
    },
    {
      "event": "referenced",
      "id": 10485549521,
      "node_id": "REFE_lADOAN28mc5x29_4zwAAAAJw_MnR",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10485549521",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b0f5175c044df956c0f07f540706d457c4912856",
      "commit_url": "https://api.github.com/repos/real-or-random/bitcoin/commits/b0f5175c044df956c0f07f540706d457c4912856",
      "created_at": "2023-09-27T10:20:16Z"
    },
    {
      "event": "commented",
      "id": 1737247845,
      "node_id": "IC_kwDOAN28mc5njExl",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1737247845",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T11:55:36Z",
      "updated_at": "2023-09-27T11:55:36Z",
      "author_association": "MEMBER",
      "body": "LGTM",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1737247845",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1737380952,
      "node_id": "IC_kwDOAN28mc5njlRY",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1737380952",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T13:16:55Z",
      "updated_at": "2023-09-27T13:16:55Z",
      "author_association": "MEMBER",
      "body": "ACK",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1737380952",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "reviewed",
      "id": 1646495379,
      "node_id": "PRR_kwDOAN28mc5iI4aT",
      "url": null,
      "actor": null,
      "commit_id": "ddb6a5ca6c6465a2abcc74dcdcf14f6c238cce79",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#pullrequestreview-1646495379",
      "submitted_at": "2023-09-27T13:17:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
    },
    {
      "event": "commented",
      "id": 1737397919,
      "node_id": "IC_kwDOAN28mc5njpaf",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1737397919",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T13:27:11Z",
      "updated_at": "2023-09-27T13:27:11Z",
      "author_association": "MEMBER",
      "body": "One thing you may want to improve is making it clear that garbage-terminator is not a part of garbage when doing aad. This is something i had to double-check everywhere manually on my own :) A BIP could be explicit about this.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1737397919",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "commented",
      "id": 1737716794,
      "node_id": "IC_kwDOAN28mc5nk3Q6",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1737716794",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T16:24:11Z",
      "updated_at": "2023-09-27T16:24:11Z",
      "author_association": "MEMBER",
      "body": "Concept ACK, but haven't studied the BIP changes, only the code change.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1737716794",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDc1ZGMzNjNkMjAxMDcyNTc5Mjg5Y2M2ZDIwZDQwZWY3YTY3ZGIyOTE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/75dc363d201072579289cc6d20d40ef7a67db291",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/75dc363d201072579289cc6d20d40ef7a67db291",
      "tree": {
        "sha": "aa4f403198ed551dededa8c2d466f2074216ca46",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/aa4f403198ed551dededa8c2d466f2074216ca46"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/7004ad1a825a0422b78bbf1a96bf748d5e380569",
          "sha": "7004ad1a825a0422b78bbf1a96bf748d5e380569",
          "html_url": "https://github.com/bitcoin/bips/commit/7004ad1a825a0422b78bbf1a96bf748d5e380569"
        }
      ],
      "message": "bip324: Remove garbage authentication packet (breaking change)\n\nby merging it with the version packet. Or more accurately, by merging\nit with the first packet sent after garbage termination, which may be\na decoy packet or the version packet.\n\nThe new protocol simplifies implementations:\n - A protocol state machine won't need separate states for garbage\n   authentication and version phases.\n - The special case of \"ignoring the ignore bit\" is removed.\n - The freedom to choose the contents of the garbage authentication\n   packet is removed. This simplifies testing.\n\nThe reason for having a separate garbage authentication packet was\nto materialize the separation of the key exchange phase and version\nnegotiation phase even in the bytestream on the wire. However, this\nis not necessary, and arguably, these phases are still properly\nseparated: Since the AEAD will ensure that AAD (=garbage) is checked\nbefore looking at the contents (=version), the peers won't interpret\nversion data before having authenticated the garbage.",
      "committer": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-28T08:19:53Z"
      },
      "author": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-24T13:00:34Z"
      },
      "sha": "75dc363d201072579289cc6d20d40ef7a67db291"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10496081722,
      "node_id": "HRFPE_lADOAN28mc5x29_4zwAAAAJxnX86",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/10496081722",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-28T08:20:18Z"
    },
    {
      "event": "commented",
      "id": 1738694706,
      "node_id": "IC_kwDOAN28mc5nomAy",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/1738694706",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-28T08:21:19Z",
      "updated_at": "2023-09-28T08:21:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "> One thing you may want to improve is making it clear that garbage-terminator is not a part of garbage when doing aad. This is something i had to double-check everywhere manually on my own :) A BIP could be explicit about this.\r\n\r\nAdded \"not including the garbage terminator\" at an appropriate location in the text.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#issuecomment-1738694706",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1498"
    },
    {
      "event": "reviewed",
      "id": 1648346345,
      "node_id": "PRR_kwDOAN28mc5iP8Tp",
      "url": null,
      "actor": null,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 75dc363d201072579289cc6d20d40ef7a67db291 modulo some example code suggestions",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1498#pullrequestreview-1648346345",
      "submitted_at": "2023-09-28T10:00:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1337664014",
      "pull_request_review_id": 1645008928,
      "id": 1337664014,
      "node_id": "PRRC_kwDOAN28mc5PuyIO",
      "diff_hunk": "@@ -120,10 +120,11 @@ Given a newly established connection (typically TCP/IP) between two v2 P2P nodes\n #** Receive (the remainder of) the full 64-byte public key from the other side.\n #** Use X-only<ref name=\"xonly_ecdh\">'''Why use X-only ECDH?''' Using only the X coordinate provides the same security as using a full encoding of the secret curve point but allows for more efficient implementation by avoiding the need for square roots to compute Y coordinates.</ref> ECDH to compute a shared secret from their private key and the exchanged public keys<ref name=\"why_ecdh_pubkeys\">'''Why is the shared secret computation a function of the exact 64-byte public encodings sent?''' This makes sure that an attacker cannot modify the public key encoding used without modifying the rest of the stream. If a third party wants the ability to modify stream bytes, they need to perform a full MitM attack on the connection.</ref>, and deterministically derive from the secret 4 '''encryption keys''' (two in each direction: one for packet lengths, one for content encryption), a '''session id''', and two 16-byte '''garbage terminators'''<ref>'''What length is sufficient for garbage terminators?''' The length of the garbage terminators determines the probability of accidental termination of a legitimate v2 connection due to garbage bytes (sent prior to ECDH) inadvertently including the terminator. 16 byte terminators with 4095 bytes of garbage yield a negligible probability of such collision which is likely orders of magnitude lower than random connection failure on the Internet.</ref><ref>'''What does a garbage terminator in the wild look like?''' <div>[[File:bip-0324/garbage_terminator.png|none|256px|A garbage terminator model TX-v2 in the wild... sent by the responder]]</div>\n </ref> (one in each direction) using HKDF-SHA256.\n-#** Send their 16-byte garbage terminator<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the garbage authentication packet directly as a terminator (scan until a valid authentication packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref> followed by a '''garbage authentication packet'''<ref name=\"why_garbage_auth\">'''Why does the protocol require a garbage authentication packet?''' Without the garbage authentication packet, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>, an '''encrypted packet''' (see further) with arbitrary '''contents''', and '''associated data''' equal to the garbage.\n+#** Send their 16-byte garbage terminator.<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the first packet after the garbage directly as a terminator (scan until a valid packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref>\n #** Receive up to 4111 bytes, stopping when encountering the garbage terminator.\n-#** Receive an encrypted packet, verify that it decrypts correctly with associated data set to the garbage received, and then ignore its contents.\n-#* At this point, both parties have the same keys, and all further communication proceeds in the form of encrypted packets. Packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point after this. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#* At this point, both parties have the same keys, and all further communication proceeds in the form of '''encrypted packets'''.\n+#** Encrypted packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point from here now. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.",
      "path": "bip-0324.mediawiki",
      "position": null,
      "original_position": 10,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "3d0f725b2287f5bd55a316167045184fa38c09dd",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: \"from here now\" -> \"from here on\"?",
      "created_at": "2023-09-26T19:06:32Z",
      "updated_at": "2023-09-26T19:12:24Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1337664014",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1337664014"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1337668662",
      "pull_request_review_id": 1645008928,
      "id": 1337668662,
      "node_id": "PRRC_kwDOAN28mc5PuzQ2",
      "diff_hunk": "@@ -370,18 +369,21 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator + version packet.",
      "path": "bip-0324.mediawiki",
      "position": null,
      "original_position": 87,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "3d0f725b2287f5bd55a316167045184fa38c09dd",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The mention of version packet here is a bit confusing, as the version packet isn't sent until after the `# Optionally send decoy packets ...` comment below.",
      "created_at": "2023-09-26T19:11:17Z",
      "updated_at": "2023-09-26T19:12:24Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1337668662",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1337668662"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 372,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338309449",
      "pull_request_review_id": 1645998093,
      "id": 1338309449,
      "node_id": "PRRC_kwDOAN28mc5PxPtJ",
      "diff_hunk": "@@ -120,10 +120,11 @@ Given a newly established connection (typically TCP/IP) between two v2 P2P nodes\n #** Receive (the remainder of) the full 64-byte public key from the other side.\n #** Use X-only<ref name=\"xonly_ecdh\">'''Why use X-only ECDH?''' Using only the X coordinate provides the same security as using a full encoding of the secret curve point but allows for more efficient implementation by avoiding the need for square roots to compute Y coordinates.</ref> ECDH to compute a shared secret from their private key and the exchanged public keys<ref name=\"why_ecdh_pubkeys\">'''Why is the shared secret computation a function of the exact 64-byte public encodings sent?''' This makes sure that an attacker cannot modify the public key encoding used without modifying the rest of the stream. If a third party wants the ability to modify stream bytes, they need to perform a full MitM attack on the connection.</ref>, and deterministically derive from the secret 4 '''encryption keys''' (two in each direction: one for packet lengths, one for content encryption), a '''session id''', and two 16-byte '''garbage terminators'''<ref>'''What length is sufficient for garbage terminators?''' The length of the garbage terminators determines the probability of accidental termination of a legitimate v2 connection due to garbage bytes (sent prior to ECDH) inadvertently including the terminator. 16 byte terminators with 4095 bytes of garbage yield a negligible probability of such collision which is likely orders of magnitude lower than random connection failure on the Internet.</ref><ref>'''What does a garbage terminator in the wild look like?''' <div>[[File:bip-0324/garbage_terminator.png|none|256px|A garbage terminator model TX-v2 in the wild... sent by the responder]]</div>\n </ref> (one in each direction) using HKDF-SHA256.\n-#** Send their 16-byte garbage terminator<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the garbage authentication packet directly as a terminator (scan until a valid authentication packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref> followed by a '''garbage authentication packet'''<ref name=\"why_garbage_auth\">'''Why does the protocol require a garbage authentication packet?''' Without the garbage authentication packet, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>, an '''encrypted packet''' (see further) with arbitrary '''contents''', and '''associated data''' equal to the garbage.\n+#** Send their 16-byte garbage terminator.<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the first packet after the garbage directly as a terminator (scan until a valid packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref>\n #** Receive up to 4111 bytes, stopping when encountering the garbage terminator.\n-#** Receive an encrypted packet, verify that it decrypts correctly with associated data set to the garbage received, and then ignore its contents.\n-#* At this point, both parties have the same keys, and all further communication proceeds in the form of encrypted packets. Packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point after this. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#* At this point, both parties have the same keys, and all further communication proceeds in the form of '''encrypted packets'''.\n+#** Encrypted packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point from here now. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.",
      "path": "bip-0324.mediawiki",
      "position": null,
      "original_position": 10,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "3d0f725b2287f5bd55a316167045184fa38c09dd",
      "in_reply_to_id": 1337664014,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2023-09-27T09:11:57Z",
      "updated_at": "2023-09-27T09:11:57Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1338309449",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338309449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338310811",
      "pull_request_review_id": 1646000172,
      "id": 1338310811,
      "node_id": "PRRC_kwDOAN28mc5PxQCb",
      "diff_hunk": "@@ -370,18 +369,21 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator + version packet.",
      "path": "bip-0324.mediawiki",
      "position": null,
      "original_position": 87,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "3d0f725b2287f5bd55a316167045184fa38c09dd",
      "in_reply_to_id": 1337668662,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed by splitting the comment and moving the \"Send version packet\" part where it belongs",
      "created_at": "2023-09-27T09:12:59Z",
      "updated_at": "2023-09-27T09:13:00Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1338310811",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338310811"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 372,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338595864",
      "pull_request_review_id": 1646495379,
      "id": 1338595864,
      "node_id": "PRRC_kwDOAN28mc5PyVoY",
      "diff_hunk": "@@ -120,10 +120,11 @@ Given a newly established connection (typically TCP/IP) between two v2 P2P nodes\n #** Receive (the remainder of) the full 64-byte public key from the other side.\n #** Use X-only<ref name=\"xonly_ecdh\">'''Why use X-only ECDH?''' Using only the X coordinate provides the same security as using a full encoding of the secret curve point but allows for more efficient implementation by avoiding the need for square roots to compute Y coordinates.</ref> ECDH to compute a shared secret from their private key and the exchanged public keys<ref name=\"why_ecdh_pubkeys\">'''Why is the shared secret computation a function of the exact 64-byte public encodings sent?''' This makes sure that an attacker cannot modify the public key encoding used without modifying the rest of the stream. If a third party wants the ability to modify stream bytes, they need to perform a full MitM attack on the connection.</ref>, and deterministically derive from the secret 4 '''encryption keys''' (two in each direction: one for packet lengths, one for content encryption), a '''session id''', and two 16-byte '''garbage terminators'''<ref>'''What length is sufficient for garbage terminators?''' The length of the garbage terminators determines the probability of accidental termination of a legitimate v2 connection due to garbage bytes (sent prior to ECDH) inadvertently including the terminator. 16 byte terminators with 4095 bytes of garbage yield a negligible probability of such collision which is likely orders of magnitude lower than random connection failure on the Internet.</ref><ref>'''What does a garbage terminator in the wild look like?''' <div>[[File:bip-0324/garbage_terminator.png|none|256px|A garbage terminator model TX-v2 in the wild... sent by the responder]]</div>\n </ref> (one in each direction) using HKDF-SHA256.\n-#** Send their 16-byte garbage terminator<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the garbage authentication packet directly as a terminator (scan until a valid authentication packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref> followed by a '''garbage authentication packet'''<ref name=\"why_garbage_auth\">'''Why does the protocol require a garbage authentication packet?''' Without the garbage authentication packet, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>, an '''encrypted packet''' (see further) with arbitrary '''contents''', and '''associated data''' equal to the garbage.\n+#** Send their 16-byte garbage terminator.<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the first packet after the garbage directly as a terminator (scan until a valid packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref>\n #** Receive up to 4111 bytes, stopping when encountering the garbage terminator.\n-#** Receive an encrypted packet, verify that it decrypts correctly with associated data set to the garbage received, and then ignore its contents.\n-#* At this point, both parties have the same keys, and all further communication proceeds in the form of encrypted packets. Packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point after this. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#* At this point, both parties have the same keys, and all further communication proceeds in the form of '''encrypted packets'''.\n+#** Encrypted packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point from here on. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#** For each of the two directions, the first encrypted packet that will be sent in that direction (regardless of it being a decoy packet or not) will make use of the associated authenticated data (AAD) feature of the AEAD to authenticate the garbage that has been sent in that direction.<ref name=\"why_garbage_auth\">'''Why does the protocol authenticate the garbage?''' Without garbage authentication, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>",
      "path": "bip-0324.mediawiki",
      "position": 11,
      "original_position": 11,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "ddb6a5ca6c6465a2abcc74dcdcf14f6c238cce79",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't understand what kind of fingerprinting will be possible. Maybe it's just me. Can you explain in more detail?",
      "created_at": "2023-09-27T13:17:31Z",
      "updated_at": "2023-09-27T13:17:31Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1338595864",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338595864"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 127,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338607980",
      "pull_request_review_id": 1646525787,
      "id": 1338607980,
      "node_id": "PRRC_kwDOAN28mc5PyYls",
      "diff_hunk": "@@ -120,10 +120,11 @@ Given a newly established connection (typically TCP/IP) between two v2 P2P nodes\n #** Receive (the remainder of) the full 64-byte public key from the other side.\n #** Use X-only<ref name=\"xonly_ecdh\">'''Why use X-only ECDH?''' Using only the X coordinate provides the same security as using a full encoding of the secret curve point but allows for more efficient implementation by avoiding the need for square roots to compute Y coordinates.</ref> ECDH to compute a shared secret from their private key and the exchanged public keys<ref name=\"why_ecdh_pubkeys\">'''Why is the shared secret computation a function of the exact 64-byte public encodings sent?''' This makes sure that an attacker cannot modify the public key encoding used without modifying the rest of the stream. If a third party wants the ability to modify stream bytes, they need to perform a full MitM attack on the connection.</ref>, and deterministically derive from the secret 4 '''encryption keys''' (two in each direction: one for packet lengths, one for content encryption), a '''session id''', and two 16-byte '''garbage terminators'''<ref>'''What length is sufficient for garbage terminators?''' The length of the garbage terminators determines the probability of accidental termination of a legitimate v2 connection due to garbage bytes (sent prior to ECDH) inadvertently including the terminator. 16 byte terminators with 4095 bytes of garbage yield a negligible probability of such collision which is likely orders of magnitude lower than random connection failure on the Internet.</ref><ref>'''What does a garbage terminator in the wild look like?''' <div>[[File:bip-0324/garbage_terminator.png|none|256px|A garbage terminator model TX-v2 in the wild... sent by the responder]]</div>\n </ref> (one in each direction) using HKDF-SHA256.\n-#** Send their 16-byte garbage terminator<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the garbage authentication packet directly as a terminator (scan until a valid authentication packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref> followed by a '''garbage authentication packet'''<ref name=\"why_garbage_auth\">'''Why does the protocol require a garbage authentication packet?''' Without the garbage authentication packet, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>, an '''encrypted packet''' (see further) with arbitrary '''contents''', and '''associated data''' equal to the garbage.\n+#** Send their 16-byte garbage terminator.<ref name=\"why_garbage_term\">'''Why does the protocol need a garbage terminator?''' While it is in principle possible to use the first packet after the garbage directly as a terminator (scan until a valid packet follows), this would be significantly slower than just scanning for a fixed byte sequence, as it would require recomputing a Poly1305 tag after every received byte.</ref>\n #** Receive up to 4111 bytes, stopping when encountering the garbage terminator.\n-#** Receive an encrypted packet, verify that it decrypts correctly with associated data set to the garbage received, and then ignore its contents.\n-#* At this point, both parties have the same keys, and all further communication proceeds in the form of encrypted packets. Packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point after this. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#* At this point, both parties have the same keys, and all further communication proceeds in the form of '''encrypted packets'''.\n+#** Encrypted packets have an '''ignore bit''', which makes them '''decoy packets''' if set. Decoy packets are to be ignored by the receiver apart from verifying they decrypt correctly. Either peer may send such decoy packets at any point from here on. These form the primary shapability mechanism in the protocol. How and when to use them is out of scope for this document.\n+#** For each of the two directions, the first encrypted packet that will be sent in that direction (regardless of it being a decoy packet or not) will make use of the associated authenticated data (AAD) feature of the AEAD to authenticate the garbage that has been sent in that direction.<ref name=\"why_garbage_auth\">'''Why does the protocol authenticate the garbage?''' Without garbage authentication, the garbage would be modifiable by a third party without consequences. We want to force any active attacker to have to maintain a full protocol state. In addition, such malleability without the consequence of connection termination could enable protocol fingerprinting.</ref>",
      "path": "bip-0324.mediawiki",
      "position": 11,
      "original_position": 11,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "ddb6a5ca6c6465a2abcc74dcdcf14f6c238cce79",
      "in_reply_to_id": 1338595864,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It would be very uncommon for a fully encrypted protocol not to abort in case of an attacker modifying data on the wire. So as an attacker, you could flip some bits in the garbage, notice that the connection is not dropped, and then conclude that v2 is running. (edit: Note that I'm touching this sentence.)",
      "created_at": "2023-09-27T13:25:47Z",
      "updated_at": "2023-09-27T13:26:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1338607980",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1338607980"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 127,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339839820",
      "pull_request_review_id": 1648346345,
      "id": 1339839820,
      "node_id": "PRRC_kwDOAN28mc5P3FVM",
      "diff_hunk": "@@ -370,18 +369,22 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator\n+    send(peer, peer.send_garbage_terminator)\n+    # Optionally send decoy packets after garbage terminator.\n+    aad = peer.sent_garbage\n+    for decoy_content_len in decoy_content_lengths:\n+        send(v2_enc_packet(peer, decoy_content_len * b'\\x00', aad=aad))\n+        aad = b''\n+    # Send version packet.\n+    send(v2_enc_packet(peer, TRANSPORT_VERSION, aad=aad))",
      "path": "bip-0324.mediawiki",
      "position": 95,
      "original_position": 95,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit:\r\n```py\r\naad = b''\r\n```\r\n\r\nMaybe also rename to `send_aad`.",
      "created_at": "2023-09-28T09:45:46Z",
      "updated_at": "2023-09-28T10:01:00Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1339839820",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339839820"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 380,
      "original_line": 380,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339858276",
      "pull_request_review_id": 1648346345,
      "id": 1339858276,
      "node_id": "PRRC_kwDOAN28mc5P3J1k",
      "diff_hunk": "@@ -370,18 +369,22 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator\n+    send(peer, peer.send_garbage_terminator)\n+    # Optionally send decoy packets after garbage terminator.\n+    aad = peer.sent_garbage\n+    for decoy_content_len in decoy_content_lengths:\n+        send(v2_enc_packet(peer, decoy_content_len * b'\\x00', aad=aad))\n+        aad = b''\n+    # Send version packet.\n+    send(v2_enc_packet(peer, TRANSPORT_VERSION, aad=aad))\n     # Skip garbage, until encountering garbage terminator.\n     received_garbage = recv(peer, 16)\n     for i in range(4096):\n         if received_garbage[-16:] == peer.recv_garbage_terminator:\n-            # Receive, decode, and ignore garbage authentication packet (decoy or not)\n-            v2_receive_packet(peer, aad=received_garbage, skip_decoy=False)\n-            # Receive, decode, and ignore version packet, skipping decoys\n-            v2_receive_packet(peer)\n+            # Receive, decode, and ignore version packet.\n+            # This includes skipping decoys and authenticating the received garbage.\n+            v2_receive_packet(peer, aad=received_garbage)",
      "path": "bip-0324.mediawiki",
      "position": 106,
      "original_position": 106,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Mmm, the `v2_receive_packet` helper now includes assumptions that only make sense in the handshake.\r\n\r\nMaybe instead it can return a type and content? And also not do `aad = b''`.\r\n\r\nSo then this code becomes something like:\r\n\r\n```python\r\n# Receive, decode, and ignore version packet.\r\n# This includes skipping decoys and authenticating the received garbage.\r\naad = received_garbage\r\nwhile true:\r\n  (type, content) = v2_receive_packet(peer, aad=aad)\r\n  aad = b''\r\n  break if type == VERSION\r\n  throw if type != IGNORE\r\n```",
      "created_at": "2023-09-28T09:59:32Z",
      "updated_at": "2023-09-28T10:01:00Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1339858276",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339858276"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 387,
      "original_line": 387,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339890646",
      "pull_request_review_id": 1648415442,
      "id": 1339890646,
      "node_id": "PRRC_kwDOAN28mc5P3RvW",
      "diff_hunk": "@@ -370,18 +369,22 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator\n+    send(peer, peer.send_garbage_terminator)\n+    # Optionally send decoy packets after garbage terminator.\n+    aad = peer.sent_garbage\n+    for decoy_content_len in decoy_content_lengths:\n+        send(v2_enc_packet(peer, decoy_content_len * b'\\x00', aad=aad))\n+        aad = b''\n+    # Send version packet.\n+    send(v2_enc_packet(peer, TRANSPORT_VERSION, aad=aad))\n     # Skip garbage, until encountering garbage terminator.\n     received_garbage = recv(peer, 16)\n     for i in range(4096):\n         if received_garbage[-16:] == peer.recv_garbage_terminator:\n-            # Receive, decode, and ignore garbage authentication packet (decoy or not)\n-            v2_receive_packet(peer, aad=received_garbage, skip_decoy=False)\n-            # Receive, decode, and ignore version packet, skipping decoys\n-            v2_receive_packet(peer)\n+            # Receive, decode, and ignore version packet.\n+            # This includes skipping decoys and authenticating the received garbage.\n+            v2_receive_packet(peer, aad=received_garbage)",
      "path": "bip-0324.mediawiki",
      "position": 106,
      "original_position": 106,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "in_reply_to_id": 1339858276,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Mmm, the `v2_receive_packet` helper now includes assumptions that only make sense in the handshake.\r\n\r\nDoes it? Can you spell them out explicitly?\r\n\r\nIf you're referring to \"Only the first packet is expected to have non-empty AAD.\", then I think this will also be the case if we ever use AAD for anything else than garbage. Even in that case, you'd always want to skip decoy packets and it's reasonable to include the AAD in the first packet. This assumes that the AAD will always be determined by the received (non-decoy) packets or the outer header (see my response in the Core PR: https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1339889801).",
      "created_at": "2023-09-28T10:25:11Z",
      "updated_at": "2023-09-28T10:25:12Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1339890646",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339890646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 387,
      "original_line": 387,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339911521",
      "pull_request_review_id": 1648444472,
      "id": 1339911521,
      "node_id": "PRRC_kwDOAN28mc5P3W1h",
      "diff_hunk": "@@ -370,18 +369,22 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator\n+    send(peer, peer.send_garbage_terminator)\n+    # Optionally send decoy packets after garbage terminator.\n+    aad = peer.sent_garbage\n+    for decoy_content_len in decoy_content_lengths:\n+        send(v2_enc_packet(peer, decoy_content_len * b'\\x00', aad=aad))\n+        aad = b''\n+    # Send version packet.\n+    send(v2_enc_packet(peer, TRANSPORT_VERSION, aad=aad))\n     # Skip garbage, until encountering garbage terminator.\n     received_garbage = recv(peer, 16)\n     for i in range(4096):\n         if received_garbage[-16:] == peer.recv_garbage_terminator:\n-            # Receive, decode, and ignore garbage authentication packet (decoy or not)\n-            v2_receive_packet(peer, aad=received_garbage, skip_decoy=False)\n-            # Receive, decode, and ignore version packet, skipping decoys\n-            v2_receive_packet(peer)\n+            # Receive, decode, and ignore version packet.\n+            # This includes skipping decoys and authenticating the received garbage.\n+            v2_receive_packet(peer, aad=received_garbage)",
      "path": "bip-0324.mediawiki",
      "position": 106,
      "original_position": 106,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "in_reply_to_id": 1339858276,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It depends on how the AAD is used, which you elaborated on here: https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1339889801\r\n\r\nIf the AAD is set at the level of traffic shaping then it might be different for decoy and real messages. If it's only used at the application level then I agree it's probably fine to set it in the first (decoy) message.\r\n\r\nIf we believe the latter is much more likely, then I suppose a simple comment in the helper function would suffice:\r\n\r\n```python\r\n# This includes skipping decoys and authenticating the received garbage.\r\n# We assume that for future AAD uses, beyond the handshake, its contents\r\n# is determined before a package is received and is checked in the first\r\n# message, even if that's a decoy.\r\n```",
      "created_at": "2023-09-28T10:41:31Z",
      "updated_at": "2023-09-28T10:42:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1339911521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1339911521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 387,
      "original_line": 387,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1340366913",
      "pull_request_review_id": 1649206372,
      "id": 1340366913,
      "node_id": "PRRC_kwDOAN28mc5P5GBB",
      "diff_hunk": "@@ -370,18 +369,22 @@ def complete_handshake(peer, initiating):\n     ecdh_secret = v2_ecdh(peer.privkey_ours, ellswift_theirs, peer.ellswift_ours,\n                           initiating=initiating)\n     initialize_v2_transport(peer, ecdh_secret, initiating=True)\n-    # Send garbage terminator + garbage authentication packet + version packet.\n-    send(peer, peer.send_garbage_terminator +\n-               v2_enc_packet(peer, b'', aad=peer.sent_garbage) +\n-               v2_enc_packet(peer, TRANSPORT_VERSION))\n+    # Send garbage terminator\n+    send(peer, peer.send_garbage_terminator)\n+    # Optionally send decoy packets after garbage terminator.\n+    aad = peer.sent_garbage\n+    for decoy_content_len in decoy_content_lengths:\n+        send(v2_enc_packet(peer, decoy_content_len * b'\\x00', aad=aad))\n+        aad = b''\n+    # Send version packet.\n+    send(v2_enc_packet(peer, TRANSPORT_VERSION, aad=aad))\n     # Skip garbage, until encountering garbage terminator.\n     received_garbage = recv(peer, 16)\n     for i in range(4096):\n         if received_garbage[-16:] == peer.recv_garbage_terminator:\n-            # Receive, decode, and ignore garbage authentication packet (decoy or not)\n-            v2_receive_packet(peer, aad=received_garbage, skip_decoy=False)\n-            # Receive, decode, and ignore version packet, skipping decoys\n-            v2_receive_packet(peer)\n+            # Receive, decode, and ignore version packet.\n+            # This includes skipping decoys and authenticating the received garbage.\n+            v2_receive_packet(peer, aad=received_garbage)",
      "path": "bip-0324.mediawiki",
      "position": 106,
      "original_position": 106,
      "commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "original_commit_id": "75dc363d201072579289cc6d20d40ef7a67db291",
      "in_reply_to_id": 1339858276,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Truth is, we have no idea how the AAD would be used in future extensions, or even whether it'll ever get used for anything but garbage authentication.\r\n\r\nIn light of that, it feels unnecessary to impose a particular \"grand design\" for future extensions or their interaction with AAD and explain it in the specification. We simply pick a particular design because it's concise and can be rationalized, but I don't think we need to specify future behavior - that feels like an analogue of premature optimization (premature specification?).\r\n\r\n\"Set the expected AAD when processing garbage + terminator, verify the expected AAD whenever any packet is received, and reset the expected AAD to nothing after verifying a packet\" is one concise and simple description, and I can imagine that it remains usable for hypothetical extensions that appropriate AAD for other purposes. And if not, those extensions can just change the specification.",
      "created_at": "2023-09-28T15:54:56Z",
      "updated_at": "2023-09-28T15:58:37Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1498#discussion_r1340366913",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/1340366913"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1498"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 387,
      "original_line": 387,
      "side": "RIGHT"
    }
  ]
}