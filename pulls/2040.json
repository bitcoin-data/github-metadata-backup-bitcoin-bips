{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/2040",
    "id": 3035878793,
    "node_id": "PR_kwDOAN28mc6089WJ",
    "html_url": "https://github.com/bitcoin/bips/pull/2040",
    "diff_url": "https://github.com/bitcoin/bips/pull/2040.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/2040.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/2040/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
    "number": 2040,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "BIP93: Generalize codex32 format for any hrp and fix typos",
    "user": {
      "login": "BenWestgate",
      "id": 73506583,
      "node_id": "MDQ6VXNlcjczNTA2NTgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenWestgate",
      "html_url": "https://github.com/BenWestgate",
      "followers_url": "https://api.github.com/users/BenWestgate/followers",
      "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
      "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
      "repos_url": "https://api.github.com/users/BenWestgate/repos",
      "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "**Summary of Changes:**\r\nDescribe codex32 format for arbitrary human-readable parts not just \"ms\", specify master seed encoding standard, add new test vectors and enhance readability. This makes the document more like BIP-0173: proposing an encoding \"codex32\", then defining a standard for something using it.\r\n\r\nSee discussion on https://github.com/bitcoin/bips/pull/2023#issuecomment-3538570493.\r\n\r\n**Spec:**\r\n- fixed the threshold mistake in the abstract\r\n- replaced \"master seed\" with \"secret\", prior to the \"Master seed format\" section and made descriptions hrp general\r\n- updated the checksum reference code to produce valid checksums for any `hrp`\r\n- change _t_ to _k_ to match the test vectors and book\r\n- defined \"ms\" codex32 secrets:\r\n  - using terms \"secret seed\" (as the book does) and \"codex32-encoded master seed\" to refer to \"ms\" codex32 secrets\r\n  - recommended using first 4 characters of the bech32-encoded fingerprint as the identifier\r\n  - recommended the padding bits be set with a CRC code for extra error detection. Provided reference code for this checksum.\r\n\r\n**Test Vectors:**\r\n\r\n- Fixed the cornucopia of naming conventions in the Test vectors \r\n  - used mostly \"secret seed\", \"codex32 secret\", and \"codex32-encoded X\".\r\n- Fixed test vector 5 which did not actually append a long checksum to \"random\" data as the text said it would.\r\n- Added vector 6 encoding a \"cl\" prefix codex32-encoded HSM secret, then relabels the identifier (producing a new checksum and codex32-encoded HSM secret)\r\n- Added vector 7 which parses a \"cl\" prefix codex32 secret and decodes the HSM secret\r\n- Clarified why invalid prefix test vectors were bad (their checksum is for \"ms\" but their prefix is not \"ms\")\r\n- We might want to add one that uses \"cl\" with the old \"ms\" checksum code as that will now fail with the updated `ms32_verify_checksum` function\r\n\r\n",
    "labels": [
      {
        "id": 275846070,
        "node_id": "MDU6TGFiZWwyNzU4NDYwNzA=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Proposed%20BIP%20modification",
        "name": "Proposed BIP modification",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 286161898,
        "node_id": "MDU6TGFiZWwyODYxNjE4OTg=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Pending%20acceptance",
        "name": "Pending acceptance",
        "description": "This BIP modification requires sign-off by the champion of the BIP being modified",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2025-11-22T06:36:29Z",
    "updated_at": "2025-11-27T22:41:29Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merged": false,
    "merge_commit_sha": "acc626054ac5dc4d95dd8237e9d3ebfdf214c983",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "BenWestgate:bip93-fix-threshold",
      "ref": "bip93-fix-threshold",
      "sha": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1040826915,
        "node_id": "R_kgDOPgnCIw",
        "name": "bips",
        "full_name": "BenWestgate/bips",
        "owner": {
          "login": "BenWestgate",
          "id": 73506583,
          "node_id": "MDQ6VXNlcjczNTA2NTgz",
          "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/BenWestgate",
          "html_url": "https://github.com/BenWestgate",
          "followers_url": "https://api.github.com/users/BenWestgate/followers",
          "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
          "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
          "repos_url": "https://api.github.com/users/BenWestgate/repos",
          "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/BenWestgate/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/BenWestgate/bips",
        "archive_url": "https://api.github.com/repos/BenWestgate/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/BenWestgate/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/BenWestgate/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/BenWestgate/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/BenWestgate/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/BenWestgate/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/BenWestgate/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/BenWestgate/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/BenWestgate/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/BenWestgate/bips/contributors",
        "deployments_url": "https://api.github.com/repos/BenWestgate/bips/deployments",
        "downloads_url": "https://api.github.com/repos/BenWestgate/bips/downloads",
        "events_url": "https://api.github.com/repos/BenWestgate/bips/events",
        "forks_url": "https://api.github.com/repos/BenWestgate/bips/forks",
        "git_commits_url": "https://api.github.com/repos/BenWestgate/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/BenWestgate/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/BenWestgate/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/BenWestgate/bips.git",
        "issue_comment_url": "https://api.github.com/repos/BenWestgate/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/BenWestgate/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/BenWestgate/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/BenWestgate/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/BenWestgate/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/BenWestgate/bips/languages",
        "merges_url": "https://api.github.com/repos/BenWestgate/bips/merges",
        "milestones_url": "https://api.github.com/repos/BenWestgate/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/BenWestgate/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/BenWestgate/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/BenWestgate/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:BenWestgate/bips.git",
        "stargazers_url": "https://api.github.com/repos/BenWestgate/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/BenWestgate/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/BenWestgate/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/BenWestgate/bips/subscription",
        "tags_url": "https://api.github.com/repos/BenWestgate/bips/tags",
        "teams_url": "https://api.github.com/repos/BenWestgate/bips/teams",
        "trees_url": "https://api.github.com/repos/BenWestgate/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/BenWestgate/bips.git",
        "hooks_url": "https://api.github.com/repos/BenWestgate/bips/hooks",
        "svn_url": "https://github.com/BenWestgate/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 16785,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-26T19:34:29Z",
        "created_at": "2025-08-19T15:04:43Z",
        "updated_at": "2025-11-21T03:37:46Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "3851847d0a67f85d40f44eb5c4090efe04a26ac5",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5829,
        "stargazers_count": 10379,
        "watchers_count": 10379,
        "size": 18434,
        "default_branch": "master",
        "open_issues_count": 71,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-26T00:58:17Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2025-11-27T02:35:13Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 209,
    "deletions": 95,
    "changed_files": 1,
    "commits": 5,
    "review_comments": 80,
    "comments": 11
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGM2ZjhiZDA3YTZkYzE4YzdkMTM4NzRhYWZhYmNjNzRjYWM5MWZlOTk",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
      "tree": {
        "sha": "055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1\nparent 3851847d0a67f85d40f44eb5c4090efe04a26ac5\nauthor Ben Westgate <BenWestgate@protonmail.com> 1763791137 -0600\ncommitter GitHub <noreply@github.com> 1763791137 -0600\n\nGeneralize codex32 format for any hrp and fix typos\n\nClarify codex32 format for different hrp values, specify master seed encoding standard, add new test vectors and enhance readability.",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpIVEhCRC1aQ7uu5UhlAAAsHcQAGNFIDefetvZU5gfMvs0YDfJ\nGItxRxGN86n+pTJHYnj0+oS7ikeO8BWavod25zMfSyqwOx+erQXi0xeL1mfVnpm+\nsAf1loP3+b3zyF/OZHFf6dO56IUF76B8YDTpltxRL2oF0JAX1PeofUSVAr5FmhCI\nOSpUV4EeExD1cXk5GYL2xxKaCk0JiVRgyMsKnMUthrYjz1pYt8B0fSh849oLjcuJ\nF1l/pYpxcm6KRgU1sIv8a7wjJz7tMPrQUnasOGSPSSVmFU+X7Flj5p2l6eAKEo+n\n7ynP/JNrttOQJJjnjnsZtZqlYYwYeEffiNQVJ/6BDMv6e3k+D8+X6qpfE2r4zd0C\neeZiyvOtIsm/ekkGgrfRSBkU6BxIJLEzue4g8uW6nfN/9x+SvPOhjCkZpJpIz/1i\n8LPvtgYesB1bapPPiCKHnKt3rVUiV8mKwxaaWeDMDJESzwZnVLSbQPuBNO7vYoqe\nY8Dez1yG1vTSni59cTYdtmLuVEaLQ3URZOewq/xy85vlwnCfxLa8gluBV4PnF6FF\nvrPIue8cnX2O/7U/QOjK2CaVhK8TG/RnKFIqu6uD9yhSdAYbJBwGP9FEp0UJo5fp\nrpwpO7xTCAOADqA8VTtAy7xXxrynJBCPYQjb50FinNEq1AXmGlJpKqK4J+euPD9D\nTg7/Iy7qdZg+ct8Igwd0\n=/fdx\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/3851847d0a67f85d40f44eb5c4090efe04a26ac5",
          "sha": "3851847d0a67f85d40f44eb5c4090efe04a26ac5",
          "html_url": "https://github.com/bitcoin/bips/commit/3851847d0a67f85d40f44eb5c4090efe04a26ac5"
        }
      ],
      "message": "Generalize codex32 format for any hrp and fix typos\n\nClarify codex32 format for different hrp values, specify master seed encoding standard, add new test vectors and enhance readability.",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-22T05:58:57Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-22T05:58:57Z"
      },
      "sha": "c6f8bd07a6dc18c7d13874aafabcc74cac91fe99"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGFlZGI5MTJiZDE3YzA3MzZiMjFhY2NkODRjM2Y1Y2UzZTBiN2Q2MTc",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "tree": {
        "sha": "30dd8e433da05e27bc94b4734de348b5952381af",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/30dd8e433da05e27bc94b4734de348b5952381af"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 30dd8e433da05e27bc94b4734de348b5952381af\nparent c6f8bd07a6dc18c7d13874aafabcc74cac91fe99\nauthor Ben Westgate <BenWestgate@protonmail.com> 1763793765 -0600\ncommitter GitHub <noreply@github.com> 1763793765 -0600\n\nRevert title for BIP93 document",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpIVtlCRC1aQ7uu5UhlAAAUIkQACVNHJMVtYJhDr6Dl5U3+ew5\nEQ5uNCE4wD8WL5yizGR2Pu/5H2tUav13045cJ1lhd84oO/MFnqRl9MbF7P0jfJWs\nUe17jXH5nfy0nJWFgXAXVWDjicd4dcMImhqdb1Jcwjw71MtbTrjfZyEUePD3NNXI\nxIfFUx3V58w+lPQVHXkfeNX6yyDcSeZHidMySZ7WFOYLGb5SHtjTGII9YUcIzArC\n65IPXhCeOXt847WZ9lmtyJrC0RBUAQyDxsQpUKh34GKLpscwaOSebov/2CUE+6wm\nqS/6/QsDJcd9+67sfFgPnbJr6KqZ6nZ2Y2yAmKPAlZt/kFZu2n96aUBOkjyVURS0\nMPhy/cojXlMi0lMwFKaLnklwjFykjcbBWGY+COFzLS0tEy+vfFQyIpoTKcVCdFMW\nwgDOZGtW7RVfBjK/rpajCG66tGNlmIn+QD6AwoxJx8Ityk/WIduk7G9VW1Lao6U0\n+lvrM2x3UjaL2t09qcgnuSmjAiXB8bV+APz9F0Q/iOVKTlpvtJn/R9FtPhj0poUm\nwWHmt/NAvR5UGEcqYFrzLdGJjsJwkVnZZuW3nKvTU0NIxxf1dbnwgl4mbnhTly1i\nhbVyc07OcsdKae2H3aHCEKYH9bYoyJp6JIA9iTTUJ4s6PRorRse8qGaF8oP5bCr2\n50TtZHwtQqbDx0KrLOZO\n=Fepj\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
          "sha": "c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
          "html_url": "https://github.com/bitcoin/bips/commit/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99"
        }
      ],
      "message": "Revert title for BIP93 document",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-22T06:42:45Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-22T06:42:45Z"
      },
      "sha": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617"
    },
    {
      "event": "labeled",
      "id": 21115636144,
      "node_id": "LE_lADOAN28mc7ZzDLFzwAAAATqlwmw",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21115636144",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-22T15:17:02Z",
      "label": {
        "name": "Proposed BIP modification",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 21115636149,
      "node_id": "LE_lADOAN28mc7ZzDLFzwAAAATqlwm1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21115636149",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-22T15:17:02Z",
      "label": {
        "name": "Pending acceptance",
        "color": "fbca04"
      }
    },
    {
      "event": "reviewed",
      "id": 3501457605,
      "node_id": "PRR_kwDOAN28mc7QtADF",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-24T17:41:35Z",
      "author_association": "NONE",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3501457605",
      "submitted_at": "2025-11-24T17:41:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3501578813,
      "node_id": "PRR_kwDOAN28mc7Qtdo9",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-24T17:53:09Z",
      "author_association": "NONE",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3501578813",
      "submitted_at": "2025-11-24T17:53:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3506316041,
      "node_id": "PRR_kwDOAN28mc7Q_iMJ",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T18:24:47Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3506316041",
      "submitted_at": "2025-11-25T18:24:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3506378123,
      "node_id": "PRR_kwDOAN28mc7Q_xWL",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T18:42:56Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3506378123",
      "submitted_at": "2025-11-25T18:42:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGE0ZjFlOTFhZDk0ODNiNWQ1ODNmZDdmNDBhY2JlYjA4MWUxMmNiNjI",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "tree": {
        "sha": "482677c072250d7a23dd1352c44d82c62ca70779",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/482677c072250d7a23dd1352c44d82c62ca70779"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 482677c072250d7a23dd1352c44d82c62ca70779\nparent aedb912bd17c0736b21accd84c3f5ce3e0b7d617\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764108387 -0600\ncommitter GitHub <noreply@github.com> 1764108387 -0600\n\nRename ms32 functions to codex32, remove recommendations, clarify HRP case in checksum",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJihjCRC1aQ7uu5UhlAAA1wsQAFS/gKYe1pDyrdZGbr26AU7M\nHxhzpJnEqN5gdmvm5s8NhLOcz3goTdJ2m4fei1QL+Q84c4RXXPUePxkdBuym9mcl\n2G5Lul0mVInRYnV5QHq55w7LXM36oXHGBGauKqWtrOkcA1Jp9tcI+tzeGlNkrN9m\nSyFtWFeLZ5gO0MTNGx5Eg5mpXXjQFHLcwcs6mSSp8LIEUmg8STyW4l1RGfoZ8ZJK\nz0MZXPkErnz6h0x6WWx5ATgcuO/OEY5aTDnT9d9aEOR9X9dr2iVIgWmahQFiW5NE\nAuO6izufEJTLFXjMw2/yQqpvAJCCli2qI42s4XKM/3KnuHMPaUCxDQjLNKtIQcN5\nF7kBzHotOlNGE9esuQYrt4IPtkLX43D6VaDyrMjtAQFrLP6fs8wd5y8I6ooKYE1h\nkPI8gV68tE5yLxVO77lI7hYo4th4NpxVH45MLCpS0BfGwyxuesfy9a0OXaMKxzJR\n41U/TmYW/8+pp2aGcnMlNb6a5p2Y9UpVE8sMA/ErQgK/o4zA++hbmAaS5osCQVKW\nu1pFlMAhhliXzmzwLqAE+3l1lWIr32gUcHM5eI4iffjm0nKlJtLIxY52JybItugV\nE429P9fNfylstS+K6TiaHBuFrUKdOH8jm1wiCMg6mYrRjXDxfbaULTVYIxIsF3lq\nOITFUjbWn8WM2tNJBIEU\n=+x6B\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
          "sha": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
          "html_url": "https://github.com/bitcoin/bips/commit/aedb912bd17c0736b21accd84c3f5ce3e0b7d617"
        }
      ],
      "message": "Rename ms32 functions to codex32, remove recommendations, clarify HRP case in checksum",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-25T22:06:27Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-25T22:06:27Z"
      },
      "sha": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62"
    },
    {
      "event": "reviewed",
      "id": 3507072048,
      "node_id": "PRR_kwDOAN28mc7RCaww",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:10:40Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507072048",
      "submitted_at": "2025-11-25T22:10:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507092272,
      "node_id": "PRR_kwDOAN28mc7RCfsw",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:16:07Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507092272",
      "submitted_at": "2025-11-25T22:16:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507106951,
      "node_id": "PRR_kwDOAN28mc7RCjSH",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:19:55Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507106951",
      "submitted_at": "2025-11-25T22:19:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507128287,
      "node_id": "PRR_kwDOAN28mc7RCoff",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:25:46Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507128287",
      "submitted_at": "2025-11-25T22:25:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507145870,
      "node_id": "PRR_kwDOAN28mc7RCsyO",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:30:23Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507145870",
      "submitted_at": "2025-11-25T22:30:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGY3NDUyN2VkNGYwZjEyNjc2ZjVkMjBkOTk3MWNlMjY2NTc4MGYwZmE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
      "tree": {
        "sha": "96fa56c0148ec59238acd8baf3dbc2fe37160e62",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/96fa56c0148ec59238acd8baf3dbc2fe37160e62"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 96fa56c0148ec59238acd8baf3dbc2fe37160e62\nparent a4f1e91ad9483b5d583fd7f40acbeb081e12cb62\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764185586 -0600\ncommitter GitHub <noreply@github.com> 1764185586 -0600\n\nFix Test vector 5, add encode/decode ref, add length limit, add clairity\n\nClarify codex32 specification and examples for encoding and decoding processes, including detailed explanations of parameters and checksum handling.",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJ1XyCRC1aQ7uu5UhlAAA5AgQAEnclL/c6gZJYd3xxYZKHitI\n4mqnPVylXW0dsqTLLrD6oKIXSEZflnD7gkHwg252XnfnOHz906N9Z5PVctkkzNcT\n71u94A2PZhDacemRVS6NOCAMo7zhWuar6BTsrBfwRBRmMRA5hTO3aA0ksNooQXmj\nk+cKB87wZlKWaas7ZSqv3moLrsSTlyb3bR/f77DbgScYFTivgLN6ShhFnVeb3VzM\nkm75yc19+yxJkgPeZG06Y5ToZpjPgHDy4GLgwOq7Bv5Gm1IbDOAEEDLVtfvBDS7r\nU3xxQUPmtSTzZN9S2/Ctw/nOBQfj7DjSaF1Fi/35jh3XXJH8sVmYLvTxmq5/WMQ1\nx2CsWZpHhsAXV6zLBOMM6ZVzYo6mtuwO9+KZPTCfQg4H9TccRPx0i5xetocXrP8n\nqEvATnmXXncnVdPOz3wtqzGXk6EFzMMDIQ0MX/q80LIWRHUy9OUmmGQQNiY13CTw\nG9Pv8Bet9wm9ZR/Zw47+5ROk/+ueWORe1w+YExpQjzKFf93H/N3odnj78GwXYQBb\npKQLtTLIBNw4+a85Qqrqi35R3eiWUfW6LTQ3jTcA91dnGCIQ8zXVwZsV4maSdoml\nDB/D0AF73kmUaPGkfr0RUFtyFGo6M4JMmvJKEdKireVPzlOx+Gj22YXcyWap6eMM\nrMO2QHbUh7Yzvqmz9rOn\n=+N/P\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
          "sha": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
          "html_url": "https://github.com/bitcoin/bips/commit/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62"
        }
      ],
      "message": "Fix Test vector 5, add encode/decode ref, add length limit, add clairity\n\nClarify codex32 specification and examples for encoding and decoding processes, including detailed explanations of parameters and checksum handling.",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-26T19:33:06Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-26T19:33:06Z"
      },
      "sha": "f74527ed4f0f12676f5d20d9971ce2665780f0fa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDMxMjNjZWFkMWQwZDkyZWRiYzllM2U4OTgxNGJkNTdlZTFkMTQ2N2Q",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "tree": {
        "sha": "b02343a49b3d39eacd736308323742d9f9e1f422",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/b02343a49b3d39eacd736308323742d9f9e1f422"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b02343a49b3d39eacd736308323742d9f9e1f422\nparent f74527ed4f0f12676f5d20d9971ce2665780f0fa\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764185669 -0600\ncommitter GitHub <noreply@github.com> 1764185669 -0600\n\nRevert deleted new line",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJ1ZFCRC1aQ7uu5UhlAAAEYQQAAwUh1tP8FKlGfuCH35j6XWr\nY0RNXg2nGRfMSvkEa4lABULYkptSIzjn1mfbbRU1HJQppaIu7JLgocIP3JuC8X7M\npF3QTbLu1WKjD62PdqPtLAszqBZooipbYTcst/DZV0u53FB8PeyhFlRN7V6UrI7K\nz7VKll7G8zDu6PIzabe4B75/mYp4cs1TfziFoHQu/pmJVx6cTEEfDHvNRwk1MZYi\ni9QR2PxgQz2i5AcKCO2UlJbZQ1aiRh9MWqh56p9PQkYAAEwp27Z1QPUivy2d2XpH\n297z/rFYNdOoRIZec8+w7RyW6XYdGpSDGl8Hz4lSg6Uxby9Amnvyz4FfbQ1USuq9\nMYoGp7VoEC9/1PVdGop9nSWcyBlSfkkeIRlvG8UX4Vm8HqLLYjCfrPBlfyBrLAv0\n5Ln+DXC0F9mYAwSs5n+mwhhuwptSDzt38DJmOCWvubxmH1LVsbAZdNmOC0idfoCM\nCVYSXcQk1bBtQL4ZXVj0pUrNLNGbUexYro5leTS3eJr5COW9dTNN/bD9NPZ3DrGV\nuo0TZiuRsbpRCuP/DDXPZ7P2y+pYR2fQc4PPo/3HPU/dUDmVlIl24//K4QDGiQGC\nfWFSoR0ge9L56Rxjkn7yi8NZRn0PeorUTtZDhB6cNrgDWJxd7WhyAJRXOazd5SqE\ntQ9y01fv4OtbxCGP5i8W\n=qEZv\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
          "sha": "f74527ed4f0f12676f5d20d9971ce2665780f0fa",
          "html_url": "https://github.com/bitcoin/bips/commit/f74527ed4f0f12676f5d20d9971ce2665780f0fa"
        }
      ],
      "message": "Revert deleted new line",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-26T19:34:29Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-26T19:34:29Z"
      },
      "sha": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d"
    },
    {
      "event": "reviewed",
      "id": 3512534912,
      "node_id": "PRR_kwDOAN28mc7RXQeA",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:44:13Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512534912",
      "submitted_at": "2025-11-26T19:44:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3512545868,
      "node_id": "PRR_kwDOAN28mc7RXTJM",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:48:48Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512545868",
      "submitted_at": "2025-11-26T19:48:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3512550880,
      "node_id": "PRR_kwDOAN28mc7RXUXg",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:50:44Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512550880",
      "submitted_at": "2025-11-26T19:50:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3583669131,
      "node_id": "IC_kwDOAN28mc7VmnOL",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3583669131",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:34Z",
      "updated_at": "2025-11-27T00:48:34Z",
      "author_association": "NONE",
      "body": "Fair enough, double counting it is. That's easy to remember and implement.\n\nPacking the 7-bit values together wouldn't have helped much anyway because single ASCII errors would affect multiple data symbols especially when isolated.\n\nI'll be adding your length of the string is 93 - length of the HRP.\n\nAnd we're keeping the special rule for 96 where the HRP MUST equal \"MS\"?\n\nSent with [Proton Mail](https://proton.me/mail/home) secure email.\n\nOn Wednesday, November 26th, 2025 at 6:41 PM, roconnor ***@***.***> wrote:\n\n> @roconnor commented on this pull request.\n>\n> ---------------------------------------------------------------\n>\n> In [bip-0093.mediawiki](https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573):\n>\n>>      polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n>      return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n>  </source>\n>\n> +This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n> +guarantees detection of '''any error affecting at most 8 characters'''\n> +and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n> +errors. The human-readable part is processed by first\n> +feeding the higher bits of each character's US-ASCII value into the\n> +checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n> +This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the\n>\n>> What do we need to restrict it to in order to allow every US-ASCII character? Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\n>\n> The issue is that for BCH codes the data really needs to fit within their length restriction, so we cannot just count entropy. Even if we know some some bits are fixed, if the polynomial we extract has degree more that 93, everything falls apart because it can no longer distinguish errors on one side of the polynomial from errors on the other side of the polynomial. The rules that the the string length plus counting the hrp again must be less than 93 is the only thing that makes the HRP expanded polynomial concatenated with the data part fit in degree at most 93.\n>\n> \n> Reply to this email directly, [view it on GitHub](https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/ARQZ6F5CUBY3QXAITRFPOLL36ZCEHAVCNFSM6AAAAACM4BCWD6VHI2DSMVQWIX3LMV43YUDVNRWFEZLROVSXG5CSMV3GSZLXHMZTKMJTGEYDOMBQHA).\n> You are receiving this because you authored the thread.Message ID: ***@***.***>",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3583669131",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21207813587,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAATwFY3T",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21207813587",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:35Z"
    },
    {
      "event": "subscribed",
      "id": 21207813600,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAATwFY3g",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21207813600",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:36Z"
    },
    {
      "event": "commented",
      "id": 3583676996,
      "node_id": "IC_kwDOAN28mc7VmpJE",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3583676996",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:52:31Z",
      "updated_at": "2025-11-27T00:54:37Z",
      "author_association": "NONE",
      "body": "Yes let's keep the silly exception for now for the sake of getting a agreeable PR.  We should hammer out the master seed bit-size restrictions in a separate PR.\r\n\r\nIf you want to say that length 96 ms seeds are deprecated that's okay too.  But I still want to argue for the merits of 160 bit master seeds.",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3583676996",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "reviewed",
      "id": 3513818681,
      "node_id": "PRR_kwDOAN28mc7RcJ45",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:18:15Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513818681",
      "submitted_at": "2025-11-27T07:18:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3513826410,
      "node_id": "PRR_kwDOAN28mc7RcLxq",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:21:37Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513826410",
      "submitted_at": "2025-11-27T07:21:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3584502682,
      "node_id": "IC_kwDOAN28mc7Vpyua",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3584502682",
      "actor": {
        "login": "bosshaas13131313",
        "id": 189472237,
        "node_id": "U_kgDOC0sd7Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/189472237?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosshaas13131313",
        "html_url": "https://github.com/bosshaas13131313",
        "followers_url": "https://api.github.com/users/bosshaas13131313/followers",
        "following_url": "https://api.github.com/users/bosshaas13131313/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bosshaas13131313/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bosshaas13131313/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bosshaas13131313/subscriptions",
        "organizations_url": "https://api.github.com/users/bosshaas13131313/orgs",
        "repos_url": "https://api.github.com/users/bosshaas13131313/repos",
        "events_url": "https://api.github.com/users/bosshaas13131313/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bosshaas13131313/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T07:23:14Z",
      "updated_at": "2025-11-27T07:23:14Z",
      "author_association": "NONE",
      "body": "No.\r\n\r\nOn Thu, Nov 27, 2025, 2:20AM Ben Westgate ***@***.***> wrote:\r\n\r\n> ***@***.**** commented on this pull request.\r\n> ------------------------------\r\n>\r\n> In bip-0093.mediawiki\r\n> <https://github.com/bitcoin/bips/pull/2040#discussion_r2567413699>:\r\n>\r\n> > +def codex32_verify_checksum(hrp, data):\r\n>      if len(data) >= 96:                      # See Long codex32 Strings\r\n> -        return ms32_verify_long_checksum(data)\r\n> +        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\r\n>      if len(data) <= 93:\r\n> -        return ms32_polymod(data) == MS32_CONST\r\n> +        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\r\n>      return False\r\n>\r\n> Needs to become now to:\r\n>\r\n> def codex32_verify_checksum(hrp, data):\r\n>     combined = bech32_hrp_expand(hrp) + data\r\n>     if len(combined) >= 96:\r\n>         return codex32_verify_long_checksum(combined)\r\n>     if len(combined) <= 93:\r\n>         return codex32_polymod(combined) == CODEX32_CONST\r\n>     return False\r\n>\r\n> Missing:\r\n>\r\n>    - the thorny zero length \"ms\" rule.\r\n>    - the check in codex32_decode() for the upper long codex32 length\r\n>    limit.\r\n>\r\n> Because of this new max length rule rule we have the curious situation\r\n> where valid \"long codex32\" strings can actually be shorter overall (and in\r\n> data part characters) than regular codex32.\r\n>\r\n> May want to rename that format any thoughts?\r\n>\r\n> Ex:\r\n> \"long\" codex32 format: 10 hrp characters + 1 + 6 header characters + 54\r\n> payload characters + 15 checksum characters = 86\r\n> codex32 format: \"ms\" hrp characters + 1 + 6 header characters + 74 payload\r\n> characters + 13 checksum characters = 96\r\n>\r\n> \r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513818681>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/BNFR33IQPDGIR4ICII5KOVT362Q2BAVCNFSM6AAAAACM4BCWD6VHI2DSMVQWIX3LMV43YUDVNRWFEZLROVSXG5CSMV3GSZLXHMZTKMJTHAYTQNRYGE>\r\n> .\r\n> You are receiving this because you are subscribed to this thread.Message\r\n> ID: ***@***.***>\r\n>\r\n",
      "user": {
        "login": "bosshaas13131313",
        "id": 189472237,
        "node_id": "U_kgDOC0sd7Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/189472237?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosshaas13131313",
        "html_url": "https://github.com/bosshaas13131313",
        "followers_url": "https://api.github.com/users/bosshaas13131313/followers",
        "following_url": "https://api.github.com/users/bosshaas13131313/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bosshaas13131313/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bosshaas13131313/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bosshaas13131313/subscriptions",
        "organizations_url": "https://api.github.com/users/bosshaas13131313/orgs",
        "repos_url": "https://api.github.com/users/bosshaas13131313/repos",
        "events_url": "https://api.github.com/users/bosshaas13131313/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bosshaas13131313/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3584502682",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "reviewed",
      "id": 3513909365,
      "node_id": "PRR_kwDOAN28mc7RcgB1",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:54:08Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513909365",
      "submitted_at": "2025-11-27T07:54:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3513922085,
      "node_id": "PRR_kwDOAN28mc7RcjIl",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:57:47Z",
      "author_association": "NONE",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513922085",
      "submitted_at": "2025-11-27T07:57:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3516098737,
      "node_id": "PRR_kwDOAN28mc7Rk2ix",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T15:41:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "This is what I have:\r\n- compatibility encoding for BIP-39, allowing to Shamir split mnemonic & extended private key wallets\r\n    * HRP: `cc`\r\n    * encodes chaincode + private key of BIP-32 master extended key (64 bytes)\r\n    * `cc10zcvjs5klr60nyt8usd553sge7r5glcy2ztwfv2d2smmcs7m3mq6dduwavccnjzjchlkffjfx8p3cjjx64q9vkxdt8q9qzuu3s8jfgjysa5pc5nezf2qkfhqpfwf`\r\n\r\n\r\nI only have one HRP, I do not differentiate between testnet/mainnet, even tho I use extended key data, I'm also using it for menmonics, where I first generate master BIP-32 key and then use those values for the codex32 secret share. DO you consider the lack of testnet/mainnet separation an issue?\r\n\r\nYour addition of HRP into checksum definitely broke my tests wrt checksum for `cc` hrp secrets  (not an issue, I haven't released yet - but I'm planning to in few weeks)\r\n\r\nMy HWW implementation is pretty much in accordance with https://github.com/BlockstreamResearch/codex32/blob/master/docs/wallets.md . My implementation is not ECW. I even provide generate support for secret share S.  I only allow to generate 128 & 256 bit MS secrets (but allow to import also 512 bit). In short:\r\n1. TRNG 256 entropy bits\r\n2. r = sha256(sha265(entropy))\r\n3. x = r[:byte_len]\r\n4. x is new master secret, and default ID is 20 MSB from master XFP (but user can change if he wishes to)\r\n\r\nWhat are the chances of this patch-set to be accepted? Is this spec stable enough to start releasing it ? ",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3516098737",
      "submitted_at": "2025-11-27T15:35:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3586533435,
      "node_id": "IC_kwDOAN28mc7Vxig7",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586533435",
      "actor": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T15:46:33Z",
      "updated_at": "2025-11-27T15:46:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "How I generate non-secret shares:\r\n1. From current loaded secret (whether it is mnemonic, xprv, or codex32)\r\n    * codex32: secret = master_seed (secret share with hrp MS)\r\n    * others: secret = chaincode + privkey (64bytes) (secret share with hrp CC)\r\n2. [BIP-85](https://github.com/bitcoin/bips/pull/1958) derive from above secret --> master secret for share 'a'\r\n3. interpolate secret share with share 'a' while changing only index (c,d,d,e,f,g,h...) to generate new shares",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586533435",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3586804792,
      "node_id": "IC_kwDOAN28mc7Vykw4",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586804792",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:56Z",
      "updated_at": "2025-11-27T17:16:48Z",
      "author_association": "NONE",
      "body": ">     * HRP: `cc`\n\n\"bc\" and \"tb\" for Bech32 addresses were an upgrade in human-readable prefix from the base58 encoding.\n\nI consider it a regression if you use less characters to encode a human-readable prefix than the base58 extended key format did. \"xpriv\" is an option here.\n\n>     * encodes chaincode + private key of BIP-32 master extended key (64 bytes)\n\nDoes your format need a 65th byte for the public key that is zero when encoding private keys?\n\nThere are many advantages to the strings needing disambiguation having the same byte length.\n\n> I only have one HRP, I do not differentiate between testnet/mainnet, ... DO you consider the lack of testnet/mainnet separation an issue?\n>\n\nYes, this is a huge regression from the current bip32 extended key format we want to upgrade. Mostly that I can't tell by looking at the descriptor if it's for real funds or not.\n\n> Your addition of HRP into checksum definitely broke my tests wrt checksum for `cc` hrp secrets  (not an issue, I haven't released yet - but I'm planning to in few weeks)\n\nHRP was always in the checksum, it just was pre-computed for \"ms\" so the checksums for other HRP were wrong. I noticed when I tried to validate the CLN HSM secret examples in my python-codex32 package.\n\n\n> My implementation is not ECW.\n\n@roconnor has a PR in codex32 that does ECC you could test.\n\n>I even provide generate support for secret share S.  I only allow to generate 128 & 256 bit MS secrets (but allow to import also 512 bit).\n\nI have a codex32 PR to update wallets.md guidance for generation, you may see something useful, especially in the HWW case.\n\n\nIn short:\n> \n> 1. TRNG 256 entropy bits\n> \n> 2. r = sha256(sha265(entropy))\n> \n> 3. x = r[:byte_len]\n> \n> 4. x is new master secret, and default ID is 20 MSB from master XFP (but user can change if he wishes to)\n\n\nYou can and probably should use the entropy bits directly. If they lack entropy, sha256d is an illusion of security.\n\n> What are the chances of this patch-set to be accepted? Is this spec stable enough to start releasing it ? \n\nIt will need wider community review than us. But there's comments by P. Wuille as far back as 2020 stating a 4 error correcting bech32 encoding of extended keys is needed. So high acceptance changes once it's correct and shiney.\n\nThis spec PR will not change anything that affects your encoding of ~78 bytes or whatever an extended key has.\n\nWe're mostly debating behavior at the limit between short and long checksums. Yours unambiguously use long codex32.\n",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586804792",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21225380056,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAATxIZjY",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225380056",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:57Z"
    },
    {
      "event": "subscribed",
      "id": 21225380081,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAATxIZjx",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225380081",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:57Z"
    },
    {
      "event": "commented",
      "id": 3586823887,
      "node_id": "IC_kwDOAN28mc7VypbP",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586823887",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:10:34Z",
      "updated_at": "2025-11-27T17:10:34Z",
      "author_association": "NONE",
      "body": "> How I generate non-secret shares:\n\n> 2. [BIP-85](https://github.com/bitcoin/bips/pull/1958) derive from above secret --> master secret for share 'a'\n> \n> 3. interpolate secret share with share 'a' while changing only index (c,d,d,e,f,g,h...) to generate new shares\n\nIt is unsafe to child derive shares from the secret they recover. They should be independently random.\n\nWhen part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\n",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586823887",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3586929781,
      "node_id": "IC_kwDOAN28mc7VzDR1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586929781",
      "actor": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:54:56Z",
      "updated_at": "2025-11-27T17:54:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "> HRP was always in the checksum, it just was pre-computed for \"ms\" so the checksums for other HRP were wrong. I noticed when I tried to validate the CLN HSM secret examples in my python-codex32 package.\r\n\r\nI see now...\r\n\r\n> It is unsafe to child derive shares from the secret they recover. They should be independently random.\r\n\r\nI do not want to use randomness here, as I want to split existing secret, and I require the \"split\" to be deterministic, so that if user is splitting the exact same secret, uses same hrp, same threshold, same id, and same number of shares - application always produces the exact same shares. I could add an option to to choose, if random, or deterministic split, but deterministic is a hard requirement.\r\n\r\n...also it is 5 hardened derivation steps plus hmac_sha512\r\n\r\n> When part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\r\n\r\nthere are plenty other brute-force options if attacker has part of secret, I do not consider this scenario of yours to be something I should optimize for\r\n\r\n> Yes, this is a huge regression from the current bip32 extended key format we want to upgrade. Mostly that I can't tell by looking at the descriptor if it's for real funds or not.\r\n\r\nI do not encode extended key (or full extended key), I only encode chaincode + privkey, without any other data as I just want to be able to restore naked xpriv from it, without any more meta extended keys carry. As I use it for both mnemonics and extended keys. \r\n\r\nThat is why I dismissed the idea of doing testnet/mainnet differentiation as I consider my 64bytes to be the \"secret\"",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586929781",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587130262,
      "node_id": "IC_kwDOAN28mc7Vz0OW",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587130262",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T19:45:51Z",
      "updated_at": "2025-11-27T19:54:43Z",
      "author_association": "NONE",
      "body": "> > It is unsafe to child derive shares from the secret they recover. They should be independently random.\r\n> \r\n> I do not want to use randomness here, as I want to split existing secret, and I require the \"split\" to be deterministic, so that if user is splitting the exact same secret, uses same hrp, same threshold, same id, and same number of shares - application always produces the exact same shares. I could add an option to to choose, if random, or deterministic split, but deterministic is a hard requirement.\r\n\r\nThe best you could do here if you insist, is perform a KDF on the secret data to harden it before deriving child shares from that derived key. But it still reduces security from information theoretic to computational.\r\n\r\n> ...also it is 5 hardened derivation steps plus hmac_sha512\r\n\r\nStill significantly faster than address checking. The EC mult is the bottleneck for address checking is what Andrew told me.\r\n\r\n> > When part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\r\n> \r\n> there are plenty other brute-force options if attacker has part of secret, I do not consider this scenario of yours to be something I should optimize for\r\n\r\nMy point is your standard should be harder to exploit than all other options or we lose security for nothing. Simply deriving child shares from an argon2id or scrypt derived key is probably enough protection.\r\n\r\n> That is why I dismissed the idea of doing testnet/mainnet differentiation as I consider my 64bytes to be the \"secret\"\r\n\r\nIt seems better to encode the recovery words and wordlist with a `bip39_12w` or `bip39_24w` human-readable part encoding standard than encode the resulting private key and chaincode bytes. A full bip32 codex32 encoding standard would be more useful than a neutered master xprv only edition.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587130262",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587315890,
      "node_id": "IC_kwDOAN28mc7V0hiy",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587315890",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T21:30:39Z",
      "updated_at": "2025-11-27T21:30:39Z",
      "author_association": "NONE",
      "body": "- Can we keep BIP-0173 behavior of only guaranteeing detection in the lower 5 hrp character bits?\r\n- Does Error correction make us need to \" double count plus 1\" hrp so the upper bits are in range?\r\n- Or can we correct errors in the lower bits only, leaving the upper uncertain?\r\n\r\nThis table shows the undetectable errors, each row has 2-3 characters which cannot be distinguished since they differ only in the upper bits.\r\n<img width=\"324\" height=\"565\" alt=\"image\" src=\"https://github.com/user-attachments/assets/20ec9cdd-c65a-4b6c-aed9-9b7ef3825033\" />\r\n\r\n>[^](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki#cite_ref-5-0) Why are the high bits of the human-readable part processed first? This results in the actually checksummed data being [high] 0 [low] [data]. This means that under the assumption that errors to the human readable part only change the low 5 bits (like changing an alphabetical character into another), errors are restricted to the [low] [data] part, which is at most 89 characters, and thus all error detection properties (see appendix) remain applicable.\r\n\r\nThe lack of detection on the high bits seems like it can be remedied with a statement:\r\n\r\n> valid human readable parts must all differ from one another in the lower 5 bits for all error detection properties to remain applicable.\r\n\r\nFor example the hrp \"-3\" MUST NOT be registered because it collides with \"ms\" and likewise \"#,\" MUST NOT be registered as it collides with \"cl\"\r\n\r\nThen using a valid HRP list, error correcting decoders could always correct the HRP portion like any other character.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587315890",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587393796,
      "node_id": "IC_kwDOAN28mc7V00kE",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587393796",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T22:08:19Z",
      "updated_at": "2025-11-27T22:08:19Z",
      "author_association": "NONE",
      "body": "I'm this close to throwing in the towel.  BIP-93's design was never intended to be generalized to arbitrary HRP, and it shows.  If people want to reuse our polynomial for their own schemes, then more power to them.  They can make their own BIP.",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587393796",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587420487,
      "node_id": "IC_kwDOAN28mc7V07FH",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587420487",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T22:24:39Z",
      "updated_at": "2025-11-27T22:24:39Z",
      "author_association": "NONE",
      "body": "> I'm this close to throwing in the towel. BIP-93's design was never intended to be generalized to arbitrary HRP, and it shows. If people want to reuse our polynomial for their own schemes, then more power to them. They can make their own BIP.\r\n\r\nHigh bits of HRP characters were never intended to have detection guarantees. Restrict the HRP registry so they all differ in the lower bits. Now HRP can be checked and corrected (with the help of the valid HRP table) like bech32 data characters. Max length 94 for short checksum. short/long switch over is based on string length, no funny formula. Problem solved and looping debates averted.\r\n\r\nI'll rewrite the code and text if you agree with this decision.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587420487",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557120796",
      "pull_request_review_id": 3501457605,
      "id": 2557120796,
      "node_id": "PRRC_kwDOAN28mc6YapEc",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The lengths limitations of the codex32 strings are working under the assumption that the HRP is *not* subject to error correction.  We more or less cannot do that anyways as all sorts of various bech32 formats have appeared all with different checksums and characteristics.  In order to run the checksum algorithm you have to know the prefix first in order to know which checksum algorithm to try.\r\n\r\nThis isn't really a problem in practice since there are only a small finite number of prefixes, and from context only a few are going to be applicable anyways. ",
      "created_at": "2025-11-24T17:18:26Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557120796",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557120796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557141517",
      "pull_request_review_id": 3501457605,
      "id": 2557141517,
      "node_id": "PRRC_kwDOAN28mc6YauIN",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't really want this CRC stuff in the standard.  At most it is a recommendation that folks *MAY* use to select padding bits. but I doubt it will be useful in practice since you cannot know if any given codex32 master seed was generated with this CRC or with random padding as the codex32 book does. If one's seed is so corrupted that the codex32 error correction wasn't able to fix it, I'm skeptical a few more bits will help.\r\n\r\nIf it is include than padding *MAY* be random should also be stated.  Perhaps it is better to move this to a separate PR if we want to further discuss it.",
      "created_at": "2025-11-24T17:25:25Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557141517",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557141517"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557144592",
      "pull_request_review_id": 3501457605,
      "id": 2557144592,
      "node_id": "PRRC_kwDOAN28mc6Yau4Q",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 81,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If you want an hrp parameter, you have to rename this function to something like `codex32_verify_checksum`.",
      "created_at": "2025-11-24T17:26:36Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557144592",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557144592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557146292",
      "pull_request_review_id": 3501457605,
      "id": 2557146292,
      "node_id": "PRRC_kwDOAN28mc6YavS0",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This doesn't make sense.  The lowercase form and uppercase form of Bech32 characters have the same value.",
      "created_at": "2025-11-24T17:27:13Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557146292",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557146292"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557171793",
      "pull_request_review_id": 3501457605,
      "id": 2557171793,
      "node_id": "PRRC_kwDOAN28mc6Ya1hR",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd be included to remove this uncheckedsummed string.  I'm really nervous displaying strings without a checksum anywhere.  They are very problematic.\r\n\r\nIf you insist on going into this much detail in this test vector I'd say use the following bullets\r\n\r\n- Master seed (hex):\r\n- master node xprv\r\n- Payload\r\n- HRP\r\n- Identifier\r\n- Checksum\r\n- Secret seed\r\n\r\nThat's the order I'd use, but maybe some other permutations are also good.",
      "created_at": "2025-11-24T17:36:47Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557171793",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557171793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557214387",
      "pull_request_review_id": 3501578813,
      "id": 2557214387,
      "node_id": "PRRC_kwDOAN28mc6Ya_6z",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 272,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "When some shares of a master seed are compromised, a user may wish to simply dispose of remaining shares and rederive a new set of secret shares without the cost of sweeping their wallet.  In such a case a user very much should use a fresh identifier so that they do not get mix up their obsolete share data with their fresh shares.\r\n\r\nAt best a hardware wallet may suggest such an identifier, but only when the hardware wallet is generating a fresh master seed and thus knows that there are no other secret shares for the same secret floating around.\r\n\r\nAgain, maybe put this recommendation into a separate PR, perhaps including more details and test vectors.",
      "created_at": "2025-11-24T17:53:09Z",
      "updated_at": "2025-11-24T17:53:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557214387",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557214387"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 334,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558171315",
      "pull_request_review_id": 3502800360,
      "id": 2558171315,
      "node_id": "PRRC_kwDOAN28mc6Yepiz",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This was copied over from BIP-00173. Delete it?\r\n\r\nBech32 attempts to decode two checksums, a universal bech32 decoder could try decoding the string with the bech32, bech32m and codex32 checksums to discover the format.\r\nUnless covering the HRP exceeds the max length at HD=9, 2 subsitutions in the HRP will always be detected by every format.\r\n\r\nIf HRP is swapped between formats the chances of false verification is:\r\n\r\n- 1 in 2^65  for a \"codex32 checksum\" validating when the encoding was Bech32/Bech32m \r\n\r\n- ~1 in 2^30 for  \"Bech32 checksum\" validating when the encoding was Codex32.",
      "created_at": "2025-11-25T01:03:01Z",
      "updated_at": "2025-11-25T01:03:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558171315",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558171315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558482066",
      "pull_request_review_id": 3503186164,
      "id": 2558482066,
      "node_id": "PRRC_kwDOAN28mc6Yf1aS",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'll replace it with one sentence for now:\r\n\r\n> Encoders MAY select padding using a CRC-`w` where: `w = pad_bits_needed`, `poly = 1 << w | 3`, `init = 1`, `const = 1 << w - 1`, `refIn = false`, and `refOut = false`.\r\n\r\nCRC-4 helps 32-byte seeds detect 94% of 1 character errors/deletions and narrows 1 erasure down to 2 candidates. The most common substitutions in CHARSET are 1 bit apart so actual performance will exceed that.\r\n\r\n> since you cannot know if any given codex32 master seed was generated with this CRC or with random padding\r\n\r\nFinding the book is reasonable suspicion for random padding IF all electronically encoded seeds use CRC. The person who made the backup certainly knows if they encoded with the book or not.\r\n\r\n>  as the codex32 book does\r\n\r\nA book insert could compute CRCs by hand, but I have not divided a large enough number to benchmark time for 128-bits, Andrew and I determined the space requirement is two pieces of 11 x 8.5 graph paper.\r\n\r\n> If it is include than padding MAY be random should also be stated.\r\n\r\nDecoders, MUST accept random padding, although they may someday warn on it.\r\n\r\nFor electronic encoders, trusting RNGs introduces risk: it can leak up to 32 bits to an attacker with 8 shares and breaks decode->encode round-trip. Using zero padding round-trips but leaks the final payload character to an attacker with `(5-pad_len) / pad_len` interpolated shares.\r\n\r\nCRC pad minimizes RNG trust by using entropy already present in the payload bytes.\r\n\r\n>  Perhaps it is better to move this to a separate PR if we want to further discuss it.\r\n\r\nLets discuss on my deterministic [codex32 BIP85 PR](https://github.com/BenWestgate/bips/blob/a8f8e98d05a2183aba395f8f8ff479b4fb764f95/bip-0085.mediawiki?plain=1#L306) where it's required since reviewers asked me to directly encode bytes not u5 ints even for share payloads.",
      "created_at": "2025-11-25T04:08:33Z",
      "updated_at": "2025-11-25T04:08:33Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558482066",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558482066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558488530",
      "pull_request_review_id": 3503194126,
      "id": 2558488530,
      "node_id": "PRRC_kwDOAN28mc6Yf2_S",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not for HRP which needs to be lower cased during decoding or `bech32_hrp_expand(hrp)` would return a different result.\r\n\r\nThis line is repeated from the test vectors, why explain the rules about case in the vectors instead of up here?",
      "created_at": "2025-11-25T04:13:55Z",
      "updated_at": "2025-11-25T04:13:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558488530",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558488530"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558507125",
      "pull_request_review_id": 3503218818,
      "id": 2558507125,
      "node_id": "PRRC_kwDOAN28mc6Yf7h1",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "How about since the text said:\n\n> This example shows generating a new 512-bit master seed using \"random\" codex32 characters and appending a checksum.\n\nhuman-readable part: <code>MS</code>\nk value: <code>0</code>\nidentifier: <code>0C8V</code>\nshare index: <code>S</code>\npayload: <code>M32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>\n\n* checksum: <code>HPV80UNDVARHRAK</code>\n* secret seed: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n* Master seed (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n* master node xprv: <code>xprv9s21ZrQH143K4UYT4rP3TZVKKbmRVmfRqTx9mG2xCy2JYipZbkLV8rwvBXsUbEv9KQiUD7oED1Wyi9evZzUn2rqK9skRgPkNaAzyw3YrpJN</code>\n\n\nNo information is displayed we did not already in Vector 1.",
      "created_at": "2025-11-25T04:27:43Z",
      "updated_at": "2025-11-25T04:27:43Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558507125",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558507125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558509494",
      "pull_request_review_id": 3503223709,
      "id": 2558509494,
      "node_id": "PRRC_kwDOAN28mc6Yf8G2",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 81,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557144592,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Will do",
      "created_at": "2025-11-25T04:29:20Z",
      "updated_at": "2025-11-25T04:29:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558509494",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558509494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558680888",
      "pull_request_review_id": 3503422421,
      "id": 2558680888,
      "node_id": "PRRC_kwDOAN28mc6Ygl84",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 272,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557214387,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is a good case for BIP85 derive codex32 application to avoid trusting or generating randomness for this.\n\nIf we want a default identifier for \"reshares\" too:\n\n```python\nidentifier = fingerprint(master_seed)[:2] + fingerprint(false_seed)[2:4]\n```\nWhere `false_seed` is recovered from _fresh_ initial shares (reducing `k` if needed).\n\nDuring the first generation with k fresh shares; the two slices together produce the full fingerprint. If the identifier is unspecified, recommend this default for master seeds. Or if that collides, the next higher.\n\n> Again, maybe put this recommendation into a separate PR, perhaps including more details and test vectors.\n\nAlready done here. Agreed wrt details and vectors.\n\nhttps://github.com/BenWestgate/bips/blob/a8f8e98d05a2183aba395f8f8ff479b4fb764f95/bip-0085.mediawiki#unshared-secret\n\nhttps://github.com/bitcoin/bips/pull/1958\n\nI can move this recommendation (and the padding rec) into a separate BIP93 PR pending the final BIP85 codex32 design (needs finishing touches feedback). Ill remove it from this PR so it remains focused on typos and general HRP support.",
      "created_at": "2025-11-25T06:19:02Z",
      "updated_at": "2025-11-25T06:19:02Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558680888",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558680888"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 334,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560673322",
      "pull_request_review_id": 3505931854,
      "id": 2560673322,
      "node_id": "PRRC_kwDOAN28mc6YoMYq",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This text was certainly the design goal of BIP-173, but we are not using their checksum, and we haven't realized this part of their design in codex32 in part because our 13 character checksum unfortunately works only on relatively short strings.\r\n\r\nInstead we process this HRP in this way because that is what BIP-173 does, and we still want the HRP to change the residue to catch random errors, so me might as well do it in the standard way.\r\n\r\n> Unless covering the HRP exceeds the max length at HD=9, 2 subsitutions in the HRP will always be detected by every format.\r\n\r\nThe problem is that our particular 13 character checksum's max length for its error detection and correction properties is limited to 93 bech32 characters.  That's why our payload is limited to 74 characters add in 13 character checksum and 6 characters for the header and we get 93 bech32 characters, with nothing left over to detect or correct errors in the HRP.  Yes, in cases where the payload is 72 characters or less, our error correction / detection properties extend to the low 5 bits of the ascii characters of a 2 character prefix, but that doesn't apply to 73 or 74 character payloads.\r\n\r\nI don't know if we really want to get into these subtleties.  I'm not even sure correcting and detecting errors in the HRP is useful to begin.  If you are a hardware wallet expecting a master seed and someone gives you a \"cl\" codex32 string, you don't need a fancy error correction algorithm to detect the \"cl\" prefix is wrong; if it is a expecting a master seed then the \"cl\" prefix must be wrong.",
      "created_at": "2025-11-25T16:35:00Z",
      "updated_at": "2025-11-25T16:35:00Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560673322",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560673322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560684327",
      "pull_request_review_id": 3505944357,
      "id": 2560684327,
      "node_id": "PRRC_kwDOAN28mc6YoPEn",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I guess we should reword this to make it more clear that the relevance is for the HRP.",
      "created_at": "2025-11-25T16:38:15Z",
      "updated_at": "2025-11-25T16:38:15Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560684327",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560684327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560692274",
      "pull_request_review_id": 3505953733,
      "id": 2560692274,
      "node_id": "PRRC_kwDOAN28mc6YoRAy",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That would be better.",
      "created_at": "2025-11-25T16:40:45Z",
      "updated_at": "2025-11-25T16:40:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560692274",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560692274"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560697846",
      "pull_request_review_id": 3505961549,
      "id": 2560697846,
      "node_id": "PRRC_kwDOAN28mc6YoSX2",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd still rather this be in a separate PR and in a separate section on recommendations for determinisitic generation. ",
      "created_at": "2025-11-25T16:42:28Z",
      "updated_at": "2025-11-25T16:42:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560697846",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560697846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560739047",
      "pull_request_review_id": 3506008594,
      "id": 2560739047,
      "node_id": "PRRC_kwDOAN28mc6Yocbn",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should it be a PR to this BIP93 document or to [BlockstreamResearch/codex32 wallets.md](https://github.com/BlockstreamResearch/codex32/blob/master/docs/wallets.md.)?",
      "created_at": "2025-11-25T16:53:18Z",
      "updated_at": "2025-11-25T16:53:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560739047",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560739047"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560819822",
      "pull_request_review_id": 3506101757,
      "id": 2560819822,
      "node_id": "PRRC_kwDOAN28mc6YowJu",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I will delete the footmark and say:\r\n\"The human-readable part is processed as per BIP-0173.\"\r\n\r\nI updated the rationale accordingly:\r\n\r\nAt this length, the human-readable part is not covered by the checksum. This is acceptable because the checksum scheme itself requires you to know that a valid human-readable part is being used in the first place. If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected prefix. \r\n\r\n\r\n>  I'm not even sure correcting and detecting errors in the HRP is useful to begin\r\n\r\nwallets.md import guidance prefills the prefix in applications expecting only one to prevent mistakes.\r\n\r\nA future application for extended keys (Is long codex32 HD=9 for 74 bytes?) has a situation where decoders need to accept both \"xprv\" and \"xpub\" HRPs in the same descriptor. So here it is absolutely useful to detect and correct errors in the HRP.\r\n\r\nHowever we should not go into details about that until such an application needing to disambiguate different HRP actually exists.",
      "created_at": "2025-11-25T17:18:48Z",
      "updated_at": "2025-11-25T17:50:05Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560819822",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560819822"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560933020",
      "pull_request_review_id": 3506238948,
      "id": 2560933020,
      "node_id": "PRRC_kwDOAN28mc6YpLyc",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What does HD=9 mean?",
      "created_at": "2025-11-25T17:59:05Z",
      "updated_at": "2025-11-25T17:59:06Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560933020",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560933020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560949487",
      "pull_request_review_id": 3506260389,
      "id": 2560949487,
      "node_id": "PRRC_kwDOAN28mc6YpPzv",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hamming distance 9, able to detect 8 substitution errors. (and correct 4)",
      "created_at": "2025-11-25T18:05:55Z",
      "updated_at": "2025-11-25T18:05:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560949487",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560949487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560995482",
      "pull_request_review_id": 3506316041,
      "id": 2560995482,
      "node_id": "PRRC_kwDOAN28mc6YpbCa",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@roconnor why do we have spec notes in the test vectors?\n\nThis was what I was trying to make unnecessary with the earlier sentence about case and checksum.",
      "created_at": "2025-11-25T18:24:47Z",
      "updated_at": "2025-11-25T18:24:47Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560995482",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560995482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561016116",
      "pull_request_review_id": 3506340908,
      "id": 2561016116,
      "node_id": "PRRC_kwDOAN28mc6YpgE0",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah the 15 character checksum has HD=9 up to a maximum length 1023, supports data up to 1008 = (1023 - 15) characters  and a payload of 1002 (=1008 - 6 header characters) bech32 characters.  If you want to cover the HRP you lose payload capacity.",
      "created_at": "2025-11-25T18:32:25Z",
      "updated_at": "2025-11-25T18:32:25Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561016116",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561016116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561023486",
      "pull_request_review_id": 3506351186,
      "id": 2561023486,
      "node_id": "PRRC_kwDOAN28mc6Yph3-",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe hammering out the details at codex32_wallets.md makes the most sense.  Then we can decide if we want to include it in BIP-93, or maybe just make a reference to the codex32_wallets.md.",
      "created_at": "2025-11-25T18:35:01Z",
      "updated_at": "2025-11-25T18:35:02Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561023486",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561023486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561044105",
      "pull_request_review_id": 3506378123,
      "id": 2561044105,
      "node_id": "PRRC_kwDOAN28mc6Ypm6J",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.\n In particular, given an all uppercase codex32 string, we still use lowercase <code>ms</code> as the human-readable part during checksum construction.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 339,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If I add this to spec:\n\"When constructing or verifying a checksum, the human-readable part MUST be interpreted in lowercase, as specified in BIP-0173.\"\n\nThen we can remove this.",
      "created_at": "2025-11-25T18:42:56Z",
      "updated_at": "2025-11-25T18:42:56Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561044105",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561044105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 484,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 485,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561048264",
      "pull_request_review_id": 3506383476,
      "id": 2561048264,
      "node_id": "PRRC_kwDOAN28mc6Ypn7I",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2560995482,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't know. Before we were using a fixed constant for the \"ms\" prefix, so this text wasn't really necessary.  Now that we want to support more general HRPs, I agree that we need some wording like this somewhere.",
      "created_at": "2025-11-25T18:44:27Z",
      "updated_at": "2025-11-25T18:44:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561048264",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561048264"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561073066",
      "pull_request_review_id": 3506415756,
      "id": 2561073066,
      "node_id": "PRRC_kwDOAN28mc6Ypt-q",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Plenty of room to long codex32 encode extended keys with covered human-readable parts \"xpub\", \"xprv\", \"tprv\" and \"tpub\" someday.  They're horrible to handle and type in base58. Is this something we should think about in a separate PR?",
      "created_at": "2025-11-25T18:54:08Z",
      "updated_at": "2025-11-25T18:54:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561073066",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561073066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561347116",
      "pull_request_review_id": 3506741192,
      "id": 2561347116,
      "node_id": "PRRC_kwDOAN28mc6Yqw4s",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"When constructing or verifying a checksum, the human-readable part MUST be interpreted in lowercase, as specified in BIP-0173.\"",
      "created_at": "2025-11-25T20:41:53Z",
      "updated_at": "2025-11-25T20:41:53Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561347116",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561347116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561357060",
      "pull_request_review_id": 3506752779,
      "id": 2561357060,
      "node_id": "PRRC_kwDOAN28mc6YqzUE",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would you rather just change V5 text to match master's vectors?\n\nFrom:\n> This example shows generating a new 512-bit master seed using \"random\" codex32 characters and appending a checksum.\n\nTo:\n\nThis example shows the long codex32 format, when used without splitting the secret into any shares.",
      "created_at": "2025-11-25T20:46:08Z",
      "updated_at": "2025-11-25T20:46:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561357060",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561357060"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561364297",
      "pull_request_review_id": 3506761147,
      "id": 2561364297,
      "node_id": "PRRC_kwDOAN28mc6Yq1FJ",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2560995482,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I removed it and added wording like this to the end of the codex32 Spec section.",
      "created_at": "2025-11-25T20:49:19Z",
      "updated_at": "2025-11-25T20:49:19Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561364297",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561364297"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561458275",
      "pull_request_review_id": 3506868275,
      "id": 2561458275,
      "node_id": "PRRC_kwDOAN28mc6YrMBj",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I somewhat prefer the current text.",
      "created_at": "2025-11-25T21:21:01Z",
      "updated_at": "2025-11-25T21:21:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561458275",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561458275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561647175",
      "pull_request_review_id": 3507072048,
      "id": 2561647175,
      "node_id": "PRRC_kwDOAN28mc6Yr6JH",
      "diff_hunk": "@@ -59,67 +58,84 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 22,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should it be:\r\n\r\n> and then define **a** BIP-0032 master seed encoding using it.\r\n\r\n?\r\nBecause this is only one encoding of master seeds, SLIP-39 and WIF are others, we should use \"a\" not \"the\".",
      "created_at": "2025-11-25T22:10:40Z",
      "updated_at": "2025-11-25T22:43:52Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561647175",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561647175"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561667081",
      "pull_request_review_id": 3507092272,
      "id": 2561667081,
      "node_id": "PRRC_kwDOAN28mc6Yr_AJ",
      "diff_hunk": "@@ -59,67 +58,84 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 32,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Do we need to be this wordy or should we say:\n\n* A human-readable part, as specified in BIP-0173, which is intended to convey the type of data, or anything else that is relevant to the reader.\n* A separator, as specified in BIP-0173, which is always \"1\".",
      "created_at": "2025-11-25T22:16:07Z",
      "updated_at": "2025-11-25T22:16:07Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561667081",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561667081"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 69,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 70,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561681885",
      "pull_request_review_id": 3507106951,
      "id": 2561681885,
      "node_id": "PRRC_kwDOAN28mc6YsCnd",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 190,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "remove the periods I inadvertently added to these bullets?",
      "created_at": "2025-11-25T22:19:55Z",
      "updated_at": "2025-11-25T22:19:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561681885",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561681885"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 224,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561701104",
      "pull_request_review_id": 3507128287,
      "id": 2561701104,
      "node_id": "PRRC_kwDOAN28mc6YsHTw",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should we say \"secret or set of shares\" because this is the reshare case you mentioned that SHOULD have a unique identifier?\nHere we make it sound like it's OK to reuse an identifier if the secret is the same which is false.",
      "created_at": "2025-11-25T22:25:46Z",
      "updated_at": "2025-11-25T22:25:46Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561701104",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561701104"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561715542",
      "pull_request_review_id": 3507145870,
      "id": 2561715542,
      "node_id": "PRRC_kwDOAN28mc6YsK1W",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret, padded with arbitrary bits",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 247,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Change this to \"secret data\" or \"secret bytes\" to specify its encoding bytes or leave it?  There may be some confusion between \"secret\" meaning the string with share index \"s\" and the decoded payload bytes of that [codex32] secret.",
      "created_at": "2025-11-25T22:30:23Z",
      "updated_at": "2025-11-25T22:30:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561715542",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561715542"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561778890",
      "pull_request_review_id": 3507218968,
      "id": 2561778890,
      "node_id": "PRRC_kwDOAN28mc6YsaTK",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561701104,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, set of shares.",
      "created_at": "2025-11-25T22:47:28Z",
      "updated_at": "2025-11-25T22:47:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561778890",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561778890"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561791403",
      "pull_request_review_id": 3507231446,
      "id": 2561791403,
      "node_id": "PRRC_kwDOAN28mc6YsdWr",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret, padded with arbitrary bits",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 247,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561715542,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"secret data\" sounds good.",
      "created_at": "2025-11-25T22:50:36Z",
      "updated_at": "2025-11-25T22:50:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561791403",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561791403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887002",
      "pull_request_review_id": 3507326378,
      "id": 2561887002,
      "node_id": "PRRC_kwDOAN28mc6Ys0sa",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I might say \"MUST be converted to lowercase\" instead.",
      "created_at": "2025-11-25T23:19:16Z",
      "updated_at": "2025-11-25T23:19:17Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561887002",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887002"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2563141674",
      "pull_request_review_id": 3508740520,
      "id": 2563141674,
      "node_id": "PRRC_kwDOAN28mc6YxnAq",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That seems to imply mutating the string when verifying a checksum.\r\n\r\nSomething BIP-93 omitted was that encoders should always emit lower-case strings.  Did we relax that requirement?\r\n\r\nCurrently I have the sentence as: \r\n\"Encoders MUST emit lowercase; decoders MUST reject mixed-case and MUST lowercase the human-readable part during checksum verification.\"\r\n\r\nAnd I am adding a section with a `codex32_encode` and `codex32_decode` definitions as I think it's easier to see these rules in code than english.\r\n\r\n> **Uppercase/lowercase**\r\n> \r\n> The lowercase form is used when determining a character's value for checksum purposes.\r\n> \r\n> Encoders MUST always output an all lowercase Bech32 string. If an uppercase version of the encoding result is desired, (e.g.- for presentation purposes, or QR code use), then an uppercasing procedure can be performed external to the encoding process.\r\n> \r\n> Decoders MUST NOT accept strings where some characters are uppercase and some are lowercase (such strings are referred to as mixed case strings).\r\n> \r\n> For presentation, lowercase is usually preferable, but inside QR codes uppercase SHOULD be used, as those permit the use of [alphanumeric mode](http://www.thonky.com/qr-code-tutorial/alphanumeric-mode-encoding), which is 45% more compact than the normal [byte mode](http://www.thonky.com/qr-code-tutorial/byte-mode-encoding).",
      "created_at": "2025-11-26T05:06:05Z",
      "updated_at": "2025-11-26T05:06:05Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2563141674",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2563141674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2564267959",
      "pull_request_review_id": 3510057488,
      "id": 2564267959,
      "node_id": "PRRC_kwDOAN28mc6Y15-3",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I ran the numbers here and we must further restrict HRP lengths to 72 or 74 (same maximum as the payload).  At `len(hrp) = 74` two header characters two header characters aren't checked but what does a threshold or share index even mean for a 0 byte payload?\r\n\r\nI also explicitly stated the maximum length for a codex32 string is 96.  Although perhaps at length = 96 the HRP we assume \"ms\" while the max length for all other prefixes is 94?",
      "created_at": "2025-11-26T09:42:57Z",
      "updated_at": "2025-11-26T09:42:57Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2564267959",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2564267959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565548036",
      "pull_request_review_id": 3511630610,
      "id": 2565548036,
      "node_id": "PRRC_kwDOAN28mc6Y6ygE",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "As far as I'm concerned both all lowercase and all uppercase strings are valid, so encoders can produce either format with lowercase is generally preferred.  I'm not really sure what BIP-173 thinks it is achieving by talking about encoders being somewhat different from a post-processing step.  Maybe they are just trying to say that when creating a checksum, of course, a lowercase HRP must be used. \r\n\r\n> That seems to imply mutating the string when verifying a checksum.\r\n\r\nThis is exactly what the BIP-173 reference python decoder does:\r\n\r\nhttps://github.com/sipa/bech32/blob/master/ref/python/segwit_addr.py#L78\r\n\r\nHowever, \"The lowercase form is used \" is also fine wording though.",
      "created_at": "2025-11-26T15:52:25Z",
      "updated_at": "2025-11-26T15:52:25Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2565548036",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565548036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565654406",
      "pull_request_review_id": 3511757121,
      "id": 2565654406,
      "node_id": "PRRC_kwDOAN28mc6Y7MeG",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Since we are excluding the HRP from the error-correction and detection routine, the HRP can be as long as folks want.  The HRP just adds a \"random\" factor to the checksum as a function of the HRP text and the number of characters in the data.  And by \"random\" I really mean deterministic.\r\n\r\nThe way the error correction algorithm works is that it finds locations of errors starting from the end of the string (i.e. the end of the checksum) going back as far as but no further than 93 characters.  So when the hrp-expanded segement + the data segment is longer than 93 characters, the algorithm simply fails to locate errors at any location beyond the last 93 characters.\r\n\r\nWhen the hrp-expanded segement + the data segment is longer than 93 characters the hamming distance property still holds on the last 93 characters.  That is if you only change the last 93 characters you must change at least 9 characters in order to get another valid string.",
      "created_at": "2025-11-26T16:24:09Z",
      "updated_at": "2025-11-26T16:24:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2565654406",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565654406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566180182",
      "pull_request_review_id": 3512376855,
      "id": 2566180182,
      "node_id": "PRRC_kwDOAN28mc6Y9M1W",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The HRP _is_ included in the error detection routine.  That's why I've restricted the length to 94 characters if hrp != \"ms\".  In the 96 length case we assume it's \"ms\"\r\n\r\nWould you like to not have any length restriction and not promise to detect errors in the HRP?\r\n\r\nThat sounds strictly worse, since we don't have to support any length of HRP, we can restrict it to ones that do get covered by the 13 character checksum, and that is better if a lot of them proliferate and some future application needs to disambiguate two short checksums.",
      "created_at": "2025-11-26T19:03:54Z",
      "updated_at": "2025-11-26T19:03:54Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566180182",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566180182"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566195378",
      "pull_request_review_id": 3512395392,
      "id": 2566195378,
      "node_id": "PRRC_kwDOAN28mc6Y9Qiy",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"Decoders MUST use the lowercase form of the human-readable part during checksum verification.\"",
      "created_at": "2025-11-26T19:08:17Z",
      "updated_at": "2025-11-26T19:08:17Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566195378",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566195378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566235386",
      "pull_request_review_id": 3512447446,
      "id": 2566235386,
      "node_id": "PRRC_kwDOAN28mc6Y9aT6",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I reverted it\r\n\r\nWe start given\r\n\r\nk value = 0\r\nidentifier = 0C8V\r\npayload = \r\n\r\nthen compute\r\n\r\n* checksum\r\n* secret seed\r\n* Master seed\r\n* master node xprv\r\n\r\nWe are able to infer share index = \"s\" and hrp = \"MS\" from the text.\r\n\r\nFWIW I have been using the term \"secret seed\" when a codex32 secret is arrived at from bech characters (interpolation or randomly selected) and I have been using the term codex32-encoded master seed when it's produced from bytes.\r\n\r\nThis is slightly more precise but we need not bother readers with the distinction since both are valid.",
      "created_at": "2025-11-26T19:19:43Z",
      "updated_at": "2025-11-26T19:20:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566235386",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566235386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566256723",
      "pull_request_review_id": 3512473683,
      "id": 2566256723,
      "node_id": "PRRC_kwDOAN28mc6Y9fhT",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561701104,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I used \"set of shares\" in for an existing secret and \"secret\" in for a fresh secret.\r\n\r\nThis is technically correct, no need to say both \"secret and set of shares\" in existing secret, if you follow that process you always get a fresh set of shares and that is what needs to be uniquely identified not the secret per se.",
      "created_at": "2025-11-26T19:26:01Z",
      "updated_at": "2025-11-26T19:26:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566256723",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566256723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566309266",
      "pull_request_review_id": 3512534912,
      "id": 2566309266,
      "node_id": "PRRC_kwDOAN28mc6Y9sWS",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.",
      "path": "bip-0093.mediawiki",
      "position": 396,
      "original_position": 396,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The original forgot to subtract the 6 character header from the secret payload bits.\n\nI used 368 instead of 370 because 2 of them are padding and not secret data.\n\nIs this another one of those places we should say \"secret data\" to avoid ambiguity between the \"s\" string and bytes?",
      "created_at": "2025-11-26T19:44:13Z",
      "updated_at": "2025-11-26T19:44:13Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566309266",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566309266"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 401,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566318834",
      "pull_request_review_id": 3512545868,
      "id": 2566318834,
      "node_id": "PRRC_kwDOAN28mc6Y9ury",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.",
      "path": "bip-0093.mediawiki",
      "position": 397,
      "original_position": 397,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is implicit from the spec definition:\n\n> Strings of length 95 and 96 MUST use HRP \"ms\" (or \"MS\")\n\nIf it needs to be explained here also.  Or a sentence why the maximum length is 94 for other HRP, let me know and I'll try.\n\nWe could reduce maximum length to 94 characters and remove the special HRP vs length rule, but that breaks existing \"46-byte codex32-encoded master seeds\" and these are absolutely critical to support given the wide-spread deployment of both codex32 and 46-byte master seeds.",
      "created_at": "2025-11-26T19:48:48Z",
      "updated_at": "2025-11-26T19:48:48Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566318834",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566318834"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 402,
      "original_line": 402,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566323323",
      "pull_request_review_id": 3512550880,
      "id": 2566323323,
      "node_id": "PRRC_kwDOAN28mc6Y9vx7",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "At this point we should link to the registry somewhere in our document so people know what a \"codex32 human-readable part\" might be:\n\nWhere's the best place to put this hyperlink?\nhttps://github.com/satoshilabs/slips/blob/master/slip-0173.md#uses-of-codex32",
      "created_at": "2025-11-26T19:50:44Z",
      "updated_at": "2025-11-26T19:50:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566323323",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566323323"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 403,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566480703",
      "pull_request_review_id": 3512740920,
      "id": 2566480703,
      "node_id": "PRRC_kwDOAN28mc6Y-WM_",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Would you like to not have any length restriction and not promise to detect errors in the HRP?\r\n\r\nThat's what I was thinking.  There would just be a 93 data character limit and no correction of the HRP.  This is how the limits of BIP-93 was designed.\r\n\r\n> That sounds strictly worse\r\n\r\nI'm struggling to see how error correction is useful for the HRP.  You need to already know the HRP in order to know select the codex32 error correction algorithm to begin with.  CL wallets only take codex32 strings with the \"cl\" prefix.  Hardware wallets only take codex32 strings beginning with \"ms\".  If you cannot read the prefix you won't even know if it is a bip-173 address or a codex32 string or someone else's algorithm.  If you find a piece of paper laying around with \"xd10lueasd35kw6r5de5kueedxyesqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqanvrktzhlhus\" what are you expecting folks to do with it?  Is it a bitcoin address, is it a private key, is it some other coin's something?\r\n\r\nThere is a simple error correction algorithm: just try replacing the prefix all the prefixes that you care about.",
      "created_at": "2025-11-26T20:59:50Z",
      "updated_at": "2025-11-26T20:59:51Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566480703",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566480703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566489916",
      "pull_request_review_id": 3512751367,
      "id": 2566489916,
      "node_id": "PRRC_kwDOAN28mc6Y-Yc8",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.",
      "path": "bip-0093.mediawiki",
      "position": 396,
      "original_position": 396,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566309266,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it is fine as is, since the \"368-bit\" makes it clear it is data, but if you want to change the wording, that would also be fine.",
      "created_at": "2025-11-26T21:05:00Z",
      "updated_at": "2025-11-26T21:05:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566489916",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566489916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 401,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566492577",
      "pull_request_review_id": 3512754151,
      "id": 2566492577,
      "node_id": "PRRC_kwDOAN28mc6Y-ZGh",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't really want to be seen as endorsing a particular registry.  But I also see how a link could be useful, so I'm torn.",
      "created_at": "2025-11-26T21:06:26Z",
      "updated_at": "2025-11-26T21:06:26Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566492577",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566492577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 403,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566496494",
      "pull_request_review_id": 3512758500,
      "id": 2566496494,
      "node_id": "PRRC_kwDOAN28mc6Y-aDu",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe best to leave the registry out since they may or may not be Bitcoin related.",
      "created_at": "2025-11-26T21:08:38Z",
      "updated_at": "2025-11-26T21:08:38Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566496494",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566496494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 403,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566508035",
      "pull_request_review_id": 3512771739,
      "id": 2566508035,
      "node_id": "PRRC_kwDOAN28mc6Y-c4D",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Let's use a descriptor for an example. Say these prefixes get registered \"xpub\", \"xprv\", \"privkey\" or whatever.\n\nNow we have an import field that should be able to correct hrp errors.\n\nIn case we typed or wrote \"xpub\" for \"xprv\" or vice versa.\n\nIt would be best to have error detection guarantees (and corrections) for the HRP instead of the 1/(2^65) sort. And to get that, the checksum needs to be covered.\n\nIn this case the app can try \"xpub\", \"xprv\" or \"privkey\" and detect or repair transcription errors in these strings.",
      "created_at": "2025-11-26T21:15:30Z",
      "updated_at": "2025-11-26T21:16:32Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566508035",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566508035"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566578378",
      "pull_request_review_id": 3512848332,
      "id": 2566578378,
      "node_id": "PRRC_kwDOAN28mc6Y-uDK",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why don't we keep it as is: a maximum length of 96 and then say that HRP's may further restrict length. For example how \"ms\" restricts to 16-64 bytes or \"cl\" 32.\n\nBecause the two current applications do not need to disambiguate HRP's, but future ones may need to, in which case they should shorten the max length to 94 to cover HRP.",
      "created_at": "2025-11-26T21:53:54Z",
      "updated_at": "2025-11-26T21:53:54Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566578378",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566578378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566587957",
      "pull_request_review_id": 3512863332,
      "id": 2566587957,
      "node_id": "PRRC_kwDOAN28mc6Y-wY1",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki#user-content-Registered_Humanreadable_Prefixes\n\nBIP-0173 which is a prerequisite for implementing this format links to that registry.\n\nWe don't have to link to it as they can find it in BIP-0173 but it the concept of registering codex32 HRP should be mentioned to avoid chaos and disaster of using anything for everything.",
      "created_at": "2025-11-26T21:59:38Z",
      "updated_at": "2025-11-26T21:59:38Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566587957",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566587957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 403,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566609752",
      "pull_request_review_id": 3512901990,
      "id": 2566609752,
      "node_id": "PRRC_kwDOAN28mc6Y-1tY",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Let's use a descriptor for an example. Say these prefixes get registered \"xpub\", \"xprv\", \"privkey\" or whatever.\r\n> \r\n> Now we have an import field that should be able to correct hrp errors.\r\n> \r\n> In case we typed or wrote \"xpub\" for \"xprv\" or vice versa.\r\n\r\nI agree that for applications that can accept more than one different HRPs in the same context, it makes sense to make sure error detection can cover them and those applications will need their own BIPs to cover their own length restrictions.  My point is that no one is mixing up master seeds with addresses.\r\n\r\n> It would be best to have error detection guarantees (and corrections) for the HRP instead of the 1/(2^65) sort. And to get that, the checksum needs to be covered.\r\n\r\nThe situation is actually much worse than the 1/(2^65) sort.\r\n\r\n> ms1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtray0m\r\n\r\nhas two corrections, either\r\n\r\n> ms1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtraypy\r\n\r\nor \r\n\r\n> cl1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtray0m\r\n\r\n(Edit: yes 'a' is an invalid threshold, but you know what I mean.  The point is that for the 93 character data part, mistaking the ms prefix for a cl prefix is the same as making a two character error in the checksum.)\r\n\r\nThe math is that x^93 == 1 modulo our (short) codex32 generator, which means errors at location *n* are indistinguishable from errors at location *n*+93.\r\n\r\nUgh, I'm starting to think you are right.  The total length of strings must be 94 characters or less, with an exception that an ms string can be 96 characters.  Even a length restriction of 94 characters isn't going to be enough unless we also restrict the HRP to use only letters and disallow numbers (we could also accept underscores and perhaps a very small handful of carefully selected special ASCII characters).\r\n\r\nAnd maybe (in a separate PR) we should outlaw unusual sized master seed strings too to get rid of even that \"ms\" exception if we can agree on a definition of unusual sized.",
      "created_at": "2025-11-26T22:12:35Z",
      "updated_at": "2025-11-26T22:15:43Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566609752",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566609752"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566632749",
      "pull_request_review_id": 3512937493,
      "id": 2566632749,
      "node_id": "PRRC_kwDOAN28mc6Y-7Ut",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Speaking of those multi-hrp applications, my reviewer on the bip85 codex app is working on one such application (BIP32 encodings) https://github.com/bitcoin/bips/pull/1958#issuecomment-3581306205",
      "created_at": "2025-11-26T22:25:29Z",
      "updated_at": "2025-11-26T22:25:29Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566632749",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566632749"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566679510",
      "pull_request_review_id": 3512987924,
      "id": 2566679510,
      "node_id": "PRRC_kwDOAN28mc6Y_GvW",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh.  Well if there is precedent then I guess it is okay.",
      "created_at": "2025-11-26T22:57:53Z",
      "updated_at": "2025-11-26T22:57:54Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566679510",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566679510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 403,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566695226",
      "pull_request_review_id": 3513005609,
      "id": 2566695226,
      "node_id": "PRRC_kwDOAN28mc6Y_Kk6",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Okay we have a choice of making a complicated rule like \"the string length plus the length of the hrp (i.e double counting the hrp) must be less than or equal to 93\" or we can have simple rule like \"the length of the string must be less than or equal to 94\" but also restricting the hrp character set to at most 32 values where the lower 5 bits of the ASCII character are all distinct.\r\n\r\nGiven how length constrained our 13 character checksum is, I think we should restrict the HRP character set.  I'd go for \"a-z\" and special characters `@_[|]~`, but the choice of special characters is debatable (but our options are limited).  However, we will have to pick some.\r\n\r\nWe have a choice between @ and `, of which I think @ is preferable\r\n\r\nWe have a choice between ? and _ , of which I think _ is preferable.  In particular I don't think we want ? as a legal HRP character.\r\n\r\nWe have a choice between ;, [, and {.  We have a choice between <, \\, and |.  We have a choice between =, ] and }.  We have a choice between >, ^, and ~.  I don't have very strong preferences within these options.\r\n",
      "created_at": "2025-11-26T23:10:43Z",
      "updated_at": "2025-11-26T23:10:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566695226",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566695226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566724945",
      "pull_request_review_id": 3513035294,
      "id": 2566724945,
      "node_id": "PRRC_kwDOAN28mc6Y_R1R",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Actually I'm not sure even this restriction is enough.  We might need to require hrps only consist of ascii characters between 96 and 126 (or their upper case variants) so that all their upper bits are always `011` in order to be safe. ",
      "created_at": "2025-11-26T23:35:59Z",
      "updated_at": "2025-11-26T23:36:50Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566724945",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566724945"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566728839",
      "pull_request_review_id": 3513039442,
      "id": 2566728839,
      "node_id": "PRRC_kwDOAN28mc6Y_SyH",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Pinging @scgbckbone who may have some feedback from working on a BIP32 codex32 encoding application which needs several HRP (main and test net, public and private)",
      "created_at": "2025-11-26T23:39:45Z",
      "updated_at": "2025-11-26T23:39:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566728839",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566728839"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566730566",
      "pull_request_review_id": 3513041170,
      "id": 2566730566,
      "node_id": "PRRC_kwDOAN28mc6Y_TNG",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@apoelstra already has a prefix, \"BIP32_24W\" which mixes up letter and numbers in violation of my proposal.",
      "created_at": "2025-11-26T23:41:21Z",
      "updated_at": "2025-11-26T23:41:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566730566",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566730566"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566747046",
      "pull_request_review_id": 3513057621,
      "id": 2566747046,
      "node_id": "PRRC_kwDOAN28mc6Y_XOm",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@apoelstra 's BIP32_24W has 82 length strings with at 9 character hrp.  82 + 9 = 91 which is just barely less than 93. \r\n\r\nOkay I guess the total length of a string + the length of the hrp (.i.e. double counting the hrp) must be less than or equal to 93 should be the rule for using the 13 character checksum.",
      "created_at": "2025-11-26T23:55:01Z",
      "updated_at": "2025-11-27T00:02:20Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566747046",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566747046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566769411",
      "pull_request_review_id": 3513080545,
      "id": 2566769411,
      "node_id": "PRRC_kwDOAN28mc6Y_csD",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Perhaps a better way of phrasing this is that the maximum length of string (including the HRP) for a given codex scheme is 93 - the length of the HRP.",
      "created_at": "2025-11-27T00:16:18Z",
      "updated_at": "2025-11-27T00:16:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566769411",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566769411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566777855",
      "pull_request_review_id": 3513089089,
      "id": 2566777855,
      "node_id": "PRRC_kwDOAN28mc6Y_ev_",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The situation is actually much worse than the 1/(2^65) sort.\r\n\r\nAh yes, I forgot how fragile ECC is when pushed beyond it's capacity.\r\n\r\n> \r\n> (...The point is that for the 93 character data part, mistaking the ms prefix for a cl prefix is the same as making a two character error in the checksum.)\r\n\r\nWell \"cl\" fortunately has a 32-byte length requirement (and we should probably start talking about length limits as payload bytes unless we want to support pure u5 secrets that do not need conversion to bytes) but we do need to plan for the eventual case of detecting HRP errors at the maximum 13 character checksum length.\r\n \r\n> Ugh, I'm starting to think you are right. The total length of strings must be 94 characters or less, with an exception that an ms string can be 96 characters.\r\n\r\n95 characters has an incomplete group decoding to bytes so I can remove the \"95 or\" 96.\r\n\r\n>Even a length restriction of 94 characters isn't going to be enough unless we also restrict the HRP to use only letters and disallow numbers (we could also accept underscores and perhaps a very small handful of carefully selected special ASCII characters).\r\n\r\nWhat do we need to restrict it to in order to allow every US-ASCII character?  Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\r\n\r\nie 5 US-ASCII characters should be similar to 7 data part characters.\r\n\r\nDoes that mean 52 US-ASCII character limit on the hrp for short codex32 strings?  That sounds fine. Although now we get a maximum length formula like strings can't exceed `(len(hrp) + 4) * 7 // 5 + len(payload) <= 74`\r\n\r\nWe also have restrictions within our own codex32 header that can be exploited to lend slightly more correction power to the human-readable part:\r\n9 out of 32 values for threshold. Threshold 0 only has 1/32 share indices.\r\n\r\nThat might get it to 53 US-ASCII, I didn't run the numbers.\r\n \r\n> And maybe (in a separate PR) we should outlaw unusual sized master seed strings too to get rid of even that \"ms\" exception if we can agree on a definition of unusual sized.\r\n\r\nI gave a very [good argument](https://github.com/BlockstreamResearch/codex32/pull/71#issuecomment-3445066181) to justify outlawing lengths besides 128, 192, 256, 512, or put another looser way, lengths not divisible by 64 bits.  Any closer has input lengths within the insert/delete correctable distance of two valid lengths and causes ambiguity.\r\n\r\nThis can be an \"ms\" specific recommendation (or requirement) I don't think every codex32 application needs to be as strict on lengths if they have a good reason to support variable length encodings. Although it would be worth recommending this 64 bit spacing to all applications in case their developers are unaware of the harm it causes insert/delete correction.\r\n\r\nThe final concern on this topic is that the maximum hrp length is really a derivative of the maximum checksummed payload length, which is 370 bits.  If we spend 70 bits on a 10 US-ASCII HRP, there's only 300 bits, 60 bech32 characters left for the secret.  or a 50 character HRP supports a payload length of 4 bech32 characters (2 bytes).\r\n\r\nThis is making me want to roll the HRP into the CRC, then we get an extra 1-4 bits of error detection on it, which in some cases will extend the permitted HRP length by 1.  OTOH for pure secret data recovery purposes, it's stronger if it just checksums the seed, although it barely matters since it can't correct any bit errors at the 128 or 256 bitlengths\r\n\r\n",
      "created_at": "2025-11-27T00:24:21Z",
      "updated_at": "2025-11-27T00:24:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566777855",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566777855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566787113",
      "pull_request_review_id": 3513098449,
      "id": 2566787113,
      "node_id": "PRRC_kwDOAN28mc6Y_hAp",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Given how length constrained our 13 character checksum is, I think we should restrict the HRP character set. I'd go for \"a-z\" and special characters `@_[|]~`, but the choice of special characters is debatable (but our options are limited). However, we will have to pick some.\r\n\r\nThis is too breaking of BIP-0173 spec, just allow the entire range and accept a shorter string.  If an application needs a super long HRP then either we don't allow it (83 maximum in BIP-0173, although must be lower here for short codex32) or they use the long codex32 checksum which is good for 730 HRP characters.\r\n\r\nDo we want to avoid a situation where strings of the same length and different HRP may be using different checksums, or if we don't care (i don't care)  we can choose the checksum according to combined length:\r\n\r\nWe pack the `bech32_hrp_expand(hrp) + data` and then use that to determine `checksum_len`, that would eliminate our HRP length requirement being smaller than BIP-0173's, do you agree with this solution?\r\n\r\nI'm sure there's some \"hrp insert/delete\" correction assumption nightmares for error correcting decoders but applications that need to disambiguate SHOULD at least make all the HRP's they must consider the same length to avoid this mess.\r\n\r\nI'm also fine with treating each HRP character as two bech32 characters for maximum length purposes, even though we can probably do better than that (even using `bech32_hrp_expand()`) due to each character only being a 7-bit value.",
      "created_at": "2025-11-27T00:32:58Z",
      "updated_at": "2025-11-27T00:35:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566787113",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566787113"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795329",
      "pull_request_review_id": 3513106754,
      "id": 2566795329,
      "node_id": "PRRC_kwDOAN28mc6Y_jBB",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Okay I guess the total length of a string + the length of the hrp (.i.e. double counting the hrp) must be less than or equal to 93 should be the rule for using the 13 character checksum.\r\n\r\nI like this.  Can we do better than double counting the HRP since each US-ASCII is 7- not 10 bits?  Or will our detection guarantees begin to break down (not able to correct any 2 HRP substitutions or detect any 4 HRP errors if its length exceed 37s, with an empty data part)?\r\n\r\nI guess the pure 7-bit character translation of our guarantees is: correct any 2 hrp errors, detect any 5 errors, 9 if contiguous for short codex32 (10 if contiguous on long codex32)\r\n\r\nCan we achieve this property simply?  We should if we can.",
      "created_at": "2025-11-27T00:41:02Z",
      "updated_at": "2025-11-27T00:41:02Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566795329",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795329"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795573",
      "pull_request_review_id": 3513107008,
      "id": 2566795573,
      "node_id": "PRRC_kwDOAN28mc6Y_jE1",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> What do we need to restrict it to in order to allow every US-ASCII character? Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\r\n\r\nThe issue is that for BCH codes the data really needs to fit within their length restriction, so we cannot just count entropy.  Even if we know some some bits are fixed, if the polynomial we extract has degree more that 93, everything falls apart because it can no longer distinguish errors on one side of the polynomial from errors on the other side of the polynomial.  The rules that the the string length plus counting the hrp again must be less than 93 is the only thing that makes the HRP expanded polynomial concatenated with the data part fit in degree at most 93.",
      "created_at": "2025-11-27T00:41:17Z",
      "updated_at": "2025-11-27T00:41:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567413699",
      "pull_request_review_id": 3513818681,
      "id": 2567413699,
      "node_id": "PRRC_kwDOAN28mc6ZB5_D",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 101,
      "original_position": 101,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Needs to become now to:\n\n```python\ndef codex32_verify_checksum(hrp, data):\n    combined = bech32_hrp_expand(hrp) + data\n    if len(combined) >= 96:\n        return codex32_verify_long_checksum(combined)\n    if len(combined) <= 93:\n        return codex32_polymod(combined) == CODEX32_CONST\n    return False\n```\n\nMissing:\n\n- the thorny zero length \"ms\" rule.\n- the check in `codex32_decode()` for the upper long codex32 length limit.\n\nBecause of this new max length rule rule we have the curious situation where valid \"long codex32\" strings can actually be shorter overall (and in data part characters) than regular codex32.\n\nMay want to rename that format any thoughts?\n\nEx:\n\"long\" codex32 format: 10 hrp characters + 1 + 6 header characters + 54 payload characters + 15 checksum characters = 86\ncodex32 format: \"ms\" hrp characters + 1 + 6 header characters + 74 payload characters + 13 checksum characters  = 96",
      "created_at": "2025-11-27T07:18:15Z",
      "updated_at": "2025-11-27T07:18:15Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567413699",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567413699"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567420813",
      "pull_request_review_id": 3513826410,
      "id": 2567420813,
      "node_id": "PRRC_kwDOAN28mc6ZB7uN",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def codex32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings",
      "path": "bip-0093.mediawiki",
      "position": 106,
      "original_position": 106,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Likewise, this needs to become:\n\n```python3\ndef codex32_create_checksum(hrp, data):\n    values = bech32_hrp_expand(hrp) + data\n    if len(values) > 80:                       # See Long codex32 Strings\n        return codex32_create_long_checksum(values)\n    polymod = codex32_polymod(values + [0] * 13) ^ CODEX32_CONST",
      "created_at": "2025-11-27T07:21:37Z",
      "updated_at": "2025-11-27T07:21:37Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567420813",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567420813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 128,
      "original_line": 128,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567495379",
      "pull_request_review_id": 3513909365,
      "id": 2567495379,
      "node_id": "PRRC_kwDOAN28mc6ZCN7T",
      "diff_hunk": "@@ -148,23 +163,64 @@ Note that unlike the decoding process in BIP-0173, we do NOT require that the in\n \n For an unshared secret, the threshold parameter (the first character of the data part) is ignored (beyond the fact it must be a digit for the codex32 string to be valid).\n We recommend using the digit \"0\" for the threshold parameter in this case.\n-The 4 character identifier also has no effect beyond aiding users in distinguishing between multiple different master seeds in cases where they have more than one.\n+The 4 character identifier also has no effect beyond aiding users in distinguishing between multiple different secrets or share sets with the same prefix in cases where they have more than one.\n \n-===Recovering Master Seed===\n+The function <code>codex32_encode</code> constructs a codex32 string when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part (excluding the checksum) as a list of 5-bit values\n \n-When the share index of a valid codex32 string (converted to lowercase) is not the letter \"s\", we call the string an codex32 share.\n+To validate a codex32 string, and determine the human-readable part and the data part (excluding the checksum) as a list of 5-bit values, the <code>codex32_decode</code> function can be used.\n+\n+<source lang=\"python\">\n+CHARSET = \"qpzry9x8gf2tvdw0s3jn54khce6mua7l\"\n+\n+def codex32_encode(hrp, data):\n+    combined = data + codex32_create_checksum(hrp, data)\n+    return hrp + '1' + ''.join([CHARSET[d] for d in combined])\n+\n+def codex32_decode(codex):\n+    if ((any(ord(x) < 33 or ord(x) > 126 for x in codex)) or\n+            (codex.lower() != codex and codex.upper() != codex)):\n+        return None, None\n+    codex = codex.lower()\n+    pos = codex.rfind('1')\n+    hrp = codex[:pos]\n+    if len(codex[pos+1:]) < 94:\n+        checksum_len = 13\n+        max_length = 96 if hrp == \"ms\" else 94\n+    elif 95 < len(codex[pos+1:]) < 1024:\n+        checksum_len = 15\n+        max_length = 1026 if hrp == \"ms\" else 1024",
      "path": "bip-0093.mediawiki",
      "position": 168,
      "original_position": 168,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Now these lines are wrong as well.\n\nSpecial rule for \"ms\" is ugly in code.\n\nNeeds change to:\n\n```python3\ndef codex32_decode(codex):\n    if ((any(ord(x) < 33 or ord(x) > 126 for x in codex)) or\n            (codex.lower() != codex and codex.upper() != codex)):\n        return None, None\n    codex = codex.lower()\n    pos = codex.rfind('1')\n    hrp = codex[:pos]\n    hrp_len = len(hrp) if hrp != \"ms\" else 0\n    if len(codex) + hrp_len < 97:\n        checksum_len = 13\n    elif 98 < len(codex) + hrp_len < 1027:\n        checksum_len = 15\n    else:\n        return None, None\n    if pos < 1 or len(codex[pos+1:]) < 6 + checksum_len or len(codex) > 1024:\n        return None, None\n    if not all(x in CHARSET for x in codex[pos+1:]):\n        return None, None\n    if not codex[pos+1].isdigit():\n        return None, None\n    if codex[pos+1] == \"0\" and codex[pos+6] != \"s\":\n        return None, None\n    data = [CHARSET.index(x) for x in codex[pos+1:]]\n    if not codex32_verify_checksum(hrp, data):\n        return None, None\n    return hrp, data[:-checksum_len]\n```",
      "created_at": "2025-11-27T07:54:08Z",
      "updated_at": "2025-11-27T07:54:08Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567495379",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567495379"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 188,
      "original_start_line": 188,
      "start_side": "RIGHT",
      "line": 193,
      "original_line": 193,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567504835",
      "pull_request_review_id": 3513922085,
      "id": 2567504835,
      "node_id": "PRRC_kwDOAN28mc6ZCQPD",
      "diff_hunk": "@@ -198,92 +254,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length\n * All of the share index values are distinct\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every set of shares the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret data, padded with arbitrary bits\n+# Generate a valid checksum in accordance with the Checksum section\n \n-Along with the codex32 secret, the user must generate ''t''-1 other codex32 shares, each with the same threshold value, the same identifier, and a distinct share index.\n-These shares should be generated as described in the \"fresh master seed\" section.\n+Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same human-readable part, the same threshold value, the same identifier, and a distinct share index.\n+These shares should be generated as described in the \"fresh secret\" section.\n \n-The codex32 secret and the ''t''-1 codex32 shares form a set of ''t'' valid codex32 strings from which additional shares can be derived as described above.\n+The codex32 secret and the ''k''-1 codex32 shares form a set of ''k'' valid codex32 strings from which additional shares can be derived as described above.\n \n-===Long codex32 Strings===\n+===Long codex32===\n \n The 13 character checksum design only supports up to 80 data characters.\n-Excluding the threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.\n+Excluding the human-readable part, threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.\n While this is enough to support the 32-byte advised size of BIP-0032 master seeds, BIP-0032 allows seeds to be up to 64 bytes in size.\n-We define a long codex32 string format to support these longer seeds by defining an alternative checksum.\n+We define a long codex32 format to support these longer seeds by defining an alternative checksum.\n \n <source lang=\"python\">\n-MS32_LONG_CONST = 0x43381e570bf4798ab26\n+CODEX32_LONG_CONST = 0x43381e570bf4798ab26\n \n-def ms32_long_polymod(values):\n+def codex32_long_polymod(values):\n     GEN = [\n         0x3d59d273535ea62d897,\n         0x7a9becb6361c6c51507,\n         0x543f9b7e6c38d8a2a0e,\n         0x0c577eaeccf1990d13c,\n         0x1887f74f8dc71b10651,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 70)\n         residue = (residue & 0x3fffffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_long_checksum(data):\n-    return ms32_long_polymod(data) == MS32_LONG_CONST\n+def codex32_verify_long_checksum(data):\n+    return codex32_long_polymod(data) == CODEX32_LONG_CONST\n \n-def ms32_create_long_checksum(data):\n+def codex32_create_long_checksum(data):\n     values = data\n-    polymod = ms32_long_polymod(values + [0] * 15) ^ MS32_LONG_CONST\n+    polymod = codex32_long_polymod(values + [0] * 15) ^ CODEX32_LONG_CONST\n     return [(polymod >> 5 * (14 - i)) & 31 for i in range(15)]\n </source>\n ",
      "path": "bip-0093.mediawiki",
      "position": 348,
      "original_position": 348,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Probably should mention its maximum length for the correction guarantees in a sentence here, similar to what is in the checksum section.  Otherwise 1024 is a magic number in the reference snippets.",
      "created_at": "2025-11-27T07:57:47Z",
      "updated_at": "2025-11-27T07:57:47Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567504835",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567504835"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 347,
      "original_line": 347,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569539679",
      "pull_request_review_id": 3516398393,
      "id": 2569539679,
      "node_id": "PRRC_kwDOAN28mc6ZKBBf",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 101,
      "original_position": 101,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I can probably write this code out if you want, but my thoughts are we should have `codex32_decode`, an independent `long_codex32_decode` and an `ms_decode` that can call both of them. ",
      "created_at": "2025-11-27T16:55:51Z",
      "updated_at": "2025-11-27T16:55:51Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569539679",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569539679"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569613685",
      "pull_request_review_id": 3516490204,
      "id": 2569613685,
      "node_id": "PRRC_kwDOAN28mc6ZKTF1",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 101,
      "original_position": 101,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That makes sense!  Bech32 has an encode/decode for the format and then a separate encode/decode function for segwit addresses.\n\nHowever they do verify and decode both Bech32/Bech32m checksums at once.\n\nIt's not possible to tell which codex32/long_codex32 checksum is used by looking at either the hrp or data part in edge cases. So we need codex32_encode and codex32_decode function to handle both checksums.\n\nShould we rename the long spec codex32l (long) codex32ext (extended), codex32xl (extra long/large), codex32xxl, codex32hc (high-capacity), to match the name of Bech32m in BIP-0350?\n\nThe space between words gives ambiguity when we write about it sometimes.\n\nEdit: you can write the code if you want. I'll not touch it in my next commit to this doc.\n\nEdit2: an easy solution is codex32_decode and codex32_encode calling the `codex32_create_checksum` and `codex32_verify_checksum` with the hrp pre expanded. Then no change is needed to those functions besides the rename. However now they can't be used easily since they don't expand the hrp for the caller. bech32 has its create and verify functions take the hrp as a parameter and so probably should we copy that.",
      "created_at": "2025-11-27T17:29:22Z",
      "updated_at": "2025-11-27T17:36:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569613685",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569613685"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569665206",
      "pull_request_review_id": 3516546816,
      "id": 2569665206,
      "node_id": "PRRC_kwDOAN28mc6ZKfq2",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 101,
      "original_position": 101,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Below is untested code that is approximately what I'm thinking\r\n\r\n```\r\ndef bech32_hrp_expand(s):\r\n  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\r\n\r\nCODEX32_CONST = 0x10ce0795c2fd1e62a\r\n  \r\ndef codex32_polymod(residue, values):\r\n    if len(values) > 93:\r\n        return False\r\n    GEN = [\r\n        0x19dc500ce73fde210,\r\n        0x1bfae00def77fe529,\r\n        0x1fbd920fffe7bee52,\r\n        0x1739640bdeee3fdad,\r\n        0x07729a039cfc75f5a,\r\n    ]\r\n    for v in values:\r\n        b = (residue >> 60)\r\n        residue = (residue & 0x0fffffffffffffff) << 5 ^ v\r\n        for i in range(5):\r\n            residue ^= GEN[i] if ((b >> i) & 1) else 0\r\n    return residue\r\n\r\nCODEX32_LONG_CONST = 0x43381e570bf4798ab26\r\n    \r\ndef codex32_long_polymod(residue, values):\r\n    if len(values) > 1023:\r\n        return False\r\n    GEN = [\r\n        0x3d59d273535ea62d897,\r\n        0x7a9becb6361c6c51507,\r\n        0x543f9b7e6c38d8a2a0e,\r\n        0x0c577eaeccf1990d13c,\r\n        0x1887f74f8dc71b10651,\r\n    ]\r\n    for v in values:\r\n        b = (residue >> 70)\r\n        residue = (residue & 0x3fffffffffffffffff) << 5 ^ v\r\n        for i in range(5):\r\n            residue ^= GEN[i] if ((b >> i) & 1) else 0\r\n    return residue\r\n\r\ndef codex32_verify_checksum(hrp, data):\r\n    return codex32_polymod(1, bech32_hrp_expand(hrp) + data) == CODEX32_CONST\r\n    \r\ndef codex32_verify_long_checksum(hrp, data):\r\n    return codex32_long_polymod(1, bech32_hrp_expand(hrp) + data) == CODEX32_LONG_CONST\r\n\r\ndef codex32_create_checksum(hrp, data):\r\n    polymod = codex32_polymod(1, bech32_hrp_expand(hrp) + data + [0] * 13)\r\n    if polymod:\r\n        polymod = polymod ^ MS32_CONST\r\n        return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\r\n    return False\r\n\r\ndef codex32_create_long_checksum(hrp, data):\r\n    polymod = codex32_long_polymod(1,bech32_hrp_expand(hrp) + data + [0] * 15)\r\n    if polymod:\r\n        polymod = polymod ^ MS32_LONG_CONST\r\n        return [(polymod >> 5 * (14 - i)) & 31 for i in range(15)]\r\n    return False\r\n\r\ndef ms32_verify_checksum(data):\r\n    if len(data) >= 96:\r\n        return codex32_verify_long_checksum(\"ms\", data)\r\n    return codex32_polymod(codex32_polymod(1, bech32_hrp_expand(\"ms\")), data) == CODEX32_CONST\r\n\r\ndef ms32_create_checksum(data):\r\n    if len(data) > 80:\r\n        return codex32_create_long_checksum(\"ms\", data)\r\n    polymod = codex32_polymod(codex32_polymod(1, bech32_hrp_expand(\"ms\")), data + [0] * 13)\r\n    polymod = polymod ^ CODEX32_CONST\r\n    return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\r\n```\r\n\r\nAs you can see, I think it is up to the particular application to handle switching between the long codex32 format and the regular codex32 format.  ",
      "created_at": "2025-11-27T17:55:27Z",
      "updated_at": "2025-11-27T18:04:53Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569665206",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569665206"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569931236",
      "pull_request_review_id": 3516870732,
      "id": 2569931236,
      "node_id": "PRRC_kwDOAN28mc6ZLgnk",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 101,
      "original_position": 101,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We can't assume \"ms\" to know which checksum to verify.\r\n\r\nIf there's an `hrp` substitution error, we need to know which checksum is being used to detect/correct it, but if which checksum depends on which `hrp` application, instead of just codex32 string length, then we're stuck.\r\n\r\nThat made our length 96 exception a bug, as how can a decoder know this rule applies if it can't detect the integrity of what determines its applicability?\r\n\r\nWe also should keep BIP-0173's decision to error detect guarantee only the lower 5 bits of HRP characters.  As the swaps that produce an upper bit change only are very unlikely.\r\n\r\nThis also lets us say short codex32 for up to string length 94 and long codex for 98 and longer and be done with it.  And avoid weirdness where long codex could be a shorter string than short codex due to hrp double counting.",
      "created_at": "2025-11-27T20:41:13Z",
      "updated_at": "2025-11-27T20:42:22Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569931236",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569931236"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570037680",
      "pull_request_review_id": 3517015423,
      "id": 2570037680,
      "node_id": "PRRC_kwDOAN28mc6ZL6mw",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If we REQUIRE every registered HRP be unique in the lower 5 bits then:\r\n1. we don't have to ever distinguish errors in the high bits they're a lookup table, VALID_HRP.\r\n1. the expanded data we covered by the checksum will be < 93 single counting hrp characters.\r\n1. With the valid HRP table, Correcting errors in the low bits, corrects any errors in the high bits.\r\n1. We know which checksum is being used by the length of the string, which is far simpler than a per hrp (impossible) design or one that double weights hrp characters towards max_length.",
      "created_at": "2025-11-27T22:15:05Z",
      "updated_at": "2025-11-27T22:15:06Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570037680",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570037680"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570046707",
      "pull_request_review_id": 3517024161,
      "id": 2570046707,
      "node_id": "PRRC_kwDOAN28mc6ZL8zz",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> With the valid HRP table, Correcting errors in the low bits, corrects any errors in the high bits.\r\n\r\nIt's not that simple.  For maximum length codex32 string, errors in the high bits _appear_ as errors in the checksum at the end of the string because for BCH codes, any polynomial longer than the maximum length (93 in our case) effectively wraps around.\r\n\r\nEdit: And errors in the high bits are not going to be uncommon.  Let me tell you the number of times I've mistaken a `5` for an `S`.",
      "created_at": "2025-11-27T22:26:05Z",
      "updated_at": "2025-11-27T22:32:13Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570046707",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570046707"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570060471",
      "pull_request_review_id": 3517039360,
      "id": 2570060471,
      "node_id": "PRRC_kwDOAN28mc6ZMAK3",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Then let's guarantee to detect 8 errors, 13/15 if contiguous in the low bits, BIP-0173 style but not error correct the HRP.  Trying different suspected HRPs will have to be the way to correct a damaged prefix, like our rationale suggests doing.",
      "created_at": "2025-11-27T22:41:29Z",
      "updated_at": "2025-11-27T22:41:29Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570060471",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570060471"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    }
  ]
}