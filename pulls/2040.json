{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/2040",
    "id": 3035878793,
    "node_id": "PR_kwDOAN28mc6089WJ",
    "html_url": "https://github.com/bitcoin/bips/pull/2040",
    "diff_url": "https://github.com/bitcoin/bips/pull/2040.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/2040.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/2040/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/8e4256807d81dde5531dc9593667c86700050dfc",
    "number": 2040,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "BIP93: Generalize codex32 format for any hrp and fix typos",
    "user": {
      "login": "BenWestgate",
      "id": 73506583,
      "node_id": "MDQ6VXNlcjczNTA2NTgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenWestgate",
      "html_url": "https://github.com/BenWestgate",
      "followers_url": "https://api.github.com/users/BenWestgate/followers",
      "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
      "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
      "repos_url": "https://api.github.com/users/BenWestgate/repos",
      "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "**Summary of Changes:**\r\nDescribe codex32 format for arbitrary human-readable parts not just \"ms\", specify master seed encoding standard, add new test vectors and enhance readability. This makes the document more like BIP-0173: proposing an encoding \"codex32\", then defining a standard for something using it.\r\n\r\nSee discussion on https://github.com/bitcoin/bips/pull/2023#issuecomment-3538570493.\r\n\r\n**Spec:**\r\n- fixed the threshold mistake in the abstract\r\n- replaced \"master seed\" with \"secret\", prior to the \"Master seed format\" section and made descriptions hrp general\r\n- updated the checksum reference code to produce valid checksums for any `hrp`\r\n- change _t_ to _k_ to match the test vectors and book\r\n- defined \"ms\" codex32 secrets:\r\n  - using terms \"secret seed\" (as the book does) and \"codex32-encoded master seed\" to refer to \"ms\" codex32 secrets\r\n  - recommended using first 4 characters of the bech32-encoded fingerprint as the identifier\r\n  - recommended the padding bits be set with a CRC code for extra error detection. Provided reference code for this checksum.\r\n\r\n**Test Vectors:**\r\n\r\n- Fixed the cornucopia of naming conventions in the Test vectors \r\n  - used mostly \"secret seed\", \"codex32 secret\", and \"codex32-encoded X\".\r\n- Fixed test vector 5 which did not actually append a long checksum to \"random\" data as the text said it would.\r\n- Added vector 6 encoding a \"cl\" prefix codex32-encoded HSM secret, then relabels the identifier (producing a new checksum and codex32-encoded HSM secret)\r\n- Added vector 7 which parses a \"cl\" prefix codex32 secret and decodes the HSM secret\r\n- Clarified why invalid prefix test vectors were bad (their checksum is for \"ms\" but their prefix is not \"ms\")\r\n- We might want to add one that uses \"cl\" with the old \"ms\" checksum code as that will now fail with the updated `ms32_verify_checksum` function\r\n\r\n",
    "labels": [
      {
        "id": 275846070,
        "node_id": "MDU6TGFiZWwyNzU4NDYwNzA=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Proposed%20BIP%20modification",
        "name": "Proposed BIP modification",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 286161898,
        "node_id": "MDU6TGFiZWwyODYxNjE4OTg=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Pending%20acceptance",
        "name": "Pending acceptance",
        "description": "This BIP modification requires sign-off by the champion of the BIP being modified",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2025-11-22T06:36:29Z",
    "updated_at": "2025-12-16T09:20:36Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merged": false,
    "merge_commit_sha": "9afc0afbc437418f3e3cebc38578087ba7b946c0",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "BenWestgate:bip93-fix-threshold",
      "ref": "bip93-fix-threshold",
      "sha": "8e4256807d81dde5531dc9593667c86700050dfc",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1040826915,
        "node_id": "R_kgDOPgnCIw",
        "name": "bips",
        "full_name": "BenWestgate/bips",
        "owner": {
          "login": "BenWestgate",
          "id": 73506583,
          "node_id": "MDQ6VXNlcjczNTA2NTgz",
          "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/BenWestgate",
          "html_url": "https://github.com/BenWestgate",
          "followers_url": "https://api.github.com/users/BenWestgate/followers",
          "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
          "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
          "repos_url": "https://api.github.com/users/BenWestgate/repos",
          "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/BenWestgate/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/BenWestgate/bips",
        "archive_url": "https://api.github.com/repos/BenWestgate/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/BenWestgate/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/BenWestgate/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/BenWestgate/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/BenWestgate/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/BenWestgate/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/BenWestgate/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/BenWestgate/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/BenWestgate/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/BenWestgate/bips/contributors",
        "deployments_url": "https://api.github.com/repos/BenWestgate/bips/deployments",
        "downloads_url": "https://api.github.com/repos/BenWestgate/bips/downloads",
        "events_url": "https://api.github.com/repos/BenWestgate/bips/events",
        "forks_url": "https://api.github.com/repos/BenWestgate/bips/forks",
        "git_commits_url": "https://api.github.com/repos/BenWestgate/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/BenWestgate/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/BenWestgate/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/BenWestgate/bips.git",
        "issue_comment_url": "https://api.github.com/repos/BenWestgate/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/BenWestgate/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/BenWestgate/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/BenWestgate/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/BenWestgate/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/BenWestgate/bips/languages",
        "merges_url": "https://api.github.com/repos/BenWestgate/bips/merges",
        "milestones_url": "https://api.github.com/repos/BenWestgate/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/BenWestgate/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/BenWestgate/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/BenWestgate/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:BenWestgate/bips.git",
        "stargazers_url": "https://api.github.com/repos/BenWestgate/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/BenWestgate/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/BenWestgate/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/BenWestgate/bips/subscription",
        "tags_url": "https://api.github.com/repos/BenWestgate/bips/tags",
        "teams_url": "https://api.github.com/repos/BenWestgate/bips/teams",
        "trees_url": "https://api.github.com/repos/BenWestgate/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/BenWestgate/bips.git",
        "hooks_url": "https://api.github.com/repos/BenWestgate/bips/hooks",
        "svn_url": "https://github.com/BenWestgate/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 18568,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-16T08:11:48Z",
        "created_at": "2025-08-19T15:04:43Z",
        "updated_at": "2025-11-21T03:37:46Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "1e663c21500979451c97da390ddd3052866af101",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5840,
        "stargazers_count": 10422,
        "watchers_count": 10422,
        "size": 18522,
        "default_branch": "master",
        "open_issues_count": 68,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-16T02:17:04Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2025-12-16T08:07:36Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 147,
    "deletions": 71,
    "changed_files": 1,
    "commits": 6,
    "review_comments": 90,
    "comments": 16
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGM2ZjhiZDA3YTZkYzE4YzdkMTM4NzRhYWZhYmNjNzRjYWM5MWZlOTk",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
      "tree": {
        "sha": "055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 055ecb66f5a0d1f1d0ec5931ca1c5b9c0587fbc1\nparent 3851847d0a67f85d40f44eb5c4090efe04a26ac5\nauthor Ben Westgate <BenWestgate@protonmail.com> 1763791137 -0600\ncommitter GitHub <noreply@github.com> 1763791137 -0600\n\nGeneralize codex32 format for any hrp and fix typos\n\nClarify codex32 format for different hrp values, specify master seed encoding standard, add new test vectors and enhance readability.",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpIVEhCRC1aQ7uu5UhlAAAsHcQAGNFIDefetvZU5gfMvs0YDfJ\nGItxRxGN86n+pTJHYnj0+oS7ikeO8BWavod25zMfSyqwOx+erQXi0xeL1mfVnpm+\nsAf1loP3+b3zyF/OZHFf6dO56IUF76B8YDTpltxRL2oF0JAX1PeofUSVAr5FmhCI\nOSpUV4EeExD1cXk5GYL2xxKaCk0JiVRgyMsKnMUthrYjz1pYt8B0fSh849oLjcuJ\nF1l/pYpxcm6KRgU1sIv8a7wjJz7tMPrQUnasOGSPSSVmFU+X7Flj5p2l6eAKEo+n\n7ynP/JNrttOQJJjnjnsZtZqlYYwYeEffiNQVJ/6BDMv6e3k+D8+X6qpfE2r4zd0C\neeZiyvOtIsm/ekkGgrfRSBkU6BxIJLEzue4g8uW6nfN/9x+SvPOhjCkZpJpIz/1i\n8LPvtgYesB1bapPPiCKHnKt3rVUiV8mKwxaaWeDMDJESzwZnVLSbQPuBNO7vYoqe\nY8Dez1yG1vTSni59cTYdtmLuVEaLQ3URZOewq/xy85vlwnCfxLa8gluBV4PnF6FF\nvrPIue8cnX2O/7U/QOjK2CaVhK8TG/RnKFIqu6uD9yhSdAYbJBwGP9FEp0UJo5fp\nrpwpO7xTCAOADqA8VTtAy7xXxrynJBCPYQjb50FinNEq1AXmGlJpKqK4J+euPD9D\nTg7/Iy7qdZg+ct8Igwd0\n=/fdx\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/3851847d0a67f85d40f44eb5c4090efe04a26ac5",
          "sha": "3851847d0a67f85d40f44eb5c4090efe04a26ac5",
          "html_url": "https://github.com/bitcoin/bips/commit/3851847d0a67f85d40f44eb5c4090efe04a26ac5"
        }
      ],
      "message": "Generalize codex32 format for any hrp and fix typos\n\nClarify codex32 format for different hrp values, specify master seed encoding standard, add new test vectors and enhance readability.",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-22T05:58:57Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-22T05:58:57Z"
      },
      "sha": "c6f8bd07a6dc18c7d13874aafabcc74cac91fe99"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGFlZGI5MTJiZDE3YzA3MzZiMjFhY2NkODRjM2Y1Y2UzZTBiN2Q2MTc",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "tree": {
        "sha": "30dd8e433da05e27bc94b4734de348b5952381af",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/30dd8e433da05e27bc94b4734de348b5952381af"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 30dd8e433da05e27bc94b4734de348b5952381af\nparent c6f8bd07a6dc18c7d13874aafabcc74cac91fe99\nauthor Ben Westgate <BenWestgate@protonmail.com> 1763793765 -0600\ncommitter GitHub <noreply@github.com> 1763793765 -0600\n\nRevert title for BIP93 document",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpIVtlCRC1aQ7uu5UhlAAAUIkQACVNHJMVtYJhDr6Dl5U3+ew5\nEQ5uNCE4wD8WL5yizGR2Pu/5H2tUav13045cJ1lhd84oO/MFnqRl9MbF7P0jfJWs\nUe17jXH5nfy0nJWFgXAXVWDjicd4dcMImhqdb1Jcwjw71MtbTrjfZyEUePD3NNXI\nxIfFUx3V58w+lPQVHXkfeNX6yyDcSeZHidMySZ7WFOYLGb5SHtjTGII9YUcIzArC\n65IPXhCeOXt847WZ9lmtyJrC0RBUAQyDxsQpUKh34GKLpscwaOSebov/2CUE+6wm\nqS/6/QsDJcd9+67sfFgPnbJr6KqZ6nZ2Y2yAmKPAlZt/kFZu2n96aUBOkjyVURS0\nMPhy/cojXlMi0lMwFKaLnklwjFykjcbBWGY+COFzLS0tEy+vfFQyIpoTKcVCdFMW\nwgDOZGtW7RVfBjK/rpajCG66tGNlmIn+QD6AwoxJx8Ityk/WIduk7G9VW1Lao6U0\n+lvrM2x3UjaL2t09qcgnuSmjAiXB8bV+APz9F0Q/iOVKTlpvtJn/R9FtPhj0poUm\nwWHmt/NAvR5UGEcqYFrzLdGJjsJwkVnZZuW3nKvTU0NIxxf1dbnwgl4mbnhTly1i\nhbVyc07OcsdKae2H3aHCEKYH9bYoyJp6JIA9iTTUJ4s6PRorRse8qGaF8oP5bCr2\n50TtZHwtQqbDx0KrLOZO\n=Fepj\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
          "sha": "c6f8bd07a6dc18c7d13874aafabcc74cac91fe99",
          "html_url": "https://github.com/bitcoin/bips/commit/c6f8bd07a6dc18c7d13874aafabcc74cac91fe99"
        }
      ],
      "message": "Revert title for BIP93 document",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-22T06:42:45Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-22T06:42:45Z"
      },
      "sha": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617"
    },
    {
      "event": "labeled",
      "id": 21115636144,
      "node_id": "LE_lADOAN28mc7ZzDLFzwAAAATqlwmw",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21115636144",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-22T15:17:02Z",
      "label": {
        "name": "Proposed BIP modification",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 21115636149,
      "node_id": "LE_lADOAN28mc7ZzDLFzwAAAATqlwm1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21115636149",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-22T15:17:02Z",
      "label": {
        "name": "Pending acceptance",
        "color": "fbca04"
      }
    },
    {
      "event": "reviewed",
      "id": 3501457605,
      "node_id": "PRR_kwDOAN28mc7QtADF",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-24T17:41:35Z",
      "author_association": "NONE",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3501457605",
      "submitted_at": "2025-11-24T17:41:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3501578813,
      "node_id": "PRR_kwDOAN28mc7Qtdo9",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-24T17:53:09Z",
      "author_association": "NONE",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3501578813",
      "submitted_at": "2025-11-24T17:53:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3506316041,
      "node_id": "PRR_kwDOAN28mc7Q_iMJ",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T18:24:47Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3506316041",
      "submitted_at": "2025-11-25T18:24:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3506378123,
      "node_id": "PRR_kwDOAN28mc7Q_xWL",
      "url": null,
      "actor": null,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T18:42:56Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3506378123",
      "submitted_at": "2025-11-25T18:42:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGE0ZjFlOTFhZDk0ODNiNWQ1ODNmZDdmNDBhY2JlYjA4MWUxMmNiNjI",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "tree": {
        "sha": "482677c072250d7a23dd1352c44d82c62ca70779",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/482677c072250d7a23dd1352c44d82c62ca70779"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 482677c072250d7a23dd1352c44d82c62ca70779\nparent aedb912bd17c0736b21accd84c3f5ce3e0b7d617\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764108387 -0600\ncommitter GitHub <noreply@github.com> 1764108387 -0600\n\nRename ms32 functions to codex32, remove recommendations, clarify HRP case in checksum",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJihjCRC1aQ7uu5UhlAAA1wsQAFS/gKYe1pDyrdZGbr26AU7M\nHxhzpJnEqN5gdmvm5s8NhLOcz3goTdJ2m4fei1QL+Q84c4RXXPUePxkdBuym9mcl\n2G5Lul0mVInRYnV5QHq55w7LXM36oXHGBGauKqWtrOkcA1Jp9tcI+tzeGlNkrN9m\nSyFtWFeLZ5gO0MTNGx5Eg5mpXXjQFHLcwcs6mSSp8LIEUmg8STyW4l1RGfoZ8ZJK\nz0MZXPkErnz6h0x6WWx5ATgcuO/OEY5aTDnT9d9aEOR9X9dr2iVIgWmahQFiW5NE\nAuO6izufEJTLFXjMw2/yQqpvAJCCli2qI42s4XKM/3KnuHMPaUCxDQjLNKtIQcN5\nF7kBzHotOlNGE9esuQYrt4IPtkLX43D6VaDyrMjtAQFrLP6fs8wd5y8I6ooKYE1h\nkPI8gV68tE5yLxVO77lI7hYo4th4NpxVH45MLCpS0BfGwyxuesfy9a0OXaMKxzJR\n41U/TmYW/8+pp2aGcnMlNb6a5p2Y9UpVE8sMA/ErQgK/o4zA++hbmAaS5osCQVKW\nu1pFlMAhhliXzmzwLqAE+3l1lWIr32gUcHM5eI4iffjm0nKlJtLIxY52JybItugV\nE429P9fNfylstS+K6TiaHBuFrUKdOH8jm1wiCMg6mYrRjXDxfbaULTVYIxIsF3lq\nOITFUjbWn8WM2tNJBIEU\n=+x6B\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
          "sha": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
          "html_url": "https://github.com/bitcoin/bips/commit/aedb912bd17c0736b21accd84c3f5ce3e0b7d617"
        }
      ],
      "message": "Rename ms32 functions to codex32, remove recommendations, clarify HRP case in checksum",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-25T22:06:27Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-25T22:06:27Z"
      },
      "sha": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62"
    },
    {
      "event": "reviewed",
      "id": 3507072048,
      "node_id": "PRR_kwDOAN28mc7RCaww",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:10:40Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507072048",
      "submitted_at": "2025-11-25T22:10:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507092272,
      "node_id": "PRR_kwDOAN28mc7RCfsw",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:16:07Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507092272",
      "submitted_at": "2025-11-25T22:16:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507106951,
      "node_id": "PRR_kwDOAN28mc7RCjSH",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:19:55Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507106951",
      "submitted_at": "2025-11-25T22:19:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507128287,
      "node_id": "PRR_kwDOAN28mc7RCoff",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:25:46Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507128287",
      "submitted_at": "2025-11-25T22:25:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3507145870,
      "node_id": "PRR_kwDOAN28mc7RCsyO",
      "url": null,
      "actor": null,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:30:23Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3507145870",
      "submitted_at": "2025-11-25T22:30:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGY3NDUyN2VkNGYwZjEyNjc2ZjVkMjBkOTk3MWNlMjY2NTc4MGYwZmE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
      "tree": {
        "sha": "96fa56c0148ec59238acd8baf3dbc2fe37160e62",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/96fa56c0148ec59238acd8baf3dbc2fe37160e62"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 96fa56c0148ec59238acd8baf3dbc2fe37160e62\nparent a4f1e91ad9483b5d583fd7f40acbeb081e12cb62\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764185586 -0600\ncommitter GitHub <noreply@github.com> 1764185586 -0600\n\nFix Test vector 5, add encode/decode ref, add length limit, add clairity\n\nClarify codex32 specification and examples for encoding and decoding processes, including detailed explanations of parameters and checksum handling.",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJ1XyCRC1aQ7uu5UhlAAA5AgQAEnclL/c6gZJYd3xxYZKHitI\n4mqnPVylXW0dsqTLLrD6oKIXSEZflnD7gkHwg252XnfnOHz906N9Z5PVctkkzNcT\n71u94A2PZhDacemRVS6NOCAMo7zhWuar6BTsrBfwRBRmMRA5hTO3aA0ksNooQXmj\nk+cKB87wZlKWaas7ZSqv3moLrsSTlyb3bR/f77DbgScYFTivgLN6ShhFnVeb3VzM\nkm75yc19+yxJkgPeZG06Y5ToZpjPgHDy4GLgwOq7Bv5Gm1IbDOAEEDLVtfvBDS7r\nU3xxQUPmtSTzZN9S2/Ctw/nOBQfj7DjSaF1Fi/35jh3XXJH8sVmYLvTxmq5/WMQ1\nx2CsWZpHhsAXV6zLBOMM6ZVzYo6mtuwO9+KZPTCfQg4H9TccRPx0i5xetocXrP8n\nqEvATnmXXncnVdPOz3wtqzGXk6EFzMMDIQ0MX/q80LIWRHUy9OUmmGQQNiY13CTw\nG9Pv8Bet9wm9ZR/Zw47+5ROk/+ueWORe1w+YExpQjzKFf93H/N3odnj78GwXYQBb\npKQLtTLIBNw4+a85Qqrqi35R3eiWUfW6LTQ3jTcA91dnGCIQ8zXVwZsV4maSdoml\nDB/D0AF73kmUaPGkfr0RUFtyFGo6M4JMmvJKEdKireVPzlOx+Gj22YXcyWap6eMM\nrMO2QHbUh7Yzvqmz9rOn\n=+N/P\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
          "sha": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
          "html_url": "https://github.com/bitcoin/bips/commit/a4f1e91ad9483b5d583fd7f40acbeb081e12cb62"
        }
      ],
      "message": "Fix Test vector 5, add encode/decode ref, add length limit, add clairity\n\nClarify codex32 specification and examples for encoding and decoding processes, including detailed explanations of parameters and checksum handling.",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-26T19:33:06Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-26T19:33:06Z"
      },
      "sha": "f74527ed4f0f12676f5d20d9971ce2665780f0fa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDMxMjNjZWFkMWQwZDkyZWRiYzllM2U4OTgxNGJkNTdlZTFkMTQ2N2Q",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "tree": {
        "sha": "b02343a49b3d39eacd736308323742d9f9e1f422",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/b02343a49b3d39eacd736308323742d9f9e1f422"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b02343a49b3d39eacd736308323742d9f9e1f422\nparent f74527ed4f0f12676f5d20d9971ce2665780f0fa\nauthor Ben Westgate <BenWestgate@protonmail.com> 1764185669 -0600\ncommitter GitHub <noreply@github.com> 1764185669 -0600\n\nRevert deleted new line",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpJ1ZFCRC1aQ7uu5UhlAAAEYQQAAwUh1tP8FKlGfuCH35j6XWr\nY0RNXg2nGRfMSvkEa4lABULYkptSIzjn1mfbbRU1HJQppaIu7JLgocIP3JuC8X7M\npF3QTbLu1WKjD62PdqPtLAszqBZooipbYTcst/DZV0u53FB8PeyhFlRN7V6UrI7K\nz7VKll7G8zDu6PIzabe4B75/mYp4cs1TfziFoHQu/pmJVx6cTEEfDHvNRwk1MZYi\ni9QR2PxgQz2i5AcKCO2UlJbZQ1aiRh9MWqh56p9PQkYAAEwp27Z1QPUivy2d2XpH\n297z/rFYNdOoRIZec8+w7RyW6XYdGpSDGl8Hz4lSg6Uxby9Amnvyz4FfbQ1USuq9\nMYoGp7VoEC9/1PVdGop9nSWcyBlSfkkeIRlvG8UX4Vm8HqLLYjCfrPBlfyBrLAv0\n5Ln+DXC0F9mYAwSs5n+mwhhuwptSDzt38DJmOCWvubxmH1LVsbAZdNmOC0idfoCM\nCVYSXcQk1bBtQL4ZXVj0pUrNLNGbUexYro5leTS3eJr5COW9dTNN/bD9NPZ3DrGV\nuo0TZiuRsbpRCuP/DDXPZ7P2y+pYR2fQc4PPo/3HPU/dUDmVlIl24//K4QDGiQGC\nfWFSoR0ge9L56Rxjkn7yi8NZRn0PeorUTtZDhB6cNrgDWJxd7WhyAJRXOazd5SqE\ntQ9y01fv4OtbxCGP5i8W\n=qEZv\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f74527ed4f0f12676f5d20d9971ce2665780f0fa",
          "sha": "f74527ed4f0f12676f5d20d9971ce2665780f0fa",
          "html_url": "https://github.com/bitcoin/bips/commit/f74527ed4f0f12676f5d20d9971ce2665780f0fa"
        }
      ],
      "message": "Revert deleted new line",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-11-26T19:34:29Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-11-26T19:34:29Z"
      },
      "sha": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d"
    },
    {
      "event": "reviewed",
      "id": 3512534912,
      "node_id": "PRR_kwDOAN28mc7RXQeA",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:44:13Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512534912",
      "submitted_at": "2025-11-26T19:44:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3512545868,
      "node_id": "PRR_kwDOAN28mc7RXTJM",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:48:48Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512545868",
      "submitted_at": "2025-11-26T19:48:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3512550880,
      "node_id": "PRR_kwDOAN28mc7RXUXg",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T19:50:44Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3512550880",
      "submitted_at": "2025-11-26T19:50:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3583669131,
      "node_id": "IC_kwDOAN28mc7VmnOL",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3583669131",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:34Z",
      "updated_at": "2025-11-27T00:48:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "Fair enough, double counting it is. That's easy to remember and implement.\n\nPacking the 7-bit values together wouldn't have helped much anyway because single ASCII errors would affect multiple data symbols especially when isolated.\n\nI'll be adding your length of the string is 93 - length of the HRP.\n\nAnd we're keeping the special rule for 96 where the HRP MUST equal \"MS\"?\n\nSent with [Proton Mail](https://proton.me/mail/home) secure email.\n\nOn Wednesday, November 26th, 2025 at 6:41 PM, roconnor ***@***.***> wrote:\n\n> @roconnor commented on this pull request.\n>\n> ---------------------------------------------------------------\n>\n> In [bip-0093.mediawiki](https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573):\n>\n>>      polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n>      return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n>  </source>\n>\n> +This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n> +guarantees detection of '''any error affecting at most 8 characters'''\n> +and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n> +errors. The human-readable part is processed by first\n> +feeding the higher bits of each character's US-ASCII value into the\n> +checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n> +This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the\n>\n>> What do we need to restrict it to in order to allow every US-ASCII character? Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\n>\n> The issue is that for BCH codes the data really needs to fit within their length restriction, so we cannot just count entropy. Even if we know some some bits are fixed, if the polynomial we extract has degree more that 93, everything falls apart because it can no longer distinguish errors on one side of the polynomial from errors on the other side of the polynomial. The rules that the the string length plus counting the hrp again must be less than 93 is the only thing that makes the HRP expanded polynomial concatenated with the data part fit in degree at most 93.\n>\n> \n> Reply to this email directly, [view it on GitHub](https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/ARQZ6F5CUBY3QXAITRFPOLL36ZCEHAVCNFSM6AAAAACM4BCWD6VHI2DSMVQWIX3LMV43YUDVNRWFEZLROVSXG5CSMV3GSZLXHMZTKMJTGEYDOMBQHA).\n> You are receiving this because you authored the thread.Message ID: ***@***.***>",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3583669131",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21207813587,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAATwFY3T",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21207813587",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:35Z"
    },
    {
      "event": "subscribed",
      "id": 21207813600,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAATwFY3g",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21207813600",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:48:36Z"
    },
    {
      "event": "commented",
      "id": 3583676996,
      "node_id": "IC_kwDOAN28mc7VmpJE",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3583676996",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T00:52:31Z",
      "updated_at": "2025-11-27T00:54:37Z",
      "author_association": "NONE",
      "body": "Yes let's keep the silly exception for now for the sake of getting a agreeable PR.  We should hammer out the master seed bit-size restrictions in a separate PR.\r\n\r\nIf you want to say that length 96 ms seeds are deprecated that's okay too.  But I still want to argue for the merits of 160 bit master seeds.",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3583676996",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "reviewed",
      "id": 3513818681,
      "node_id": "PRR_kwDOAN28mc7RcJ45",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:18:15Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513818681",
      "submitted_at": "2025-11-27T07:18:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3584502682,
      "node_id": "IC_kwDOAN28mc7Vpyua",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3584502682",
      "actor": {
        "login": "bosshaas13131313",
        "id": 189472237,
        "node_id": "U_kgDOC0sd7Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/189472237?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosshaas13131313",
        "html_url": "https://github.com/bosshaas13131313",
        "followers_url": "https://api.github.com/users/bosshaas13131313/followers",
        "following_url": "https://api.github.com/users/bosshaas13131313/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bosshaas13131313/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bosshaas13131313/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bosshaas13131313/subscriptions",
        "organizations_url": "https://api.github.com/users/bosshaas13131313/orgs",
        "repos_url": "https://api.github.com/users/bosshaas13131313/repos",
        "events_url": "https://api.github.com/users/bosshaas13131313/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bosshaas13131313/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T07:23:14Z",
      "updated_at": "2025-11-27T07:23:14Z",
      "author_association": "NONE",
      "body": "No.\r\n\r\nOn Thu, Nov 27, 2025, 2:20AM Ben Westgate ***@***.***> wrote:\r\n\r\n> ***@***.**** commented on this pull request.\r\n> ------------------------------\r\n>\r\n> In bip-0093.mediawiki\r\n> <https://github.com/bitcoin/bips/pull/2040#discussion_r2567413699>:\r\n>\r\n> > +def codex32_verify_checksum(hrp, data):\r\n>      if len(data) >= 96:                      # See Long codex32 Strings\r\n> -        return ms32_verify_long_checksum(data)\r\n> +        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\r\n>      if len(data) <= 93:\r\n> -        return ms32_polymod(data) == MS32_CONST\r\n> +        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\r\n>      return False\r\n>\r\n> Needs to become now to:\r\n>\r\n> def codex32_verify_checksum(hrp, data):\r\n>     combined = bech32_hrp_expand(hrp) + data\r\n>     if len(combined) >= 96:\r\n>         return codex32_verify_long_checksum(combined)\r\n>     if len(combined) <= 93:\r\n>         return codex32_polymod(combined) == CODEX32_CONST\r\n>     return False\r\n>\r\n> Missing:\r\n>\r\n>    - the thorny zero length \"ms\" rule.\r\n>    - the check in codex32_decode() for the upper long codex32 length\r\n>    limit.\r\n>\r\n> Because of this new max length rule rule we have the curious situation\r\n> where valid \"long codex32\" strings can actually be shorter overall (and in\r\n> data part characters) than regular codex32.\r\n>\r\n> May want to rename that format any thoughts?\r\n>\r\n> Ex:\r\n> \"long\" codex32 format: 10 hrp characters + 1 + 6 header characters + 54\r\n> payload characters + 15 checksum characters = 86\r\n> codex32 format: \"ms\" hrp characters + 1 + 6 header characters + 74 payload\r\n> characters + 13 checksum characters = 96\r\n>\r\n> \r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513818681>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/BNFR33IQPDGIR4ICII5KOVT362Q2BAVCNFSM6AAAAACM4BCWD6VHI2DSMVQWIX3LMV43YUDVNRWFEZLROVSXG5CSMV3GSZLXHMZTKMJTHAYTQNRYGE>\r\n> .\r\n> You are receiving this because you are subscribed to this thread.Message\r\n> ID: ***@***.***>\r\n>\r\n",
      "user": {
        "login": "bosshaas13131313",
        "id": 189472237,
        "node_id": "U_kgDOC0sd7Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/189472237?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosshaas13131313",
        "html_url": "https://github.com/bosshaas13131313",
        "followers_url": "https://api.github.com/users/bosshaas13131313/followers",
        "following_url": "https://api.github.com/users/bosshaas13131313/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bosshaas13131313/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bosshaas13131313/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bosshaas13131313/subscriptions",
        "organizations_url": "https://api.github.com/users/bosshaas13131313/orgs",
        "repos_url": "https://api.github.com/users/bosshaas13131313/repos",
        "events_url": "https://api.github.com/users/bosshaas13131313/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bosshaas13131313/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3584502682",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "reviewed",
      "id": 3513922085,
      "node_id": "PRR_kwDOAN28mc7RcjIl",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T07:57:47Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3513922085",
      "submitted_at": "2025-11-27T07:57:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "reviewed",
      "id": 3516098737,
      "node_id": "PRR_kwDOAN28mc7Rk2ix",
      "url": null,
      "actor": null,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-27T15:41:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "This is what I have:\r\n- compatibility encoding for BIP-39, allowing to Shamir split mnemonic & extended private key wallets\r\n    * HRP: `cc`\r\n    * encodes chaincode + private key of BIP-32 master extended key (64 bytes)\r\n    * `cc10zcvjs5klr60nyt8usd553sge7r5glcy2ztwfv2d2smmcs7m3mq6dduwavccnjzjchlkffjfx8p3cjjx64q9vkxdt8q9qzuu3s8jfgjysa5pc5nezf2qkfhqpfwf`\r\n\r\n\r\nI only have one HRP, I do not differentiate between testnet/mainnet, even tho I use extended key data, I'm also using it for menmonics, where I first generate master BIP-32 key and then use those values for the codex32 secret share. DO you consider the lack of testnet/mainnet separation an issue?\r\n\r\nYour addition of HRP into checksum definitely broke my tests wrt checksum for `cc` hrp secrets  (not an issue, I haven't released yet - but I'm planning to in few weeks)\r\n\r\nMy HWW implementation is pretty much in accordance with https://github.com/BlockstreamResearch/codex32/blob/master/docs/wallets.md . My implementation is not ECW. I even provide generate support for secret share S.  I only allow to generate 128 & 256 bit MS secrets (but allow to import also 512 bit). In short:\r\n1. TRNG 256 entropy bits\r\n2. r = sha256(sha265(entropy))\r\n3. x = r[:byte_len]\r\n4. x is new master secret, and default ID is 20 MSB from master XFP (but user can change if he wishes to)\r\n\r\nWhat are the chances of this patch-set to be accepted? Is this spec stable enough to start releasing it ? ",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3516098737",
      "submitted_at": "2025-11-27T15:35:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    },
    {
      "event": "commented",
      "id": 3586533435,
      "node_id": "IC_kwDOAN28mc7Vxig7",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586533435",
      "actor": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T15:46:33Z",
      "updated_at": "2025-11-27T15:46:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "How I generate non-secret shares:\r\n1. From current loaded secret (whether it is mnemonic, xprv, or codex32)\r\n    * codex32: secret = master_seed (secret share with hrp MS)\r\n    * others: secret = chaincode + privkey (64bytes) (secret share with hrp CC)\r\n2. [BIP-85](https://github.com/bitcoin/bips/pull/1958) derive from above secret --> master secret for share 'a'\r\n3. interpolate secret share with share 'a' while changing only index (c,d,d,e,f,g,h...) to generate new shares",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586533435",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3586804792,
      "node_id": "IC_kwDOAN28mc7Vykw4",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586804792",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:56Z",
      "updated_at": "2025-11-27T17:16:48Z",
      "author_association": "CONTRIBUTOR",
      "body": ">     * HRP: `cc`\n\n\"bc\" and \"tb\" for Bech32 addresses were an upgrade in human-readable prefix from the base58 encoding.\n\nI consider it a regression if you use less characters to encode a human-readable prefix than the base58 extended key format did. \"xpriv\" is an option here.\n\n>     * encodes chaincode + private key of BIP-32 master extended key (64 bytes)\n\nDoes your format need a 65th byte for the public key that is zero when encoding private keys?\n\nThere are many advantages to the strings needing disambiguation having the same byte length.\n\n> I only have one HRP, I do not differentiate between testnet/mainnet, ... DO you consider the lack of testnet/mainnet separation an issue?\n>\n\nYes, this is a huge regression from the current bip32 extended key format we want to upgrade. Mostly that I can't tell by looking at the descriptor if it's for real funds or not.\n\n> Your addition of HRP into checksum definitely broke my tests wrt checksum for `cc` hrp secrets  (not an issue, I haven't released yet - but I'm planning to in few weeks)\n\nHRP was always in the checksum, it just was pre-computed for \"ms\" so the checksums for other HRP were wrong. I noticed when I tried to validate the CLN HSM secret examples in my python-codex32 package.\n\n\n> My implementation is not ECW.\n\n@roconnor has a PR in codex32 that does ECC you could test.\n\n>I even provide generate support for secret share S.  I only allow to generate 128 & 256 bit MS secrets (but allow to import also 512 bit).\n\nI have a codex32 PR to update wallets.md guidance for generation, you may see something useful, especially in the HWW case.\n\n\nIn short:\n> \n> 1. TRNG 256 entropy bits\n> \n> 2. r = sha256(sha265(entropy))\n> \n> 3. x = r[:byte_len]\n> \n> 4. x is new master secret, and default ID is 20 MSB from master XFP (but user can change if he wishes to)\n\n\nYou can and probably should use the entropy bits directly. If they lack entropy, sha256d is an illusion of security.\n\n> What are the chances of this patch-set to be accepted? Is this spec stable enough to start releasing it ? \n\nIt will need wider community review than us. But there's comments by P. Wuille as far back as 2020 stating a 4 error correcting bech32 encoding of extended keys is needed. So high acceptance changes once it's correct and shiney.\n\nThis spec PR will not change anything that affects your encoding of ~78 bytes or whatever an extended key has.\n\nWe're mostly debating behavior at the limit between short and long checksums. Yours unambiguously use long codex32.\n",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586804792",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21225380056,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAATxIZjY",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225380056",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:57Z"
    },
    {
      "event": "subscribed",
      "id": 21225380081,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAATxIZjx",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225380081",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:02:57Z"
    },
    {
      "event": "commented",
      "id": 3586823887,
      "node_id": "IC_kwDOAN28mc7VypbP",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586823887",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:10:34Z",
      "updated_at": "2025-11-27T17:10:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "> How I generate non-secret shares:\n\n> 2. [BIP-85](https://github.com/bitcoin/bips/pull/1958) derive from above secret --> master secret for share 'a'\n> \n> 3. interpolate secret share with share 'a' while changing only index (c,d,d,e,f,g,h...) to generate new shares\n\nIt is unsafe to child derive shares from the secret they recover. They should be independently random.\n\nWhen part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\n",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586823887",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3586929781,
      "node_id": "IC_kwDOAN28mc7VzDR1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3586929781",
      "actor": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:54:56Z",
      "updated_at": "2025-11-27T17:54:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "> HRP was always in the checksum, it just was pre-computed for \"ms\" so the checksums for other HRP were wrong. I noticed when I tried to validate the CLN HSM secret examples in my python-codex32 package.\r\n\r\nI see now...\r\n\r\n> It is unsafe to child derive shares from the secret they recover. They should be independently random.\r\n\r\nI do not want to use randomness here, as I want to split existing secret, and I require the \"split\" to be deterministic, so that if user is splitting the exact same secret, uses same hrp, same threshold, same id, and same number of shares - application always produces the exact same shares. I could add an option to to choose, if random, or deterministic split, but deterministic is a hard requirement.\r\n\r\n...also it is 5 hardened derivation steps plus hmac_sha512\r\n\r\n> When part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\r\n\r\nthere are plenty other brute-force options if attacker has part of secret, I do not consider this scenario of yours to be something I should optimize for\r\n\r\n> Yes, this is a huge regression from the current bip32 extended key format we want to upgrade. Mostly that I can't tell by looking at the descriptor if it's for real funds or not.\r\n\r\nI do not encode extended key (or full extended key), I only encode chaincode + privkey, without any other data as I just want to be able to restore naked xpriv from it, without any more meta extended keys carry. As I use it for both mnemonics and extended keys. \r\n\r\nThat is why I dismissed the idea of doing testnet/mainnet differentiation as I consider my 64bytes to be the \"secret\"",
      "user": {
        "login": "scgbckbone",
        "id": 25349625,
        "node_id": "MDQ6VXNlcjI1MzQ5NjI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25349625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scgbckbone",
        "html_url": "https://github.com/scgbckbone",
        "followers_url": "https://api.github.com/users/scgbckbone/followers",
        "following_url": "https://api.github.com/users/scgbckbone/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/scgbckbone/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/scgbckbone/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/scgbckbone/subscriptions",
        "organizations_url": "https://api.github.com/users/scgbckbone/orgs",
        "repos_url": "https://api.github.com/users/scgbckbone/repos",
        "events_url": "https://api.github.com/users/scgbckbone/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/scgbckbone/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3586929781",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587130262,
      "node_id": "IC_kwDOAN28mc7Vz0OW",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587130262",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T19:45:51Z",
      "updated_at": "2025-11-27T19:54:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > It is unsafe to child derive shares from the secret they recover. They should be independently random.\r\n> \r\n> I do not want to use randomness here, as I want to split existing secret, and I require the \"split\" to be deterministic, so that if user is splitting the exact same secret, uses same hrp, same threshold, same id, and same number of shares - application always produces the exact same shares. I could add an option to to choose, if random, or deterministic split, but deterministic is a hard requirement.\r\n\r\nThe best you could do here if you insist, is perform a KDF on the secret data to harden it before deriving child shares from that derived key. But it still reduces security from information theoretic to computational.\r\n\r\n> ...also it is 5 hardened derivation steps plus hmac_sha512\r\n\r\nStill significantly faster than address checking. The EC mult is the bottleneck for address checking is what Andrew told me.\r\n\r\n> > When part of the secret is compromised and an attacker tries to brute force the rest: the dependent relation between the secret and share A allows an attacker with k-1 shares or share A to check his guesses against this. This is far faster than checking an address.\r\n> \r\n> there are plenty other brute-force options if attacker has part of secret, I do not consider this scenario of yours to be something I should optimize for\r\n\r\nMy point is your standard should be harder to exploit than all other options or we lose security for nothing. Simply deriving child shares from an argon2id or scrypt derived key is probably enough protection.\r\n\r\n> That is why I dismissed the idea of doing testnet/mainnet differentiation as I consider my 64bytes to be the \"secret\"\r\n\r\nIt seems better to encode the recovery words and wordlist with a `bip39_12w` or `bip39_24w` human-readable part encoding standard than encode the resulting private key and chaincode bytes. A full bip32 codex32 encoding standard would be more useful than a neutered master xprv only edition.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587130262",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587315890,
      "node_id": "IC_kwDOAN28mc7V0hiy",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587315890",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T21:30:39Z",
      "updated_at": "2025-11-30T17:07:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "This table shows the undetectable errors, each row has 2-3 characters which cannot be distinguished since they differ only in the upper bits.\r\n<img width=\"324\" height=\"565\" alt=\"image\" src=\"https://github.com/user-attachments/assets/20ec9cdd-c65a-4b6c-aed9-9b7ef3825033\" />\r\n\nI found an 83 character Bech32 HRP with 3 substitutions that validates. In theory, some long HRP won't detect even 1-2 errors affecting high bits. We inherit this problem if we copy Bech32 max length rules.\n\nThe worse case is: a secret is transcribed wrong or damaged, user or heirs, application is forgotten, it validates or corrects to a different application and then is transmitted.\n\nThis is worse than a wrong HRP address validating.\n\nWe should guarantee to correct 2 HRP errors by covering the expanded characters. Now any wrong 2 character HRP for every seed length reveals it is \"ms\" secret data. For the more common errors affecting only the low (or high) bits two errors from the data can also be corrected.\n\nSo the correct 4 errors guarantee holds under the assumption the HRP errors affect only low (or high) bits. Same assumption as Bech32's detection guarantee, and it's a detection only standard. We store secrets so we need correction guarantees and this is how we get them.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587315890",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3587393796,
      "node_id": "IC_kwDOAN28mc7V00kE",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3587393796",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T22:08:19Z",
      "updated_at": "2025-11-27T22:08:19Z",
      "author_association": "NONE",
      "body": "I'm this close to throwing in the towel.  BIP-93's design was never intended to be generalized to arbitrary HRP, and it shows.  If people want to reuse our polynomial for their own schemes, then more power to them.  They can make their own BIP.",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3587393796",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3617849434,
      "node_id": "IC_kwDOAN28mc7XpABa",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3617849434",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-05T17:37:55Z",
      "updated_at": "2025-12-05T17:37:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sorry for being late to the party. I have read through this whole discussion except for the digression about deterministic share derivation and except for Russell's detailed code. As I understand it there are a few issues at play:\r\n\r\n* Ben wants the HRP to be covered by the checksum, which has multiple problems\r\n   * if you don't know the HRP you arguably don't know the checksum so how can you correct it?\r\n   * but conversely Ben points out that we likely want `xpub`/`xprv` HRPs which are easy to mess up and would share a checksum\r\n   * each HRP character contributes two characters to the checksum plus an extra \"separator\" character so length n takes away 2n+1 from your total length, which is surprising and weird\r\n   * (There was a long discussion about restricting the character set of HRPs. As you have observed, I've already violated this with my `bip32_24w` HRPs. I'm skeptical this matters. If there is anybody except me doing this, they would have needed to do a comparable amount of insane off-spec work to accomplish it and \"protecting them\" by extending the spec to include them should not be a priority.)\r\n* How do we determine the threshold at which to switch to \"long codex32\" which is a totally different checksum\r\n   * Ben would like there to only be a few allowable lengths of long codex32 strings, which I directionally agree with, but I also note that I have violated this (I have 264-bit strings which are converted directly from BIP39 seed words).\r\n* Some discussion on what the allowable HRPs should be. BIP-173 allows any ASCII string up to 83 characters.\r\n   *  ...but if you look at the registered list of BIP-173 prefixes, despite there being some pretty crazy crap in there, every single prefix is less than 12 characters, and except for one using `:` and one using `@` every single one is alphanumeric\r\n   * Ben initially proposed restricting the set of characters to ones that all have distinct low bits so that we could \"ignore the high bits\". But as seen in his above table, this is impossible if we allow both numbers and letters.\r\n\r\n**In the interest of moving forward I would kinda like Ben to make a new PR with the non-HRP changes, which it seems like everyone agrees with and would reduce the size of the diff of this one.**\r\n\r\nThen my opinions on the above:\r\n\r\nI agree with Russell that in general we should not attempt to correct the HRP. This was outside of the design space for our codex32 SSSS application and among other things we (ab)used this fact to distinguish codex32 from long codex32 on length alone and not HRP. Having said this, if Ben wants to try to error-correct HRPs all the power to him and we should take some effort to avoid undermining that goal.\r\n\r\nSo for *this BIP* we should say:\r\n\r\n* Users can register their own HRPs at [link] but they are only allowed to use ASCII 96 to 126, and their length can be at most 8, say. (These are the tightest restrictions I would support, and I'd also accept any looser ones up to the \"83 ascii characters free for all\" of BIP 173.) This gives us `{` `|` `}` and `~` as well as letters. People who want a separator should be happy to use `~`.\r\n* The HRP defines the checksum and SHOULD NOT be error-corrected, *unless* there is a separate specification describing how to do this. `xpub`/`xprv` I think needs to have its own BIP for this. Maybe there could be a general-purpose \"bip93 with HRP correction\" BIP that covers questions like \"what if the user has a character outside of the allowable set\" or \"should we preferentially try to correct `_` and `-` to `~` or just try random things\" or \"should we have a fixed set of supported HRPs and just try all of these\". It seems that different answers make sense in different contexts.\r\n* I'm happy with whatever length threshold we want for switching between codex32 and long codex32. I think \"93 - length of HRP\" is fine, along with an exception for `ms`. We should specify the maximum length in the table of registered HRPs so people don't have to know the formula if they don't want to.\r\n\r\nI think this should make everyone happy, except that it leaves HRP correction underspecified and delegated to another future BIP. (I would also be open to bringing more text into BIP 93 itself, but let's try to accomplish the above before we do that.)",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3617849434",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3656841473,
      "node_id": "IC_kwDOAN28mc7Z9vkB",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3656841473",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T17:37:34Z",
      "updated_at": "2025-12-15T17:37:34Z",
      "author_association": "MEMBER",
      "body": "@BenWestgate Do you plan to update here following the merge of #2052?",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3656841473",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21572770058,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAAUF1lkK",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21572770058",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T17:37:36Z"
    },
    {
      "event": "subscribed",
      "id": 21572770096,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAAUF1lkw",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21572770096",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T17:37:36Z"
    },
    {
      "event": "commented",
      "id": 3657230206,
      "node_id": "IC_kwDOAN28mc7Z_Od-",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3657230206",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T19:24:45Z",
      "updated_at": "2025-12-15T19:24:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "> * How do we determine the threshold at which to switch to \"long codex32\" which is a totally different checksum\n\nIt's best for this to depend only on length. Consistent with BIP-0173. \n\nThe \"ms\" exception for 93 data characters we can either:\n- deprecate (let it decode but future `len(hrp) + len(data) > 80` characters encodings will use long codex32\n- count \"ms\" as zero characters so nothing changes\n\n> * Some discussion on what the allowable HRPs should be.\n\nPrefer keeping what BIP-0173 allows to avoid redefinition.\n\n>    * Ben initially proposed restricting the set of characters to ones that all have distinct low bits so that we could \"ignore the high bits\". But as seen in his above table, this is impossible if we allow both numbers and letters.\n\nNot quite, I propose to restrict the _registry_ so that every hrp in it has unique low bits from every other registered hrp.\n\nAllow every US-ASCII character but applications should not register an hrp that is only unique in the high bits as it might be mistaken for another.\n\nI think this maintains 8 character error detection guarantees as the low bits are always covered and unique among valid hrp.\n\n\n> **...I would like Ben to make a new PR... [to] reduce the size of the diff of this one.**\n\nDone and merged.\n\n> Then my opinions on the above:\n> \n> I agree with Russell that in general we should not attempt to correct the HRP.\n\nI agree. Error detection guarantees on it are enough to avoid disasters when honest software detects data it should not have been given.\n\n> So for *this BIP* we should say:\n\n> * The HRP defines the checksum and SHOULD NOT be error-corrected, *unless* there is a separate specification describing how to do this.\n\nCorrection should try all registered hrp if rebroadcast is not an option. Assume the fewest edits is the valid hrp. According to the edit distance formula in wallets.md\n\n>`xpub`/`xprv` I think needs to have its own BIP for this.\n\nAgreed. Someone may have volunteered to do this.\n\n> * I'm happy with whatever length threshold we want for switching between codex32 and long codex32. I think \"93 - length of HRP\" is fine, along with an exception for `ms`.\n\nAgree. `93-len(hrp)` is simplest. Is that \"ms\" rule a verify exception (deprecate) or create and verify exception?\n\n>specify the maximum length in the table of registered HRPs so people don't have to know the formula if they don't want to.\n\nUnsure why string length for a given payload size and hrp belongs in the registry.\n\n> except that it leaves HRP correction underspecified and delegated to another future BIP.\n\nI think that's fine, correction is application specific. Or at very least rules for: public/private/secret and always/sometimes/never retransmissable data. That's up to 9 hrp types and then correction guidance may include contexts expecting combinations of multiple of these.\n\nI just don't think it can or should all be said here. Just enough to avoid disasters such *IF* hrp correction is attempted the least edits should be assumed as the correct hrp. And in applications that transmit data, probably MUST.\n\n>(I would also be open to bringing more text into BIP 93 itself, but let's try to accomplish the above before we do that.)\n\nAgreed. Safety guidance only here\n\n",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3657230206",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3657263294,
      "node_id": "IC_kwDOAN28mc7Z_Wi-",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3657263294",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T19:32:28Z",
      "updated_at": "2025-12-15T19:32:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "> @BenWestgate Do you plan to update here following the merge of #2052?\n\nYea. Enough consensus has formed to do another commit incorporating it this week.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3657263294",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "mentioned",
      "id": 21575011585,
      "node_id": "MEE_lADOAN28mc7ZzDLFzwAAAAUF-I0B",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21575011585",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T19:32:29Z"
    },
    {
      "event": "subscribed",
      "id": 21575011603,
      "node_id": "SE_lADOAN28mc7ZzDLFzwAAAAUF-I0T",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21575011603",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T19:32:29Z"
    },
    {
      "event": "commented",
      "id": 3657298497,
      "node_id": "IC_kwDOAN28mc7Z_fJB",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3657298497",
      "actor": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T19:40:08Z",
      "updated_at": "2025-12-15T19:40:08Z",
      "author_association": "NONE",
      "body": "If it is helpful we could start with an intermediate amendment to BIP-93 seed sizes to only allow between 128 and 256 bit seeds (specifically 16 to 32  byte seeds) for short codex 32 strings, and only allow exactly 512 bit secrets for long codex32 strings.  This would eliminate the 95 and 96 character special exceptions we are worried about.  I think we all agree we want to restrict the valid size values to some subset of these values anyways, and there is only a small debate on how far we ought to go.\r\n\r\nE.g. I would also not oppose going as far as restricting seed sizes to be of 128, 160, 192, 224, and 256, which are the entropy sizes listed in BIP-39.  (And also keeping 512 bit long codex32 for compatibility with BIP-39 generated master seeds).\r\n\r\nMy only hesitation is that I know some folks want to restrict this list even further, and it would be somewhat annoying to make \"breaking changes\" twice.  I use the word \"breaking changes\" loosely since, in practice people are using 128, 256 and 512 bit entropy sizes.\r\n",
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3657298497",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "commented",
      "id": 3658963700,
      "node_id": "IC_kwDOAN28mc7aF1r0",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3658963700",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-16T05:56:08Z",
      "updated_at": "2025-12-16T05:56:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "I found this reply in my browser cache:\r\n\r\n> if you don't know the HRP you arguably don't know the checksum so how can you correct it?\r\n\r\nBech32/Bech32m checksum:\r\n\r\n- length 90 or less\r\n- 1st value is 0-16\r\n- The seventh-from-last character has zero padding\r\n- implementations SHOULD NOT implement correction...\r\n\r\nCodex32 checksum:\r\n- length 94 or less or 97 or more\r\n- Data starts with digit\r\n  - If \"0\", 6th character is \"s\"\r\n- 14/16th (short/long) from last character may have a 1 in its padding\r\n- MAY implement correction...\r\n  \r\nOnly threshold 9, 8, 2, and 0 are valid segwit `data[0]` and 0 has  \"s\" ruling 31:1 in codex32 favor.\r\n61.25% of random 7th from last characters will have a 1 in their padding. 1 in 10^9 the Bech32 checksum validates\r\n\r\nAny attempt at suggesting HRP corrections should assume codex32 after checking it's invalid:\r\n- Bech32/Bech32m\r\n- Base58Check\r\n- Hex encoded public key\r\n\r\nThen only suggest HRP from the registry.\r\n\r\n> If it is helpful we could start with an intermediate amendment to BIP-93 seed sizes to only allow between 128 and 256 bit seeds (specifically 16 to 32 byte seeds) for short codex 32 strings, and only allow exactly 512 bit secrets for long codex32 strings.\r\n\r\nIt is very helpful to lose the \"ms\" exceptions.\r\n\r\nWallets.md says:\r\n> MAY attempt correction by deleting and/or inserting characters, as long as the resulting string has a valid length for a codex32 string. **ECWs MAY assume the correct length is the closest of 48 or 74.**\r\n\r\nMeaning other lengths may not get insert/delete correction. If that's fine, 16..32 for regular and 64 for long looks great.\r\n\r\nWe can safely amend that to \"48, 61, or 74.\" As the maximum and minimum correctable lengths of each do not overlap.\r\n\r\nThese rules fit perfectly in the new \"Master seed format\" section as it's no issue if other HRP use weird lengths if they follow the total length rule.\r\n\r\n>I think we all agree we want to restrict the valid size values to some subset of these values anyways, and there is only a small debate on how far we ought to go.\r\n\r\nIf it's ready to test again, https://github.com/BlockstreamResearch/codex32/pull/70 could give objective data how much performance or accuracy insert/delete correction loses when it checks every length or lengths other than 48, 61, or 74.\r\n \r\n> E.g. I would also not oppose going as far as restricting seed sizes to be of 128, 160, 192, 224, and 256, which are the entropy sizes listed in BIP-39. (And also keeping 512 bit long codex32 for compatibility with BIP-39 generated master seeds).\r\n\r\nThis is fine for now. The more lengths an insert/delete ECW must consider as candidates the slower and less accurate it will be. Having two lengths in correction range is like losing 1-bit of checksum.\r\n \r\n> My only hesitation is that I know some folks want to restrict this list even further, and it would be somewhat annoying to make \"breaking changes\" twice. I use the word \"breaking changes\" loosely since, in practice people are using 128, 256 and 512 bit entropy sizes.\r\n\r\nShould I test practical insert/delete correction with your haskell impl to see if 160 and 224 significantly hurt it?  If there was a significant regression would that sway the opinion? If not, only 128, 160, 192, 224, and 256 has consensus.\r\n\r\nP.S.: I checked the characters for descriptor key origin data and if that was prepended in the HRP of xpub/tpub it maintains the \"low bits always unique\" hrp registry rule which is a nice omen.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#issuecomment-3658963700",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2040"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDhlNDI1NjgwN2Q4MWRkZTU1MzFkYzk1OTM2NjdjODY3MDAwNTBkZmM",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/8e4256807d81dde5531dc9593667c86700050dfc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/8e4256807d81dde5531dc9593667c86700050dfc",
      "tree": {
        "sha": "b2c5af8d18858ff5f3f25fd69b275bd7f0ed022a",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/b2c5af8d18858ff5f3f25fd69b275bd7f0ed022a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b2c5af8d18858ff5f3f25fd69b275bd7f0ed022a\nparent 3123cead1d0d92edbc9e3e89814bd57ee1d1467d\nparent 1e663c21500979451c97da390ddd3052866af101\nauthor Ben Westgate <BenWestgate@protonmail.com> 1765872708 -0600\ncommitter GitHub <noreply@github.com> 1765872708 -0600\n\nMerge branch 'master' into bip93-fix-threshold",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJpQRRECRC1aQ7uu5UhlAAAuG4QADjYT0bx2kzhI+jOsol9b1mW\n1h5CpGH0L3CjtrK6Rk8DcGg4WJPEcEnWoEAgxkx0Wx5hgA7rOoz7T5pIj54xZUGm\nyaQ/+cygNrSjFqnmiUQ4Si5Z2oBrG/R2HIV/i3weLYk2CF4HLrOtX9Lz3up1m44I\nUfxriasinpHw651Oi71+XpB+nCf1pHnH+kqlPNCQlXaXljUhLq5ld/2KRlH7jKq3\nfRh6ljAXeigIFedbuOOsxatYSi7sPDgWBbh/TByf3RR3lq+1Tnb1KHtrohO2ZFLS\nvnTw3ylm8I6xj+iFyYT4xAKemZ2r7bHfW7bvFY1RYjT6CcHgYipVCBEhnhvdslle\nUbLvcrONjba9VMtCMm3LUBxhXGZRpkUbgeiOGDsJGd/IyGQu/r/G2SQUvoU466Q2\nLJsPPWcVmz/M5m3JYcQOMfp4qZHzb2oY7cJCu7FNulTYNqdBcIeEBmg8pHuAuKU4\n+cxwPToOvvcdhqDtcwVO7XRvSdeQWi2yOGKiT50NSuGpT5hv3nn6k+KVzKOPvD4K\nYpQ22Yaqyw5M+eYqc8Lu9cBOEMSq3RlkNtSKAHfYFj311mfCD8jgoT8RCIZrOwQg\nY2FNvgj2nU8tmB2RrfrwIPK2yG8J1FX37IGhoHjS2HpswjhDliyVJQE7yRQM5yBx\ngYFUJ5BJ/ttRiZChWlFZ\n=3e7x\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
          "sha": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
          "html_url": "https://github.com/bitcoin/bips/commit/3123cead1d0d92edbc9e3e89814bd57ee1d1467d"
        },
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/1e663c21500979451c97da390ddd3052866af101",
          "sha": "1e663c21500979451c97da390ddd3052866af101",
          "html_url": "https://github.com/bitcoin/bips/commit/1e663c21500979451c97da390ddd3052866af101"
        }
      ],
      "message": "Merge branch 'master' into bip93-fix-threshold",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-12-16T08:11:48Z"
      },
      "author": {
        "name": "Ben Westgate",
        "email": "BenWestgate@protonmail.com",
        "date": "2025-12-16T08:11:48Z"
      },
      "sha": "8e4256807d81dde5531dc9593667c86700050dfc"
    },
    {
      "event": "reviewed",
      "id": 3523108086,
      "node_id": "PRR_kwDOAN28mc7R_lz2",
      "url": null,
      "actor": null,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-16T09:20:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "Covers some major decisions, areas I need feedback and flagged obvious mistakes to fix.",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2040#pullrequestreview-3523108086",
      "submitted_at": "2025-12-16T09:20:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557120796",
      "pull_request_review_id": 3501457605,
      "id": 2557120796,
      "node_id": "PRRC_kwDOAN28mc6YapEc",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The lengths limitations of the codex32 strings are working under the assumption that the HRP is *not* subject to error correction.  We more or less cannot do that anyways as all sorts of various bech32 formats have appeared all with different checksums and characteristics.  In order to run the checksum algorithm you have to know the prefix first in order to know which checksum algorithm to try.\r\n\r\nThis isn't really a problem in practice since there are only a small finite number of prefixes, and from context only a few are going to be applicable anyways. ",
      "created_at": "2025-11-24T17:18:26Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557120796",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557120796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557141517",
      "pull_request_review_id": 3501457605,
      "id": 2557141517,
      "node_id": "PRRC_kwDOAN28mc6YauIN",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't really want this CRC stuff in the standard.  At most it is a recommendation that folks *MAY* use to select padding bits. but I doubt it will be useful in practice since you cannot know if any given codex32 master seed was generated with this CRC or with random padding as the codex32 book does. If one's seed is so corrupted that the codex32 error correction wasn't able to fix it, I'm skeptical a few more bits will help.\r\n\r\nIf it is include than padding *MAY* be random should also be stated.  Perhaps it is better to move this to a separate PR if we want to further discuss it.",
      "created_at": "2025-11-24T17:25:25Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557141517",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557141517"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557144592",
      "pull_request_review_id": 3501457605,
      "id": 2557144592,
      "node_id": "PRRC_kwDOAN28mc6Yau4Q",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 81,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If you want an hrp parameter, you have to rename this function to something like `codex32_verify_checksum`.",
      "created_at": "2025-11-24T17:26:36Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557144592",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557144592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557146292",
      "pull_request_review_id": 3501457605,
      "id": 2557146292,
      "node_id": "PRRC_kwDOAN28mc6YavS0",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This doesn't make sense.  The lowercase form and uppercase form of Bech32 characters have the same value.",
      "created_at": "2025-11-24T17:27:13Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557146292",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557146292"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557171793",
      "pull_request_review_id": 3501457605,
      "id": 2557171793,
      "node_id": "PRRC_kwDOAN28mc6Ya1hR",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd be included to remove this uncheckedsummed string.  I'm really nervous displaying strings without a checksum anywhere.  They are very problematic.\r\n\r\nIf you insist on going into this much detail in this test vector I'd say use the following bullets\r\n\r\n- Master seed (hex):\r\n- master node xprv\r\n- Payload\r\n- HRP\r\n- Identifier\r\n- Checksum\r\n- Secret seed\r\n\r\nThat's the order I'd use, but maybe some other permutations are also good.",
      "created_at": "2025-11-24T17:36:47Z",
      "updated_at": "2025-11-24T17:41:35Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557171793",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557171793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557214387",
      "pull_request_review_id": 3501578813,
      "id": 2557214387,
      "node_id": "PRRC_kwDOAN28mc6Ya_6z",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 272,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "When some shares of a master seed are compromised, a user may wish to simply dispose of remaining shares and rederive a new set of secret shares without the cost of sweeping their wallet.  In such a case a user very much should use a fresh identifier so that they do not get mix up their obsolete share data with their fresh shares.\r\n\r\nAt best a hardware wallet may suggest such an identifier, but only when the hardware wallet is generating a fresh master seed and thus knows that there are no other secret shares for the same secret floating around.\r\n\r\nAgain, maybe put this recommendation into a separate PR, perhaps including more details and test vectors.",
      "created_at": "2025-11-24T17:53:09Z",
      "updated_at": "2025-11-24T17:53:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2557214387",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2557214387"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 334,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558171315",
      "pull_request_review_id": 3502800360,
      "id": 2558171315,
      "node_id": "PRRC_kwDOAN28mc6Yepiz",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This was copied over from BIP-00173. Delete it?\r\n\r\nBech32 attempts to decode two checksums, a universal bech32 decoder could try decoding the string with the bech32, bech32m and codex32 checksums to discover the format.\r\nUnless covering the HRP exceeds the max length at HD=9, 2 subsitutions in the HRP will always be detected by every format.\r\n\r\nIf HRP is swapped between formats the chances of false verification is:\r\n\r\n- 1 in 2^65  for a \"codex32 checksum\" validating when the encoding was Bech32/Bech32m \r\n\r\n- ~1 in 2^30 for  \"Bech32 checksum\" validating when the encoding was Codex32.",
      "created_at": "2025-11-25T01:03:01Z",
      "updated_at": "2025-11-25T01:03:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558171315",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558171315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558482066",
      "pull_request_review_id": 3503186164,
      "id": 2558482066,
      "node_id": "PRRC_kwDOAN28mc6Yf1aS",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'll replace it with one sentence for now:\r\n\r\n> Encoders MAY select padding using a CRC-`w` where: `w = pad_bits_needed`, `poly = 1 << w | 3`, `init = 1`, `const = 1 << w - 1`, `refIn = false`, and `refOut = false`.\r\n\r\nCRC-4 helps 32-byte seeds detect 94% of 1 character errors/deletions and narrows 1 erasure down to 2 candidates. The most common substitutions in CHARSET are 1 bit apart so actual performance will exceed that.\r\n\r\n> since you cannot know if any given codex32 master seed was generated with this CRC or with random padding\r\n\r\nFinding the book is reasonable suspicion for random padding IF all electronically encoded seeds use CRC. The person who made the backup certainly knows if they encoded with the book or not.\r\n\r\n>  as the codex32 book does\r\n\r\nA book insert could compute CRCs by hand, but I have not divided a large enough number to benchmark time for 128-bits, Andrew and I determined the space requirement is two pieces of 11 x 8.5 graph paper.\r\n\r\n> If it is include than padding MAY be random should also be stated.\r\n\r\nDecoders, MUST accept random padding, although they may someday warn on it.\r\n\r\nFor electronic encoders, trusting RNGs introduces risk: it can leak up to 32 bits to an attacker with 8 shares and breaks decode->encode round-trip. Using zero padding round-trips but leaks the final payload character to an attacker with `(5-pad_len) / pad_len` interpolated shares.\r\n\r\nCRC pad minimizes RNG trust by using entropy already present in the payload bytes.\r\n\r\n>  Perhaps it is better to move this to a separate PR if we want to further discuss it.\r\n\r\nLets discuss on my deterministic [codex32 BIP85 PR](https://github.com/BenWestgate/bips/blob/a8f8e98d05a2183aba395f8f8ff479b4fb764f95/bip-0085.mediawiki?plain=1#L306) where it's required since reviewers asked me to directly encode bytes not u5 ints even for share payloads.",
      "created_at": "2025-11-25T04:08:33Z",
      "updated_at": "2025-11-25T04:08:33Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558482066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558482066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558488530",
      "pull_request_review_id": 3503194126,
      "id": 2558488530,
      "node_id": "PRRC_kwDOAN28mc6Yf2_S",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not for HRP which needs to be lower cased during decoding or `bech32_hrp_expand(hrp)` would return a different result.\r\n\r\nThis line is repeated from the test vectors, why explain the rules about case in the vectors instead of up here?",
      "created_at": "2025-11-25T04:13:55Z",
      "updated_at": "2025-11-25T04:13:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558488530",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558488530"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558507125",
      "pull_request_review_id": 3503218818,
      "id": 2558507125,
      "node_id": "PRRC_kwDOAN28mc6Yf7h1",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "How about since the text said:\n\n> This example shows generating a new 512-bit master seed using \"random\" codex32 characters and appending a checksum.\n\nhuman-readable part: <code>MS</code>\nk value: <code>0</code>\nidentifier: <code>0C8V</code>\nshare index: <code>S</code>\npayload: <code>M32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>\n\n* checksum: <code>HPV80UNDVARHRAK</code>\n* secret seed: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n* Master seed (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n* master node xprv: <code>xprv9s21ZrQH143K4UYT4rP3TZVKKbmRVmfRqTx9mG2xCy2JYipZbkLV8rwvBXsUbEv9KQiUD7oED1Wyi9evZzUn2rqK9skRgPkNaAzyw3YrpJN</code>\n\n\nNo information is displayed we did not already in Vector 1.",
      "created_at": "2025-11-25T04:27:43Z",
      "updated_at": "2025-11-25T04:27:43Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558507125",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558507125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558509494",
      "pull_request_review_id": 3503223709,
      "id": 2558509494,
      "node_id": "PRRC_kwDOAN28mc6Yf8G2",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 81,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557144592,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Will do",
      "created_at": "2025-11-25T04:29:20Z",
      "updated_at": "2025-11-25T04:29:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558509494",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558509494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558680888",
      "pull_request_review_id": 3503422421,
      "id": 2558680888,
      "node_id": "PRRC_kwDOAN28mc6Ygl84",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 272,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557214387,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is a good case for BIP85 derive codex32 application to avoid trusting or generating randomness for this.\n\nIf we want a default identifier for \"reshares\" too:\n\n```python\nidentifier = fingerprint(master_seed)[:2] + fingerprint(false_seed)[2:4]\n```\nWhere `false_seed` is recovered from _fresh_ initial shares (reducing `k` if needed).\n\nDuring the first generation with k fresh shares; the two slices together produce the full fingerprint. If the identifier is unspecified, recommend this default for master seeds. Or if that collides, the next higher.\n\n> Again, maybe put this recommendation into a separate PR, perhaps including more details and test vectors.\n\nAlready done here. Agreed wrt details and vectors.\n\nhttps://github.com/BenWestgate/bips/blob/a8f8e98d05a2183aba395f8f8ff479b4fb764f95/bip-0085.mediawiki#unshared-secret\n\nhttps://github.com/bitcoin/bips/pull/1958\n\nI can move this recommendation (and the padding rec) into a separate BIP93 PR pending the final BIP85 codex32 design (needs finishing touches feedback). Ill remove it from this PR so it remains focused on typos and general HRP support.",
      "created_at": "2025-11-25T06:19:02Z",
      "updated_at": "2025-11-25T06:19:02Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2558680888",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2558680888"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 334,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560673322",
      "pull_request_review_id": 3505931854,
      "id": 2560673322,
      "node_id": "PRRC_kwDOAN28mc6YoMYq",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This text was certainly the design goal of BIP-173, but we are not using their checksum, and we haven't realized this part of their design in codex32 in part because our 13 character checksum unfortunately works only on relatively short strings.\r\n\r\nInstead we process this HRP in this way because that is what BIP-173 does, and we still want the HRP to change the residue to catch random errors, so me might as well do it in the standard way.\r\n\r\n> Unless covering the HRP exceeds the max length at HD=9, 2 subsitutions in the HRP will always be detected by every format.\r\n\r\nThe problem is that our particular 13 character checksum's max length for its error detection and correction properties is limited to 93 bech32 characters.  That's why our payload is limited to 74 characters add in 13 character checksum and 6 characters for the header and we get 93 bech32 characters, with nothing left over to detect or correct errors in the HRP.  Yes, in cases where the payload is 72 characters or less, our error correction / detection properties extend to the low 5 bits of the ascii characters of a 2 character prefix, but that doesn't apply to 73 or 74 character payloads.\r\n\r\nI don't know if we really want to get into these subtleties.  I'm not even sure correcting and detecting errors in the HRP is useful to begin.  If you are a hardware wallet expecting a master seed and someone gives you a \"cl\" codex32 string, you don't need a fancy error correction algorithm to detect the \"cl\" prefix is wrong; if it is a expecting a master seed then the \"cl\" prefix must be wrong.",
      "created_at": "2025-11-25T16:35:00Z",
      "updated_at": "2025-11-25T16:35:00Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560673322",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560673322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560684327",
      "pull_request_review_id": 3505944357,
      "id": 2560684327,
      "node_id": "PRRC_kwDOAN28mc6YoPEn",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I guess we should reword this to make it more clear that the relevance is for the HRP.",
      "created_at": "2025-11-25T16:38:15Z",
      "updated_at": "2025-11-25T16:38:15Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560684327",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560684327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560692274",
      "pull_request_review_id": 3505953733,
      "id": 2560692274,
      "node_id": "PRRC_kwDOAN28mc6YoRAy",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That would be better.",
      "created_at": "2025-11-25T16:40:45Z",
      "updated_at": "2025-11-25T16:40:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560692274",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560692274"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560697846",
      "pull_request_review_id": 3505961549,
      "id": 2560697846,
      "node_id": "PRRC_kwDOAN28mc6YoSX2",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd still rather this be in a separate PR and in a separate section on recommendations for determinisitic generation. ",
      "created_at": "2025-11-25T16:42:28Z",
      "updated_at": "2025-11-25T16:42:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560697846",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560697846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560739047",
      "pull_request_review_id": 3506008594,
      "id": 2560739047,
      "node_id": "PRRC_kwDOAN28mc6Yocbn",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should it be a PR to this BIP93 document or to [BlockstreamResearch/codex32 wallets.md](https://github.com/BlockstreamResearch/codex32/blob/master/docs/wallets.md.)?",
      "created_at": "2025-11-25T16:53:18Z",
      "updated_at": "2025-11-25T16:53:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560739047",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560739047"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560819822",
      "pull_request_review_id": 3506101757,
      "id": 2560819822,
      "node_id": "PRRC_kwDOAN28mc6YowJu",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I will delete the footmark and say:\r\n\"The human-readable part is processed as per BIP-0173.\"\r\n\r\nI updated the rationale accordingly:\r\n\r\nAt this length, the human-readable part is not covered by the checksum. This is acceptable because the checksum scheme itself requires you to know that a valid human-readable part is being used in the first place. If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected prefix. \r\n\r\n\r\n>  I'm not even sure correcting and detecting errors in the HRP is useful to begin\r\n\r\nwallets.md import guidance prefills the prefix in applications expecting only one to prevent mistakes.\r\n\r\nA future application for extended keys (Is long codex32 HD=9 for 74 bytes?) has a situation where decoders need to accept both \"xprv\" and \"xpub\" HRPs in the same descriptor. So here it is absolutely useful to detect and correct errors in the HRP.\r\n\r\nHowever we should not go into details about that until such an application needing to disambiguate different HRP actually exists.",
      "created_at": "2025-11-25T17:18:48Z",
      "updated_at": "2025-12-16T08:40:04Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560819822",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560819822"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560933020",
      "pull_request_review_id": 3506238948,
      "id": 2560933020,
      "node_id": "PRRC_kwDOAN28mc6YpLyc",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What does HD=9 mean?",
      "created_at": "2025-11-25T17:59:05Z",
      "updated_at": "2025-11-25T17:59:06Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560933020",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560933020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560949487",
      "pull_request_review_id": 3506260389,
      "id": 2560949487,
      "node_id": "PRRC_kwDOAN28mc6YpPzv",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hamming distance 9, able to detect 8 substitution errors. (and correct 4)",
      "created_at": "2025-11-25T18:05:55Z",
      "updated_at": "2025-11-25T18:05:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560949487",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560949487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560995482",
      "pull_request_review_id": 3506316041,
      "id": 2560995482,
      "node_id": "PRRC_kwDOAN28mc6YpbCa",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@roconnor why do we have spec notes in the test vectors?\n\nThis was what I was trying to make unnecessary with the earlier sentence about case and checksum.",
      "created_at": "2025-11-25T18:24:47Z",
      "updated_at": "2025-11-25T18:24:47Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2560995482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560995482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561016116",
      "pull_request_review_id": 3506340908,
      "id": 2561016116,
      "node_id": "PRRC_kwDOAN28mc6YpgE0",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah the 15 character checksum has HD=9 up to a maximum length 1023, supports data up to 1008 = (1023 - 15) characters  and a payload of 1002 (=1008 - 6 header characters) bech32 characters.  If you want to cover the HRP you lose payload capacity.",
      "created_at": "2025-11-25T18:32:25Z",
      "updated_at": "2025-11-25T18:32:25Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561016116",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561016116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561023486",
      "pull_request_review_id": 3506351186,
      "id": 2561023486,
      "node_id": "PRRC_kwDOAN28mc6Yph3-",
      "diff_hunk": "@@ -294,11 +316,56 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 characters.\n \n-Generation of long shares and recovery of the master seed from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We recommend the first 4 characters of the bech32-encoded BIP-0032 key fingerprint.\n+** The share index, which is \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+\n+When padding bits are needed they should be generated using CRC polynomial <code>(1 << pad_len) | 3</code> with an initial value of <code>0</code> and appended to the master seed bits. Note that unlike the codex32 checksums, we do NOT include the header data.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 279,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557141517,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe hammering out the details at codex32_wallets.md makes the most sense.  Then we can decide if we want to include it in BIP-93, or maybe just make a reference to the codex32_wallets.md.",
      "created_at": "2025-11-25T18:35:01Z",
      "updated_at": "2025-11-25T18:35:02Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561023486",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561023486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561044105",
      "pull_request_review_id": 3506378123,
      "id": 2561044105,
      "node_id": "PRRC_kwDOAN28mc6Ypm6J",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.\n In particular, given an all uppercase codex32 string, we still use lowercase <code>ms</code> as the human-readable part during checksum construction.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 339,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If I add this to spec:\n\"When constructing or verifying a checksum, the human-readable part MUST be interpreted in lowercase, as specified in BIP-0173.\"\n\nThen we can remove this.",
      "created_at": "2025-11-25T18:42:56Z",
      "updated_at": "2025-11-25T18:42:56Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561044105",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561044105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 484,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 485,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561048264",
      "pull_request_review_id": 3506383476,
      "id": 2561048264,
      "node_id": "PRRC_kwDOAN28mc6Ypn7I",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2560995482,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't know. Before we were using a fixed constant for the \"ms\" prefix, so this text wasn't really necessary.  Now that we want to support more general HRPs, I agree that we need some wording like this somewhere.",
      "created_at": "2025-11-25T18:44:27Z",
      "updated_at": "2025-11-25T18:44:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561048264",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561048264"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561073066",
      "pull_request_review_id": 3506415756,
      "id": 2561073066,
      "node_id": "PRRC_kwDOAN28mc6Ypt-q",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Plenty of room to long codex32 encode extended keys with covered human-readable parts \"xpub\", \"xprv\", \"tprv\" and \"tpub\" someday.  They're horrible to handle and type in base58. Is this something we should think about in a separate PR?",
      "created_at": "2025-11-25T18:54:08Z",
      "updated_at": "2025-12-01T06:26:29Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561073066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561073066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561347116",
      "pull_request_review_id": 3506741192,
      "id": 2561347116,
      "node_id": "PRRC_kwDOAN28mc6Yqw4s",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"When constructing or verifying a checksum, the human-readable part MUST be interpreted in lowercase, as specified in BIP-0173.\"",
      "created_at": "2025-11-25T20:41:53Z",
      "updated_at": "2025-11-25T20:41:53Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561347116",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561347116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561357060",
      "pull_request_review_id": 3506752779,
      "id": 2561357060,
      "node_id": "PRRC_kwDOAN28mc6YqzUE",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would you rather just change V5 text to match master's vectors?\n\nFrom:\n> This example shows generating a new 512-bit master seed using \"random\" codex32 characters and appending a checksum.\n\nTo:\n\nThis example shows the long codex32 format, when used without splitting the secret into any shares.",
      "created_at": "2025-11-25T20:46:08Z",
      "updated_at": "2025-11-25T20:46:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561357060",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561357060"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561364297",
      "pull_request_review_id": 3506761147,
      "id": 2561364297,
      "node_id": "PRRC_kwDOAN28mc6Yq1FJ",
      "diff_hunk": "@@ -402,29 +469,29 @@ Master secret (hex): <code>318c6318c6318c6318c6318c6318c631</code>\n \n ===Test vector 2===\n \n-This example shows generating a new master seed using \"random\" codex32 shares, as well as deriving an additional codex32 share, using ''k''=2 and an identifier of <code>NAME</code>.\n+This example shows generating a new master seed using \"random\" shares, as well as deriving an additional share, using a human-readable part of <code>MS</code>, ''k''=2, and an identifier of <code>NAME</code>.\n Although codex32 strings are canonically all lowercase, it's also valid to use all uppercase.\n \n Share with index <code>A</code>: <code>MS12NAMEA320ZYXWVUTSRQPNMLKJHGFEDCAXRPP870HKKQRM</code>\n \n Share with index <code>C</code>: <code>MS12NAMECACDEFGHJKLMNPQRSTUVWXYZ023FTR2GDZMPY6PN</code>\n \n * Derived share with index <code>D</code>: <code>MS12NAMEDLL4F8JLH4E5VDVULDLFXU2JHDNLSM97XVENRXEG</code>\n-* Secret share with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n-* Master secret (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n+* Recovered secret seed with index <code>S</code>: <code>MS12NAMES6XQGUZTTXKEQNJSJZV4JV3NZ5K3KWGSPHUH6EVW</code>\n+* Master seed (hex): <code>d1808e096b35b209ca12132b264662a5</code>\n * master node xprv: <code>xprv9s21ZrQH143K2NkobdHxXeyFDqE44nJYvzLFtsriatJNWMNKznGoGgW5UMTL4fyWtajnMYb5gEc2CgaKhmsKeskoi9eTimpRv2N11THhPTU</code>\n \n Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 338,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2560995482,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I removed it and added wording like this to the end of the codex32 Spec section.",
      "created_at": "2025-11-25T20:49:19Z",
      "updated_at": "2025-11-25T20:49:19Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561364297",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561364297"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561458275",
      "pull_request_review_id": 3506868275,
      "id": 2561458275,
      "node_id": "PRRC_kwDOAN28mc6YrMBj",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I somewhat prefer the current text.",
      "created_at": "2025-11-25T21:21:01Z",
      "updated_at": "2025-11-25T21:21:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561458275",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561458275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561647175",
      "pull_request_review_id": 3507072048,
      "id": 2561647175,
      "node_id": "PRRC_kwDOAN28mc6Yr6JH",
      "diff_hunk": "@@ -59,67 +58,84 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 22,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should it be:\r\n\r\n> and then define **a** BIP-0032 master seed encoding using it.\r\n\r\n?\r\nBecause this is only one encoding of master seeds, SLIP-39 and WIF are others, we should use \"a\" not \"the\".",
      "created_at": "2025-11-25T22:10:40Z",
      "updated_at": "2025-11-25T22:43:52Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561647175",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561647175"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561667081",
      "pull_request_review_id": 3507092272,
      "id": 2561667081,
      "node_id": "PRRC_kwDOAN28mc6Yr_AJ",
      "diff_hunk": "@@ -59,67 +58,84 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 32,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Do we need to be this wordy or should we say:\n\n* A human-readable part, as specified in BIP-0173, which is intended to convey the type of data, or anything else that is relevant to the reader.\n* A separator, as specified in BIP-0173, which is always \"1\".",
      "created_at": "2025-11-25T22:16:07Z",
      "updated_at": "2025-11-25T22:16:07Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561667081",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561667081"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 69,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 70,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561681885",
      "pull_request_review_id": 3507106951,
      "id": 2561681885,
      "node_id": "PRRC_kwDOAN28mc6YsCnd",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 190,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "remove the periods I inadvertently added to these bullets?",
      "created_at": "2025-11-25T22:19:55Z",
      "updated_at": "2025-11-25T22:19:55Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561681885",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561681885"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": 224,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561701104",
      "pull_request_review_id": 3507128287,
      "id": 2561701104,
      "node_id": "PRRC_kwDOAN28mc6YsHTw",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should we say \"secret or set of shares\" because this is the reshare case you mentioned that SHOULD have a unique identifier?\nHere we make it sound like it's OK to reuse an identifier if the secret is the same which is false.",
      "created_at": "2025-11-25T22:25:46Z",
      "updated_at": "2025-11-25T22:25:46Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561701104",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561701104"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561715542",
      "pull_request_review_id": 3507145870,
      "id": 2561715542,
      "node_id": "PRRC_kwDOAN28mc6YsK1W",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret, padded with arbitrary bits",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 247,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Change this to \"secret data\" or \"secret bytes\" to specify its encoding bytes or leave it?  There may be some confusion between \"secret\" meaning the string with share index \"s\" and the decoded payload bytes of that [codex32] secret.",
      "created_at": "2025-11-25T22:30:23Z",
      "updated_at": "2025-11-25T22:30:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561715542",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561715542"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561778890",
      "pull_request_review_id": 3507218968,
      "id": 2561778890,
      "node_id": "PRRC_kwDOAN28mc6YsaTK",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561701104,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, set of shares.",
      "created_at": "2025-11-25T22:47:28Z",
      "updated_at": "2025-11-25T22:47:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561778890",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561778890"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561791403",
      "pull_request_review_id": 3507231446,
      "id": 2561791403,
      "node_id": "PRRC_kwDOAN28mc6YsdWr",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret, padded with arbitrary bits",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 247,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561715542,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"secret data\" sounds good.",
      "created_at": "2025-11-25T22:50:36Z",
      "updated_at": "2025-11-25T22:50:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561791403",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561791403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887002",
      "pull_request_review_id": 3507326378,
      "id": 2561887002,
      "node_id": "PRRC_kwDOAN28mc6Ys0sa",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I might say \"MUST be converted to lowercase\" instead.",
      "created_at": "2025-11-25T23:19:16Z",
      "updated_at": "2025-11-25T23:19:17Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2561887002",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887002"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2563141674",
      "pull_request_review_id": 3508740520,
      "id": 2563141674,
      "node_id": "PRRC_kwDOAN28mc6YxnAq",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That seems to imply mutating the string when verifying a checksum.\r\n\r\nSomething BIP-93 omitted was that encoders should always emit lower-case strings.  Did we relax that requirement?\r\n\r\nCurrently I have the sentence as: \r\n\"Encoders MUST emit lowercase; decoders MUST reject mixed-case and MUST lowercase the human-readable part during checksum verification.\"\r\n\r\nAnd I am adding a section with a `codex32_encode` and `codex32_decode` definitions as I think it's easier to see these rules in code than english.\r\n\r\n> **Uppercase/lowercase**\r\n> \r\n> The lowercase form is used when determining a character's value for checksum purposes.\r\n> \r\n> Encoders MUST always output an all lowercase Bech32 string. If an uppercase version of the encoding result is desired, (e.g.- for presentation purposes, or QR code use), then an uppercasing procedure can be performed external to the encoding process.\r\n> \r\n> Decoders MUST NOT accept strings where some characters are uppercase and some are lowercase (such strings are referred to as mixed case strings).\r\n> \r\n> For presentation, lowercase is usually preferable, but inside QR codes uppercase SHOULD be used, as those permit the use of [alphanumeric mode](http://www.thonky.com/qr-code-tutorial/alphanumeric-mode-encoding), which is 45% more compact than the normal [byte mode](http://www.thonky.com/qr-code-tutorial/byte-mode-encoding).",
      "created_at": "2025-11-26T05:06:05Z",
      "updated_at": "2025-11-26T05:06:05Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2563141674",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2563141674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2564267959",
      "pull_request_review_id": 3510057488,
      "id": 2564267959,
      "node_id": "PRRC_kwDOAN28mc6Y15-3",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I ran the numbers here and we must further restrict HRP lengths to 72 or 74 (same maximum as the payload).  At `len(hrp) = 74` two header characters two header characters aren't checked but what does a threshold or share index even mean for a 0 byte payload?\r\n\r\nI also explicitly stated the maximum length for a codex32 string is 96.  Although perhaps at length = 96 the HRP we assume \"ms\" while the max length for all other prefixes is 94?",
      "created_at": "2025-11-26T09:42:57Z",
      "updated_at": "2025-12-01T06:26:59Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2564267959",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2564267959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565548036",
      "pull_request_review_id": 3511630610,
      "id": 2565548036,
      "node_id": "PRRC_kwDOAN28mc6Y6ygE",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "As far as I'm concerned both all lowercase and all uppercase strings are valid, so encoders can produce either format with lowercase is generally preferred.  I'm not really sure what BIP-173 thinks it is achieving by talking about encoders being somewhat different from a post-processing step.  Maybe they are just trying to say that when creating a checksum, of course, a lowercase HRP must be used. \r\n\r\n> That seems to imply mutating the string when verifying a checksum.\r\n\r\nThis is exactly what the BIP-173 reference python decoder does:\r\n\r\nhttps://github.com/sipa/bech32/blob/master/ref/python/segwit_addr.py#L78\r\n\r\nHowever, \"The lowercase form is used \" is also fine wording though.",
      "created_at": "2025-11-26T15:52:25Z",
      "updated_at": "2025-11-26T15:52:25Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2565548036",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565548036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565654406",
      "pull_request_review_id": 3511757121,
      "id": 2565654406,
      "node_id": "PRRC_kwDOAN28mc6Y7MeG",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Since we are excluding the HRP from the error-correction and detection routine, the HRP can be as long as folks want.  The HRP just adds a \"random\" factor to the checksum as a function of the HRP text and the number of characters in the data.  And by \"random\" I really mean deterministic.\r\n\r\nThe way the error correction algorithm works is that it finds locations of errors starting from the end of the string (i.e. the end of the checksum) going back as far as but no further than 93 characters.  So when the hrp-expanded segement + the data segment is longer than 93 characters, the algorithm simply fails to locate errors at any location beyond the last 93 characters.\r\n\r\nWhen the hrp-expanded segement + the data segment is longer than 93 characters the hamming distance property still holds on the last 93 characters.  That is if you only change the last 93 characters you must change at least 9 characters in order to get another valid string.",
      "created_at": "2025-11-26T16:24:09Z",
      "updated_at": "2025-11-26T16:24:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2565654406",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2565654406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566180182",
      "pull_request_review_id": 3512376855,
      "id": 2566180182,
      "node_id": "PRRC_kwDOAN28mc6Y9M1W",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The HRP _is_ included in the error detection routine.  That's why I've restricted the length to 94 characters if hrp != \"ms\".  In the 96 length case we assume it's \"ms\"\r\n\r\nWould you like to not have any length restriction and not promise to detect errors in the HRP?\r\n\r\nThat sounds strictly worse, since we don't have to support any length of HRP, we can restrict it to ones that do get covered by the 13 character checksum, and that is better if a lot of them proliferate and some future application needs to disambiguate two short checksums.",
      "created_at": "2025-11-26T19:03:54Z",
      "updated_at": "2025-12-01T06:28:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566180182",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566180182"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566195378",
      "pull_request_review_id": 3512395392,
      "id": 2566195378,
      "node_id": "PRRC_kwDOAN28mc6Y9Qiy",
      "diff_hunk": "@@ -59,32 +58,41 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define the BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n+* A human-readable part, which is intended to convey the type of data, or anything else that is relevant to the reader. This part MUST contain 1 to 83 US-ASCII characters, with each character having a value in the range [33-126]. HRP validity may be further restricted by specific applications.\n+* A separator, which is always \"1\". In case \"1\" is allowed inside the human-readable part, the last one in the string is the separator<ref>'''Why include a separator in codex32 strings?''' That way the human-readable\n+part is unambiguously separated from the data part, avoiding potential\n+collisions with other human-readable parts that share a prefix. It also\n+allows us to avoid having character-set restrictions on the human-readable part.</ref>.\n * A data part which is in turn subdivided into:\n ** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n ** An identifier consisting of 4 bech32 characters.\n ** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n+** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n ** A checksum which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n+The lowercase form is used when determining a character's value for checksum purposes.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 48,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557146292,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"Decoders MUST use the lowercase form of the human-readable part during checksum verification.\"",
      "created_at": "2025-11-26T19:08:17Z",
      "updated_at": "2025-11-26T19:08:17Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566195378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566195378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566235386",
      "pull_request_review_id": 3512447446,
      "id": 2566235386,
      "node_id": "PRRC_kwDOAN28mc6Y9aT6",
      "diff_hunk": "@@ -481,10 +548,49 @@ The payload contains 103 bech32 characters, which corresponds to 515 bits. The l\n \n This is an example of a '''Long codex32 String'''.\n \n-* Secret share with index <code>S</code>: <code>MS100C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06FHPV80UNDVARHRAK</code>\n-* Master secret (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n+unchecksummed string (bech32): <code>MS10C8VSM32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6AN074RXVCEMLH8WU3TK925ACDEFGHJKLMNPQRSTUVWXY06F</code>",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 379,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557171793,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I reverted it\r\n\r\nWe start given\r\n\r\nk value = 0\r\nidentifier = 0C8V\r\npayload = \r\n\r\nthen compute\r\n\r\n* checksum\r\n* secret seed\r\n* Master seed\r\n* master node xprv\r\n\r\nWe are able to infer share index = \"s\" and hrp = \"MS\" from the text.\r\n\r\nFWIW I have been using the term \"secret seed\" when a codex32 secret is arrived at from bech characters (interpolation or randomly selected) and I have been using the term codex32-encoded master seed when it's produced from bytes.\r\n\r\nThis is slightly more precise but we need not bother readers with the distinction since both are valid.",
      "created_at": "2025-11-26T19:19:43Z",
      "updated_at": "2025-11-26T19:20:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566235386",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566235386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 551,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566256723",
      "pull_request_review_id": 3512473683,
      "id": 2566256723,
      "node_id": "PRRC_kwDOAN28mc6Y9fhT",
      "diff_hunk": "@@ -198,92 +213,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n-* All of the share index values are distinct\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length.\n+* All of the share index values are distinct.\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 243,
      "commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "original_commit_id": "a4f1e91ad9483b5d583fd7f40acbeb081e12cb62",
      "in_reply_to_id": 2561701104,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I used \"set of shares\" in for an existing secret and \"secret\" in for a fresh secret.\r\n\r\nThis is technically correct, no need to say both \"secret and set of shares\" in existing secret, if you follow that process you always get a fresh set of shares and that is what needs to be uniquely identified not the secret per se.",
      "created_at": "2025-11-26T19:26:01Z",
      "updated_at": "2025-11-26T19:26:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566256723",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566256723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566309266",
      "pull_request_review_id": 3512534912,
      "id": 2566309266,
      "node_id": "PRRC_kwDOAN28mc6Y9sWS",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 396,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The original forgot to subtract the 6 character header from the secret payload bits.\n\nI used 368 instead of 370 because 2 of them are padding and not secret data.\n\nIs this another one of those places we should say \"secret data\" to avoid ambiguity between the \"s\" string and bytes?",
      "created_at": "2025-11-26T19:44:13Z",
      "updated_at": "2025-11-26T19:44:13Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566309266",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566309266"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566318834",
      "pull_request_review_id": 3512545868,
      "id": 2566318834,
      "node_id": "PRRC_kwDOAN28mc6Y9ury",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 397,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is implicit from the spec definition:\n\n> Strings of length 95 and 96 MUST use HRP \"ms\" (or \"MS\")\n\nIf it needs to be explained here also.  Or a sentence why the maximum length is 94 for other HRP, let me know and I'll try.\n\nWe could reduce maximum length to 94 characters and remove the special HRP vs length rule, but that breaks existing \"46-byte codex32-encoded master seeds\" and these are absolutely critical to support given the wide-spread deployment of both codex32 and 46-byte master seeds.",
      "created_at": "2025-11-26T19:48:48Z",
      "updated_at": "2025-11-26T19:48:48Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566318834",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566318834"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 402,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566323323",
      "pull_request_review_id": 3512550880,
      "id": 2566323323,
      "node_id": "PRRC_kwDOAN28mc6Y9vx7",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 340,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "At this point we should link to the registry somewhere in our document so people know what a \"codex32 human-readable part\" might be:\n\nWhere's the best place to put this hyperlink?\nhttps://github.com/satoshilabs/slips/blob/master/slip-0173.md#uses-of-codex32",
      "created_at": "2025-11-26T19:50:44Z",
      "updated_at": "2025-11-26T19:50:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566323323",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566323323"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 419,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566480703",
      "pull_request_review_id": 3512740920,
      "id": 2566480703,
      "node_id": "PRRC_kwDOAN28mc6Y-WM_",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Would you like to not have any length restriction and not promise to detect errors in the HRP?\r\n\r\nThat's what I was thinking.  There would just be a 93 data character limit and no correction of the HRP.  This is how the limits of BIP-93 was designed.\r\n\r\n> That sounds strictly worse\r\n\r\nI'm struggling to see how error correction is useful for the HRP.  You need to already know the HRP in order to know select the codex32 error correction algorithm to begin with.  CL wallets only take codex32 strings with the \"cl\" prefix.  Hardware wallets only take codex32 strings beginning with \"ms\".  If you cannot read the prefix you won't even know if it is a bip-173 address or a codex32 string or someone else's algorithm.  If you find a piece of paper laying around with \"xd10lueasd35kw6r5de5kueedxyesqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqanvrktzhlhus\" what are you expecting folks to do with it?  Is it a bitcoin address, is it a private key, is it some other coin's something?\r\n\r\nThere is a simple error correction algorithm: just try replacing the prefix all the prefixes that you care about.",
      "created_at": "2025-11-26T20:59:50Z",
      "updated_at": "2025-11-26T20:59:51Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566480703",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566480703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566489916",
      "pull_request_review_id": 3512751367,
      "id": 2566489916,
      "node_id": "PRRC_kwDOAN28mc6Y-Yc8",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 396,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566309266,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it is fine as is, since the \"368-bit\" makes it clear it is data, but if you want to change the wording, that would also be fine.",
      "created_at": "2025-11-26T21:05:00Z",
      "updated_at": "2025-11-26T21:05:01Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566489916",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566489916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566492577",
      "pull_request_review_id": 3512754151,
      "id": 2566492577,
      "node_id": "PRRC_kwDOAN28mc6Y-ZGh",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 340,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't really want to be seen as endorsing a particular registry.  But I also see how a link could be useful, so I'm torn.",
      "created_at": "2025-11-26T21:06:26Z",
      "updated_at": "2025-11-26T21:06:26Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566492577",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566492577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 419,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566496494",
      "pull_request_review_id": 3512758500,
      "id": 2566496494,
      "node_id": "PRRC_kwDOAN28mc6Y-aDu",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 340,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe best to leave the registry out since they may or may not be Bitcoin related.",
      "created_at": "2025-11-26T21:08:38Z",
      "updated_at": "2025-11-26T21:08:38Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566496494",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566496494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 419,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566508035",
      "pull_request_review_id": 3512771739,
      "id": 2566508035,
      "node_id": "PRRC_kwDOAN28mc6Y-c4D",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Let's use a descriptor for an example. Say these prefixes get registered \"xpub\", \"xprv\", \"privkey\" or whatever.\n\nNow we have an import field that should be able to correct hrp errors.\n\nIn case we typed or wrote \"xpub\" for \"xprv\" or vice versa.\n\nIt would be best to have error detection guarantees (and corrections) for the HRP instead of the 1/(2^65) sort. And to get that, the hrp needs to be covered.\n\nIn this case the app can try \"xpub\", \"xprv\" or \"privkey\" and detect or repair transcription errors in these strings.",
      "created_at": "2025-11-26T21:15:30Z",
      "updated_at": "2025-12-16T08:42:27Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566508035",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566508035"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566578378",
      "pull_request_review_id": 3512848332,
      "id": 2566578378,
      "node_id": "PRRC_kwDOAN28mc6Y-uDK",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why don't we keep it as is: a maximum length of 96 and then say that HRP's may further restrict length. For example how \"ms\" restricts to 16-64 bytes or \"cl\" 32.\n\nBecause the two current applications do not need to disambiguate HRP's, but future ones may need to, in which case they should shorten the max length to 94 to cover HRP.",
      "created_at": "2025-11-26T21:53:54Z",
      "updated_at": "2025-12-01T06:31:16Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566578378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566578378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566587957",
      "pull_request_review_id": 3512863332,
      "id": 2566587957,
      "node_id": "PRRC_kwDOAN28mc6Y-wY1",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 340,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki#user-content-Registered_Humanreadable_Prefixes\n\nBIP-0173 which is a prerequisite for implementing this format links to that registry.\n\nWe don't have to link to it as they can find it in BIP-0173 but it the concept of registering codex32 HRP should be mentioned to avoid chaos and disaster of using anything for everything.",
      "created_at": "2025-11-26T21:59:38Z",
      "updated_at": "2025-11-26T21:59:38Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566587957",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566587957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 419,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566609752",
      "pull_request_review_id": 3512901990,
      "id": 2566609752,
      "node_id": "PRRC_kwDOAN28mc6Y-1tY",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Let's use a descriptor for an example. Say these prefixes get registered \"xpub\", \"xprv\", \"privkey\" or whatever.\r\n> \r\n> Now we have an import field that should be able to correct hrp errors.\r\n> \r\n> In case we typed or wrote \"xpub\" for \"xprv\" or vice versa.\r\n\r\nI agree that for applications that can accept more than one different HRPs in the same context, it makes sense to make sure error detection can cover them and those applications will need their own BIPs to cover their own length restrictions.  My point is that no one is mixing up master seeds with addresses.\r\n\r\n> It would be best to have error detection guarantees (and corrections) for the HRP instead of the 1/(2^65) sort. And to get that, the checksum needs to be covered.\r\n\r\nThe situation is actually much worse than the 1/(2^65) sort.\r\n\r\n> ms1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtray0m\r\n\r\nhas two corrections, either\r\n\r\n> ms1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtraypy\r\n\r\nor \r\n\r\n> cl1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaady97ykdtray0m\r\n\r\n(Edit: yes 'a' is an invalid threshold, but you know what I mean.  The point is that for the 93 character data part, mistaking the ms prefix for a cl prefix is the same as making a two character error in the checksum.)\r\n\r\nThe math is that x^93 == 1 modulo our (short) codex32 generator, which means errors at location *n* are indistinguishable from errors at location *n*+93.\r\n\r\nUgh, I'm starting to think you are right.  The total length of strings must be 94 characters or less, with an exception that an ms string can be 96 characters.  Even a length restriction of 94 characters isn't going to be enough unless we also restrict the HRP to use only letters and disallow numbers (we could also accept underscores and perhaps a very small handful of carefully selected special ASCII characters).\r\n\r\nAnd maybe (in a separate PR) we should outlaw unusual sized master seed strings too to get rid of even that \"ms\" exception if we can agree on a definition of unusual sized.",
      "created_at": "2025-11-26T22:12:35Z",
      "updated_at": "2025-11-26T22:15:43Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566609752",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566609752"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566632749",
      "pull_request_review_id": 3512937493,
      "id": 2566632749,
      "node_id": "PRRC_kwDOAN28mc6Y-7Ut",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Speaking of those multi-hrp applications, my reviewer on the bip85 codex app is working on one such application (BIP32 encodings) https://github.com/bitcoin/bips/pull/1958#issuecomment-3581306205",
      "created_at": "2025-11-26T22:25:29Z",
      "updated_at": "2025-12-01T06:33:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566632749",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566632749"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566679510",
      "pull_request_review_id": 3512987924,
      "id": 2566679510,
      "node_id": "PRRC_kwDOAN28mc6Y_GvW",
      "diff_hunk": "@@ -323,10 +398,10 @@ While we could use the 15 character checksum for both cases, we prefer to keep t\n We only guarantee to correct 4 characters no matter how long the string is.\n Longer strings mean more chances for transcription errors, so shorter strings are better.\n \n-The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 400-bit secret.\n+The longest data part using the regular 13 character checksum is 93 characters and corresponds to a 368-bit secret.\n At this length, the prefix <code>MS1</code> is not covered by the checksum.\n-This is acceptable because the checksum scheme itself requires you to know that the <code>MS1</code> prefix is being used in the first place.\n-If the prefix is damaged and a user is guessing that the data might be using this scheme, then the user can enter the available data explicitly using the suspected <code>MS1</code> prefix.\n+This is acceptable because the checksum scheme itself requires you to know that a codex32 human-readable part is being used in the first place.",
      "path": "bip-0093.mediawiki",
      "position": 340,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2566323323,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh.  Well if there is precedent then I guess it is okay.",
      "created_at": "2025-11-26T22:57:53Z",
      "updated_at": "2025-11-26T22:57:54Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566679510",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566679510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 419,
      "original_line": 403,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566695226",
      "pull_request_review_id": 3513005609,
      "id": 2566695226,
      "node_id": "PRRC_kwDOAN28mc6Y_Kk6",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Okay we have a choice of making a complicated rule like \"the string length plus the length of the hrp (i.e double counting the hrp) must be less than or equal to 93\" or we can have simple rule like \"the length of the string must be less than or equal to 94\" but also restricting the hrp character set to at most 32 values where the lower 5 bits of the ASCII character are all distinct.\r\n\r\nGiven how length constrained our 13 character checksum is, I think we should restrict the HRP character set.  I'd go for \"a-z\" and special characters `@_[|]~`, but the choice of special characters is debatable (but our options are limited).  However, we will have to pick some.\r\n\r\nWe have a choice between @ and `, of which I think @ is preferable\r\n\r\nWe have a choice between ? and _ , of which I think _ is preferable.  In particular I don't think we want ? as a legal HRP character.\r\n\r\nWe have a choice between ;, [, and {.  We have a choice between <, \\, and |.  We have a choice between =, ] and }.  We have a choice between >, ^, and ~.  I don't have very strong preferences within these options.\r\n",
      "created_at": "2025-11-26T23:10:43Z",
      "updated_at": "2025-11-26T23:10:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566695226",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566695226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566724945",
      "pull_request_review_id": 3513035294,
      "id": 2566724945,
      "node_id": "PRRC_kwDOAN28mc6Y_R1R",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Actually I'm not sure even this restriction is enough.  We might need to require hrps only consist of ascii characters between 96 and 126 (or their upper case variants) so that all their upper bits are always `011` in order to be safe. ",
      "created_at": "2025-11-26T23:35:59Z",
      "updated_at": "2025-11-26T23:36:50Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566724945",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566724945"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566730566",
      "pull_request_review_id": 3513041170,
      "id": 2566730566,
      "node_id": "PRRC_kwDOAN28mc6Y_TNG",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@apoelstra already has a prefix, \"BIP32_24W\" which mixes up letter and numbers in violation of my proposal.",
      "created_at": "2025-11-26T23:41:21Z",
      "updated_at": "2025-11-26T23:41:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566730566",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566730566"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566747046",
      "pull_request_review_id": 3513057621,
      "id": 2566747046,
      "node_id": "PRRC_kwDOAN28mc6Y_XOm",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@apoelstra 's BIP32_24W has 82 length strings with at 9 character hrp.  82 + 9 = 91 which is just barely less than 93. \r\n\r\nOkay I guess the total length of a string + the length of the hrp (.i.e. double counting the hrp) must be less than or equal to 93 should be the rule for using the 13 character checksum.",
      "created_at": "2025-11-26T23:55:01Z",
      "updated_at": "2025-11-27T00:02:20Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566747046",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566747046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566769411",
      "pull_request_review_id": 3513080545,
      "id": 2566769411,
      "node_id": "PRRC_kwDOAN28mc6Y_csD",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Perhaps a better way of phrasing this is that the maximum length of string (including the HRP) for a given codex scheme is 93 - the length of the HRP.",
      "created_at": "2025-11-27T00:16:18Z",
      "updated_at": "2025-11-27T00:16:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566769411",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566769411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566777855",
      "pull_request_review_id": 3513089089,
      "id": 2566777855,
      "node_id": "PRRC_kwDOAN28mc6Y_ev_",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The situation is actually much worse than the 1/(2^65) sort.\r\n\r\nAh yes, I forgot how fragile ECC is when pushed beyond it's capacity.\r\n\r\n> \r\n> (...The point is that for the 93 character data part, mistaking the ms prefix for a cl prefix is the same as making a two character error in the checksum.)\r\n\r\nWell \"cl\" fortunately has a 32-byte length requirement (and we should probably start talking about length limits as payload bytes unless we want to support pure u5 secrets that do not need conversion to bytes) but we do need to plan for the eventual case of detecting HRP errors at the maximum 13 character checksum length.\r\n \r\n> Ugh, I'm starting to think you are right. The total length of strings must be 94 characters or less, with an exception that an ms string can be 96 characters.\r\n\r\n95 characters has an incomplete group decoding to bytes so I can remove the \"95 or\" 96.\r\n\r\n>Even a length restriction of 94 characters isn't going to be enough unless we also restrict the HRP to use only letters and disallow numbers (we could also accept underscores and perhaps a very small handful of carefully selected special ASCII characters).\r\n\r\nWhat do we need to restrict it to in order to allow every US-ASCII character?  Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\r\n\r\nie 5 US-ASCII characters should be similar to 7 data part characters.\r\n\r\nDoes that mean 52 US-ASCII character limit on the hrp for short codex32 strings?  That sounds fine. Although now we get a maximum length formula like strings can't exceed `(len(hrp) + 4) * 7 // 5 + len(payload) <= 74`\r\n\r\nWe also have restrictions within our own codex32 header that can be exploited to lend slightly more correction power to the human-readable part:\r\n9 out of 32 values for threshold. Threshold 0 only has 1/32 share indices.\r\n\r\nThat might get it to 53 US-ASCII, I didn't run the numbers.\r\n \r\n> And maybe (in a separate PR) we should outlaw unusual sized master seed strings too to get rid of even that \"ms\" exception if we can agree on a definition of unusual sized.\r\n\r\nI gave a very [good argument](https://github.com/BlockstreamResearch/codex32/pull/71#issuecomment-3445066181) to justify outlawing lengths besides 128, 192, 256, 512, or put another looser way, lengths not divisible by 64 bits.  Any closer has input lengths within the insert/delete correctable distance of two valid lengths and causes ambiguity.\r\n\r\nThis can be an \"ms\" specific recommendation (or requirement) I don't think every codex32 application needs to be as strict on lengths if they have a good reason to support variable length encodings. Although it would be worth recommending this 64 bit spacing to all applications in case their developers are unaware of the harm it causes insert/delete correction.\r\n\r\nThe final concern on this topic is that the maximum hrp length is really a derivative of the maximum checksummed payload length, which is 370 bits.  If we spend 70 bits on a 10 US-ASCII HRP, there's only 300 bits, 60 bech32 characters left for the secret.  or a 50 character HRP supports a payload length of 4 bech32 characters (2 bytes).\r\n\r\nThis is making me want to roll the HRP into the CRC, then we get an extra 1-4 bits of error detection on it, which in some cases will extend the permitted HRP length by 1.  OTOH for pure secret data recovery purposes, it's stronger if it just checksums the seed, although it barely matters since it can't correct any bit errors at the 128 or 256 bitlengths\r\n\r\n",
      "created_at": "2025-11-27T00:24:21Z",
      "updated_at": "2025-12-01T06:35:58Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566777855",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566777855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566787113",
      "pull_request_review_id": 3513098449,
      "id": 2566787113,
      "node_id": "PRRC_kwDOAN28mc6Y_hAp",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Given how length constrained our 13 character checksum is, I think we should restrict the HRP character set. I'd go for \"a-z\" and special characters `@_[|]~`, but the choice of special characters is debatable (but our options are limited). However, we will have to pick some.\r\n\r\nThis is too breaking of BIP-0173 spec, just allow the entire range and accept a shorter string.  If an application needs a super long HRP then either we don't allow it (83 maximum in BIP-0173, although must be lower here for short codex32) or they use the long codex32 checksum which is good for 730 HRP characters.\r\n\r\nDo we want to avoid a situation where strings of the same length and different HRP may be using different checksums, or if we don't care (i don't care)  we can choose the checksum according to combined length:\r\n\r\nWe pack the `bech32_hrp_expand(hrp) + data` and then use that to determine `checksum_len`, that would eliminate our HRP length requirement being smaller than BIP-0173's, do you agree with this solution?\r\n\r\nI'm sure there's some \"hrp insert/delete\" correction assumption nightmares for error correcting decoders but applications that need to disambiguate SHOULD at least make all the HRP's they must consider the same length to avoid this mess.\r\n\r\nI'm also fine with treating each HRP character as two bech32 characters for maximum length purposes, even though we can probably do better than that (even using `bech32_hrp_expand()`) due to each character only being a 7-bit value.",
      "created_at": "2025-11-27T00:32:58Z",
      "updated_at": "2025-12-01T06:37:28Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566787113",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566787113"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795329",
      "pull_request_review_id": 3513106754,
      "id": 2566795329,
      "node_id": "PRRC_kwDOAN28mc6Y_jBB",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Okay I guess the total length of a string + the length of the hrp (.i.e. double counting the hrp) must be less than or equal to 93 should be the rule for using the 13 character checksum.\r\n\r\nI like this.  Can we do better than double counting the HRP since each US-ASCII is 7- not 10 bits?  Or will our detection guarantees begin to break down (not able to correct any 2 HRP substitutions or detect any 4 HRP errors if its length exceed 37s, with an empty data part)?\r\n\r\nI guess the pure 7-bit character translation of our guarantees is: correct any 2 hrp errors, detect any 5 errors, 9 if contiguous for short codex32 (10 if contiguous on long codex32)\r\n\r\nCan we achieve this property simply?  We should if we can.",
      "created_at": "2025-11-27T00:41:02Z",
      "updated_at": "2025-12-01T06:37:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566795329",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795329"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795573",
      "pull_request_review_id": 3513107008,
      "id": 2566795573,
      "node_id": "PRRC_kwDOAN28mc6Y_jE1",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> What do we need to restrict it to in order to allow every US-ASCII character? Keeping in mind it expands to two 5 bit values but only the upper 2 bits can change so we should have better detection ability than 10 bits per character.\r\n\r\nThe issue is that for BCH codes the data really needs to fit within their length restriction, so we cannot just count entropy.  Even if we know some some bits are fixed, if the polynomial we extract has degree more that 93, everything falls apart because it can no longer distinguish errors on one side of the polynomial from errors on the other side of the polynomial.  The rules that the the string length plus counting the hrp again must be less than 93 is the only thing that makes the HRP expanded polynomial concatenated with the data part fit in degree at most 93.",
      "created_at": "2025-11-27T00:41:17Z",
      "updated_at": "2025-11-27T00:41:18Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2566795573",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2566795573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567413699",
      "pull_request_review_id": 3513818681,
      "id": 2567413699,
      "node_id": "PRRC_kwDOAN28mc6ZB5_D",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I dislike a situation where valid \"long codex32\" strings can be shorter overall (and in data part characters) than regular codex32.\n\n\"long\" codex32 format: 10 hrp characters + 1 + 6 header characters + 54 payload characters + 15 checksum characters = 86\ncodex32 format: \"ms\" hrp characters + 1 + 6 header characters + 74 payload characters + 13 checksum characters  = 96\n\nSo I'm now restricting the HRP length and leaving `codex32_verify_checksum()` alone. The checksum will remain selected as it currently is: \nbased on the length of the data.\n\nThe maximum HRP length will be restricted (going forward) so that any HRP is always covered by our 4 error correction guarantees if its errors only affect low (or high bits).  96 character short \"ms\" strings are deprecated, they decode properly but the same hrp & data will now encode with the long checksum.\n\nIt has to be this way, if we needed the HRP to know which checksum to use, we can't protect the HRP. If we change verify rules, we break backwards compatibility.\n\n```python\ndef bech32_decode(bech):\n    \"\"\"Validate a Bech32/Bech32m string, and determine HRP and data.\"\"\"\n```\n\nWe must do the equivalent:\n\n```python\ndef codex32_decode(codex):\n    \"\"\"Validate a codex32/Long codex32 string, and determine HRP and data.\"\"\"\n```\n\nThe decoder must be ignorant of HRP, because that's the point of it, to determine it.",
      "created_at": "2025-11-27T07:18:15Z",
      "updated_at": "2025-12-16T08:28:10Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567413699",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567413699"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567504835",
      "pull_request_review_id": 3513922085,
      "id": 2567504835,
      "node_id": "PRRC_kwDOAN28mc6ZCQPD",
      "diff_hunk": "@@ -198,92 +254,94 @@ def ms32_interpolate(l, x):\n         res.append(n)\n     return res\n \n-def ms32_recover(l):\n-    return ms32_interpolate(l, 16)\n+def codex32_recover(l):\n+    return codex32_interpolate(l, 16)\n </source>\n \n ===Generating Shares===\n \n-If we already have ''t'' valid codex32 strings such that:\n+If we already have ''k'' valid codex32 strings such that:\n \n-* All strings have the same threshold value ''t'', the same identifier, and the same length\n+* All strings have the same human-readable part, the same threshold value ''k'', the same identifier, and the same length\n * All of the share index values are distinct\n \n-Then we can derive additional shares with the <code>ms32_interpolate</code> function by passing it a list of exactly ''t'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n+Then we can derive additional shares with the <code>codex32_interpolate</code> function by passing it a list of exactly ''k'' of these codex32 strings, together with a fresh share index distinct from all of the existing share indexes.\n The newly derived share will have the provided share index.\n \n Once a user has generated ''n'' codex32 shares, they may discard the codex32 secret (if it exists).\n-The ''n'' shares form a ''t'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n+The ''n'' shares form a ''k'' of ''n'' Shamir's secret sharing scheme of a codex32 secret.\n \n-There are two ways to create an initial set of ''t'' valid codex32 strings, depending on whether the user already has an existing master seed to split.\n+There are two ways to create an initial set of ''k'' valid codex32 strings, depending on whether the user already has an existing secret to split.\n \n-====For a fresh master seed====\n+====For a fresh secret====\n \n-In the case that the user wishes to generate a fresh master seed, the user generates random initial shares, as follows:\n+In the case that the user wishes to generate a fresh secret, the user generates random initial shares, as follows:\n \n-# Choose a bitsize, between 128 and 512, which must be a multiple of 8.\n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a bitsize, between 128 and 512, which must be a multiple of 8\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n-# ''t'' many times, generate a random share by:\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every secret the user may need to disambiguate\n+# ''k'' many times, generate a random share by:\n ## Take the next available letter from the bech32 alphabet, in alphabetical order, as <code>a</code>, <code>c</code>, <code>d</code>, ..., to be the share index\n-## Set the first nine characters to be the prefix <code>ms1</code>, the threshold value ''t'', the 4-character identifier, and then the share index\n+## Set the first characters to be the human-readable part, the separator <code>1</code>, the threshold value ''k'', the 4-character identifier, and then the share index\n ## Choose the next ceil(''bitlength / 5'') characters uniformly at random\n ## Generate a valid checksum in accordance with the Checksum section, and append this to the resulting shares\n \n-The result will be ''t'' distinct shares, all with the same initial 8 characters, and a distinct share index as the 9th character.\n+The result will be ''k'' distinct shares, all with the same initial characters, and a distinct share index as the 6th data character.\n \n-With this set of ''t'' codex32 shares, new shares can be derived as discussed above. This process generates a fresh master seed, whose value can be retrieved by running the recovery process on any ''t'' of these shares.\n+With this set of ''k'' shares, new shares can be derived as discussed above. This process generates a fresh secret, whose value can be retrieved by running the recovery process on any ''k'' of these shares.\n \n-====For an existing master seed====\n+====For an existing secret====\n \n-Before generating shares for an existing master seed, it first must be converted into a codex32 secret, as described above.\n+Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n-# Choose a threshold value ''t'' between 2 and 9, inclusive\n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n+# Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n-#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed the user may need to disambiguate.\n+#* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every set of shares the user may need to disambiguate\n # Set the share index to <code>s</code>\n-# Set the payload to a bech32 encoding of the master seed, padded with arbitrary bits\n-# Generating a valid checksum in accordance with the Checksum section\n+# Set the payload to a bech32 encoding of the secret data, padded with arbitrary bits\n+# Generate a valid checksum in accordance with the Checksum section\n \n-Along with the codex32 secret, the user must generate ''t''-1 other codex32 shares, each with the same threshold value, the same identifier, and a distinct share index.\n-These shares should be generated as described in the \"fresh master seed\" section.\n+Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same human-readable part, the same threshold value, the same identifier, and a distinct share index.\n+These shares should be generated as described in the \"fresh secret\" section.\n \n-The codex32 secret and the ''t''-1 codex32 shares form a set of ''t'' valid codex32 strings from which additional shares can be derived as described above.\n+The codex32 secret and the ''k''-1 codex32 shares form a set of ''k'' valid codex32 strings from which additional shares can be derived as described above.\n \n-===Long codex32 Strings===\n+===Long codex32===\n \n The 13 character checksum design only supports up to 80 data characters.\n-Excluding the threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.\n+Excluding the human-readable part, threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.\n While this is enough to support the 32-byte advised size of BIP-0032 master seeds, BIP-0032 allows seeds to be up to 64 bytes in size.\n-We define a long codex32 string format to support these longer seeds by defining an alternative checksum.\n+We define a long codex32 format to support these longer seeds by defining an alternative checksum.\n \n <source lang=\"python\">\n-MS32_LONG_CONST = 0x43381e570bf4798ab26\n+CODEX32_LONG_CONST = 0x43381e570bf4798ab26\n \n-def ms32_long_polymod(values):\n+def codex32_long_polymod(values):\n     GEN = [\n         0x3d59d273535ea62d897,\n         0x7a9becb6361c6c51507,\n         0x543f9b7e6c38d8a2a0e,\n         0x0c577eaeccf1990d13c,\n         0x1887f74f8dc71b10651,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 70)\n         residue = (residue & 0x3fffffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_long_checksum(data):\n-    return ms32_long_polymod(data) == MS32_LONG_CONST\n+def codex32_verify_long_checksum(data):\n+    return codex32_long_polymod(data) == CODEX32_LONG_CONST\n \n-def ms32_create_long_checksum(data):\n+def codex32_create_long_checksum(data):\n     values = data\n-    polymod = ms32_long_polymod(values + [0] * 15) ^ MS32_LONG_CONST\n+    polymod = codex32_long_polymod(values + [0] * 15) ^ CODEX32_LONG_CONST\n     return [(polymod >> 5 * (14 - i)) & 31 for i in range(15)]\n </source>\n ",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 348,
      "commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Probably should mention its maximum length for the correction guarantees in a sentence here, similar to what is in the checksum section.  Otherwise 1024 is a magic number in the reference snippets.",
      "created_at": "2025-11-27T07:57:47Z",
      "updated_at": "2025-11-27T07:57:47Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2567504835",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2567504835"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 363,
      "original_line": 347,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569539679",
      "pull_request_review_id": 3516398393,
      "id": 2569539679,
      "node_id": "PRRC_kwDOAN28mc6ZKBBf",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I can probably write this code out if you want, but my thoughts are we should have `codex32_decode`, an independent `long_codex32_decode` and an `ms_decode` that can call both of them. ",
      "created_at": "2025-11-27T16:55:51Z",
      "updated_at": "2025-11-27T16:55:51Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569539679",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569539679"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569613685",
      "pull_request_review_id": 3516490204,
      "id": 2569613685,
      "node_id": "PRRC_kwDOAN28mc6ZKTF1",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That makes sense!  Bech32 has an encode/decode for the format and then a separate encode/decode function for segwit addresses.\n\nHowever they do encode/decode both Bech32/Bech32m checksums at once.\n\nWe need codex32_encode and codex32_decode function to handle both checksums. That has to be format level, not application level in order to detect/correct HRP errors.",
      "created_at": "2025-11-27T17:29:22Z",
      "updated_at": "2025-12-01T04:26:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569613685",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569613685"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569665206",
      "pull_request_review_id": 3516546816,
      "id": 2569665206,
      "node_id": "PRRC_kwDOAN28mc6ZKfq2",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Below is untested code that is approximately what I'm thinking\r\n\r\n```\r\ndef bech32_hrp_expand(s):\r\n  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\r\n\r\nCODEX32_CONST = 0x10ce0795c2fd1e62a\r\n  \r\ndef codex32_polymod(residue, values):\r\n    if len(values) > 93:\r\n        return False\r\n    GEN = [\r\n        0x19dc500ce73fde210,\r\n        0x1bfae00def77fe529,\r\n        0x1fbd920fffe7bee52,\r\n        0x1739640bdeee3fdad,\r\n        0x07729a039cfc75f5a,\r\n    ]\r\n    for v in values:\r\n        b = (residue >> 60)\r\n        residue = (residue & 0x0fffffffffffffff) << 5 ^ v\r\n        for i in range(5):\r\n            residue ^= GEN[i] if ((b >> i) & 1) else 0\r\n    return residue\r\n\r\nCODEX32_LONG_CONST = 0x43381e570bf4798ab26\r\n    \r\ndef codex32_long_polymod(residue, values):\r\n    if len(values) > 1023:\r\n        return False\r\n    GEN = [\r\n        0x3d59d273535ea62d897,\r\n        0x7a9becb6361c6c51507,\r\n        0x543f9b7e6c38d8a2a0e,\r\n        0x0c577eaeccf1990d13c,\r\n        0x1887f74f8dc71b10651,\r\n    ]\r\n    for v in values:\r\n        b = (residue >> 70)\r\n        residue = (residue & 0x3fffffffffffffffff) << 5 ^ v\r\n        for i in range(5):\r\n            residue ^= GEN[i] if ((b >> i) & 1) else 0\r\n    return residue\r\n\r\ndef codex32_verify_checksum(hrp, data):\r\n    return codex32_polymod(1, bech32_hrp_expand(hrp) + data) == CODEX32_CONST\r\n    \r\ndef codex32_verify_long_checksum(hrp, data):\r\n    return codex32_long_polymod(1, bech32_hrp_expand(hrp) + data) == CODEX32_LONG_CONST\r\n\r\ndef codex32_create_checksum(hrp, data):\r\n    polymod = codex32_polymod(1, bech32_hrp_expand(hrp) + data + [0] * 13)\r\n    if polymod:\r\n        polymod = polymod ^ MS32_CONST\r\n        return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\r\n    return False\r\n\r\ndef codex32_create_long_checksum(hrp, data):\r\n    polymod = codex32_long_polymod(1,bech32_hrp_expand(hrp) + data + [0] * 15)\r\n    if polymod:\r\n        polymod = polymod ^ MS32_LONG_CONST\r\n        return [(polymod >> 5 * (14 - i)) & 31 for i in range(15)]\r\n    return False\r\n\r\ndef ms32_verify_checksum(data):\r\n    if len(data) >= 96:\r\n        return codex32_verify_long_checksum(\"ms\", data)\r\n    return codex32_polymod(codex32_polymod(1, bech32_hrp_expand(\"ms\")), data) == CODEX32_CONST\r\n\r\ndef ms32_create_checksum(data):\r\n    if len(data) > 80:\r\n        return codex32_create_long_checksum(\"ms\", data)\r\n    polymod = codex32_polymod(codex32_polymod(1, bech32_hrp_expand(\"ms\")), data + [0] * 13)\r\n    polymod = polymod ^ CODEX32_CONST\r\n    return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\r\n```\r\n\r\nAs you can see, I think it is up to the particular application to handle switching between the long codex32 format and the regular codex32 format.  ",
      "created_at": "2025-11-27T17:55:27Z",
      "updated_at": "2025-11-27T18:04:53Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569665206",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569665206"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569931236",
      "pull_request_review_id": 3516870732,
      "id": 2569931236,
      "node_id": "PRRC_kwDOAN28mc6ZLgnk",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We can't assume \"ms\" to know which checksum to verify.\r\n\r\nIf there's an `hrp` substitution error, we need to know which checksum is being used to detect/correct it, but if which checksum depends on which `hrp` application, instead of just codex32 string length, then we're stuck.\r\n\r\nThat made our length 96 exception a bug, as how can a decoder know this rule applies if it can't detect the integrity of what determines its applicability?\n\nWe need a `codex32_decode` function that if it validates it has the correct HRP or more than 8 errors, so applications can't choose their checksum, the format defines which to use.\r\n\r\nLike BIP-0173's HRP detection assumption, our error correction guarantee only applies to lower (or upper) 5 bits of HRP characters. As the swaps that produce an upper bit change are very unlikely. But we can guarantee to correct 2 \"double\" errors.",
      "created_at": "2025-11-27T20:41:13Z",
      "updated_at": "2025-11-30T17:35:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2569931236",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2569931236"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570037680",
      "pull_request_review_id": 3517015423,
      "id": 2570037680,
      "node_id": "PRRC_kwDOAN28mc6ZL6mw",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If we REQUIRE every registered HRP be unique in the lower 5 bits then:\r\n1. we don't have to ever distinguish errors in the high bits they're a lookup table, VALID_HRP.\r\n1. the expanded data we covered by the checksum will be < 93 single counting hrp characters.\r\n1. With the valid HRP table, Correcting errors in the low bits, corrects any errors in the high bits.\r\n1. We know which checksum is being used by the length of the string, which is far simpler than a per hrp (impossible) design or one that double weights hrp characters towards max_length.",
      "created_at": "2025-11-27T22:15:05Z",
      "updated_at": "2025-11-27T22:15:06Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570037680",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570037680"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570046707",
      "pull_request_review_id": 3517024161,
      "id": 2570046707,
      "node_id": "PRRC_kwDOAN28mc6ZL8zz",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> With the valid HRP table, Correcting errors in the low bits, corrects any errors in the high bits.\r\n\r\nIt's not that simple.  For maximum length codex32 string, errors in the high bits _appear_ as errors in the checksum at the end of the string because for BCH codes, any polynomial longer than the maximum length (93 in our case) effectively wraps around.\r\n\r\nEdit: And errors in the high bits are not going to be uncommon.  Let me tell you the number of times I've mistaken a `5` for an `S`.",
      "created_at": "2025-11-27T22:26:05Z",
      "updated_at": "2025-11-27T22:32:13Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570046707",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570046707"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570060471",
      "pull_request_review_id": 3517039360,
      "id": 2570060471,
      "node_id": "PRRC_kwDOAN28mc6ZMAK3",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Then let's guarantee to detect 8 errors, 13/15 if contiguous in the low bits, BIP-0173 style but not error correct the HRP.  Trying different suspected HRPs will have to be the way to correct a damaged prefix, like our rationale suggests doing.",
      "created_at": "2025-11-27T22:41:29Z",
      "updated_at": "2025-11-27T22:41:29Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570060471",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570060471"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570087842",
      "pull_request_review_id": 3517064987,
      "id": 2570087842,
      "node_id": "PRRC_kwDOAN28mc6ZMG2i",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "mistaking a 5 for an S in the HRP counts as two errors.",
      "created_at": "2025-11-27T23:18:44Z",
      "updated_at": "2025-11-27T23:18:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570087842",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570087842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570104655",
      "pull_request_review_id": 3517083570,
      "id": 2570104655,
      "node_id": "PRRC_kwDOAN28mc6ZMK9P",
      "diff_hunk": "@@ -97,29 +105,42 @@ def ms32_polymod(values):\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def ms32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return ms32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return ms32_polymod(bech32_hrp_expand(hrp) + data) == MS32_CONST\n     return False\n \n-def ms32_create_checksum(data):\n+def ms32_create_checksum(hrp, data):\n+    values = bech32_hrp_expand(hrp) + data\n     if len(data) > 80:                       # See Long codex32 Strings\n-        return ms32_create_long_checksum(data)\n-    values = data\n+        return ms32_create_long_checksum(values)\n     polymod = ms32_polymod(values + [0] * 13) ^ MS32_CONST\n     return [(polymod >> 5 * (12 - i)) & 31 for i in range(13)]\n </source>\n \n+This implements a [https://en.wikipedia.org/wiki/BCH_code BCH code] that\n+guarantees detection of '''any error affecting at most 8 characters'''\n+and has less than a 3 in 10<sup>19</sup> chance of failing to detect more\n+errors. The human-readable part is processed by first\n+feeding the higher bits of each character's US-ASCII value into the\n+checksum calculation followed by a zero and then the lower bits of each<ref>'''Why are the high bits of the human-readable part processed first?'''\n+This results in the actually checksummed data being ''[high hrp] 0 [low hrp] [data]''. This means that under the assumption that errors to the",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 107,
      "commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "original_commit_id": "aedb912bd17c0736b21accd84c3f5ce3e0b7d617",
      "in_reply_to_id": 2557120796,
      "user": {
        "login": "roconnor",
        "id": 852967,
        "node_id": "MDQ6VXNlcjg1Mjk2Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/852967?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/roconnor",
        "html_url": "https://github.com/roconnor",
        "followers_url": "https://api.github.com/users/roconnor/followers",
        "following_url": "https://api.github.com/users/roconnor/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/roconnor/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/roconnor/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/roconnor/subscriptions",
        "organizations_url": "https://api.github.com/users/roconnor/orgs",
        "repos_url": "https://api.github.com/users/roconnor/repos",
        "events_url": "https://api.github.com/users/roconnor/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/roconnor/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "BIP-0173 error detection doesn't tell you where the errors are.  In particular it doesn't tell whether the HRP is correct or not.  You need to invoke the error correction to find locations.  ",
      "created_at": "2025-11-27T23:34:07Z",
      "updated_at": "2025-11-27T23:34:08Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2570104655",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2570104655"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2575583321",
      "pull_request_review_id": 3523108086,
      "id": 2575583321,
      "node_id": "PRRC_kwDOAN28mc6ZhEhZ",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The short/long format must be format level.\n```python3\ndef codex32_encode(hrp, data, spec):\n    \"\"\"Compute a codex32 string given HRP and data values.\"\"\"\n    combined = data + codex32_create_checksum(hrp, data, spec)\n    return hrp + \"1\" + \"\".join([CHARSET[d] for d in combined])\n\ndef codex32_decode(codex=\"\"):\n    \"\"\"Validate a Codex32/Codex32 Long string, and dermine HRP and data.\"\"\"\n    if (any(ord(x) < 33 or ord(x) > 126 for x in codex)) or (\n        codex.lower() != codex and codex.upper() != codex\n    ):\n        return None, None, None\n    codex = codex.lower()\n    pos = codex.rfind(\"1\")\n    if pos < 1 or pos + 20 > len(codex) or pos + len(codex) > 1023:\n        return None, None, None\n    if not (codex[pos + 1].isdigit() and all(x in CHARSET for x in codex[pos + 1 :])):\n        return None, None, None\n    hrp = codex[:pos]\n    data = [CHARSET.index(x) for x in codex[pos + 1 :]]\n    spec = codex32_verify_checksum(hrp, data)\n    if spec is None or codex[pos + 1] == \"0\" and codex[pos + 6] != \"s\":\n        return None, None, None\n    return hrp, data[: -13 if spec is Encoding.CODEX32 else -15], spec\n```\n",
      "created_at": "2025-12-01T04:34:58Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2575583321",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2575583321"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622269244",
      "pull_request_review_id": 3523108086,
      "id": 2622269244,
      "node_id": "PRRC_kwDOAN28mc6cTKc8",
      "diff_hunk": "@@ -66,76 +66,85 @@ efficient to read out loud, write, type or to put into QR codes.</ref> format ca\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 94 characters long, and consists of:",
      "path": "bip-0093.mediawiki",
      "position": 10,
      "original_position": 10,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Going forward with covering `[low hrp] [data]` because it's simplest to know which checksum to use.\n\nIf the registry is curated so every HRP differs in `[low hrp]` our error correction properties remain applicable, if not from the code itself, from lookup against the registry if an application chooses to implement this capability where it can assume the data is codex32.",
      "created_at": "2025-12-16T08:21:03Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622269244",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622269244"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 69,
      "original_line": 69,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622285076",
      "pull_request_review_id": 3523108086,
      "id": 2622285076,
      "node_id": "PRRC_kwDOAN28mc6cTOUU",
      "diff_hunk": "@@ -66,76 +66,85 @@ efficient to read out loud, write, type or to put into QR codes.</ref> format ca\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 94 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173.\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n-\n-As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n-Note that per BIP-0173, the lowercase form is used when determining a character's value for checksum purposes.\n-In particular, given an all uppercase codex32 string, we still use lowercase <code>ms</code> as the human-readable part during checksum construction.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 73 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)",
      "path": "bip-0093.mediawiki",
      "position": 27,
      "original_position": 27,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I dislike this sentence as total length determines the switch now, not payload, which is not even required. Although should be for shares otherwise what was the point? Don't know how to fix it without making this ugly maybe just \"which is a sequence of bech32 characters.\" and move the (However, see '''Long codex32'''...) to L69 after \"at most 94 characters long\"",
      "created_at": "2025-12-16T08:26:46Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622285076",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622285076"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622312014",
      "pull_request_review_id": 3523108086,
      "id": 2622312014,
      "node_id": "PRRC_kwDOAN28mc6cTU5O",
      "diff_hunk": "@@ -59,67 +59,83 @@ However, BIP-0039 has no error-correcting ability, cannot sensibly be extended t\n \n ==Specification==\n \n+We first describe the general checksummed base32<ref>'''Why use base32 at all?''' The lack of mixed case makes it more\n+efficient to read out loud, write, type or to put into QR codes.</ref> format called\n+''codex32'' and then define a BIP-0032 master seed encoding using it.\n+\n ===codex32===\n \n A codex32 string is similar to a bech32 string defined in [https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki BIP-0173].\n-It reuses the base-32 character set from BIP-0173, and consists of:\n-\n-* A human-readable part, which is the string \"ms\" (or \"MS\").\n-* A separator, which is always \"1\".\n-* A data part which is in turn subdivided into:\n-** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+It reuses the base-32 character set from BIP-0173, is at most 96 characters long, and consists of:\n+* The '''human-readable part''', as specified in BIP-0173, which is further restricted by this specification to 174 US-ASCII characters.\n+**Strings of total length 95 or 96 MUST use the HRP \"ms\" (or \"MS\").\n+* The '''separator''', as specified in BIP-0173, which is always \"1\".\n+* The '''data part''', which is at least 19 bech32 characters long and is in turn subdivided into:\n+** The '''threshold parameter''', which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n *** If the threshold parameter is \"0\" then the share index, defined below, MUST have a value of \"s\" (or \"S\").\n-** An identifier consisting of 4 bech32 characters.\n-** A share index, which is any bech32 character. Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n-** A payload which is a sequence of up to 74 bech32 characters. (However, see '''Long codex32 Strings''' below for an exception to this limit.)\n-** A checksum which consists of 13 bech32 characters as described below.\n+** The '''identifier''', which consists of 4 bech32 characters.\n+** The '''share index''', which is any bech32 character.\n+***Note that a share index value of \"s\" (or \"S\") is special and denotes the unshared secret (see section \"Unshared Secret\").\n+** The '''payload''', which is a sequence of 0 to 74 bech32 characters. (However, see '''Long codex32''' below for an exception to this limit.)\n+** The '''checksum''', which consists of 13 bech32 characters as described below.\n \n As with bech32 strings, a codex32 string MUST be entirely uppercase or entirely lowercase.\n+Decoders MUST use the lowercase form of the human-readable part during checksum verification.\n For presentation, lowercase is usually preferable, but uppercase SHOULD be used for handwritten codex32 strings.\n If a codex32 string is encoded in a QR code, it SHOULD use the uppercase form, as this is encoded more compactly.\n \n ===Checksum===\n \n The last thirteen characters of the data part form a checksum and contain no information.\n Valid strings MUST pass the criteria for validity specified by the Python 3 code snippet below.\n-The function <code>ms32_verify_checksum</code> must return true when its argument is the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173.\n+The function <code>codex32_verify_checksum</code> must return true when its arguments are:\n+* <tt>hrp</tt>: the human-readable part as a string\n+* <tt>data</tt>: the data part as a list of integers representing the characters converted using the bech32 character table from BIP-0173\n \n-To construct a valid checksum given the data-part characters (excluding the checksum), the <code>ms32_create_checksum</code> function can be used.\n+To construct a valid checksum given the human-readable part and data-part characters (excluding the checksum), the <code>codex32_create_checksum</code> function can be used.\n \n <source lang=\"python\">\n-MS32_CONST = 0x10ce0795c2fd1e62a\n+CODEX32_CONST = 0x10ce0795c2fd1e62a\n \n-def ms32_polymod(values):\n+def codex32_polymod(values):\n     GEN = [\n         0x19dc500ce73fde210,\n         0x1bfae00def77fe529,\n         0x1fbd920fffe7bee52,\n         0x1739640bdeee3fdad,\n         0x07729a039cfc75f5a,\n     ]\n-    residue = 0x23181b3\n+    residue = 1\n     for v in values:\n         b = (residue >> 60)\n         residue = (residue & 0x0fffffffffffffff) << 5 ^ v\n         for i in range(5):\n             residue ^= GEN[i] if ((b >> i) & 1) else 0\n     return residue\n \n-def ms32_verify_checksum(data):\n+def bech32_hrp_expand(s):\n+  return [ord(x) >> 5 for x in s] + [0] + [ord(x) & 31 for x in s]\n+\n+def codex32_verify_checksum(hrp, data):\n     if len(data) >= 96:                      # See Long codex32 Strings\n-        return ms32_verify_long_checksum(data)\n+        return codex32_verify_long_checksum(bech32_hrp_expand(hrp) + data)\n     if len(data) <= 93:\n-        return ms32_polymod(data) == MS32_CONST\n+        return codex32_polymod(bech32_hrp_expand(hrp) + data) == CODEX32_CONST\n     return False",
      "path": "bip-0093.mediawiki",
      "position": 82,
      "original_position": 101,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "3123cead1d0d92edbc9e3e89814bd57ee1d1467d",
      "in_reply_to_id": 2567413699,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I can probably write this code out if you want, but my thoughts are we should have `codex32_decode`, an independent `long_codex32_decode` and an `ms_decode` that can call both of them.\n\nYes to `ms_decode` but that one should go all the way to bytes. Do we add it to this PR in the master seed format section along with `ms_encode`?\nI'd prefer if `codex32_decode` returned a `spec` it's a hassle to check the string length everywhere to know which checksum is being used. But the code in my latest commit isn't ugly.",
      "created_at": "2025-12-16T08:36:26Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622312014",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622312014"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 123,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622375960",
      "pull_request_review_id": 3523108086,
      "id": 2622375960,
      "node_id": "PRRC_kwDOAN28mc6cTkgY",
      "diff_hunk": "@@ -295,50 +309,51 @@ With this set of ''k'' shares, new shares can be derived as discussed above. Thi\n Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n # Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n #* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every set of shares the user may need to disambiguate\n # Set the share index to <code>s</code>\n # Set the payload to a bech32 encoding of the secret data, padded with arbitrary bits\n # Generate a valid checksum in accordance with the Checksum section\n \n-Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same threshold value, the same identifier, and a distinct share index.\n+Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same human-readable part, the same threshold value, the same identifier, and a distinct share index.\n These shares should be generated as described in the \"fresh secret\" section.\n \n The codex32 secret and the ''k''-1 codex32 shares form a set of ''k'' valid initial codex32 strings from which additional shares can be derived as described above.\n \n ===Long codex32===\n \n The 13 character checksum design only supports up to 80 data characters.\n-Excluding the threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.\n+Excluding the human-readable part, threshold, identifier and index characters, this limits the payload to 74 characters or 46 bytes.",
      "path": "bip-0093.mediawiki",
      "position": 261,
      "original_position": 261,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "72 characters or 45 bytes now. hrp can be length 1 but 73 has an incomplete group.",
      "created_at": "2025-12-16T08:55:53Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622375960",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622375960"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 328,
      "original_line": 328,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622385550",
      "pull_request_review_id": 3523108086,
      "id": 2622385550,
      "node_id": "PRRC_kwDOAN28mc6cTm2O",
      "diff_hunk": "@@ -295,50 +309,51 @@ With this set of ''k'' shares, new shares can be derived as discussed above. Thi\n Before generating shares for an existing secret, it first must be codex32-encoded.\n The conversion process consists of:\n \n+# Choose a human-readable part according to application (Use \"ms\" for BIP-0032 master seeds)\n # Choose a threshold value ''k'' between 2 and 9, inclusive\n # Choose a 4 bech32 character identifier\n #* We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every set of shares the user may need to disambiguate\n # Set the share index to <code>s</code>\n # Set the payload to a bech32 encoding of the secret data, padded with arbitrary bits\n # Generate a valid checksum in accordance with the Checksum section\n \n-Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same threshold value, the same identifier, and a distinct share index.\n+Along with the codex32 secret, the user must generate ''k''-1 other codex32 shares, each with the same human-readable part, the same threshold value, the same identifier, and a distinct share index.\n These shares should be generated as described in the \"fresh secret\" section.\n \n The codex32 secret and the ''k''-1 codex32 shares form a set of ''k'' valid initial codex32 strings from which additional shares can be derived as described above.\n \n ===Long codex32===\n \n The 13 character checksum design only supports up to 80 data characters.",
      "path": "bip-0093.mediawiki",
      "position": 259,
      "original_position": 259,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I kept the use of \"data characters\" but it really means `[low hrp] [data]` now. Do we need to change that everywhere?",
      "created_at": "2025-12-16T08:58:40Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622385550",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622385550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 327,
      "original_line": 327,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622393486",
      "pull_request_review_id": 3523108086,
      "id": 2622393486,
      "node_id": "PRRC_kwDOAN28mc6cToyO",
      "diff_hunk": "",
      "path": "bip-0093.mediawiki",
      "position": 1,
      "original_position": 1,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Needs update to \"between 75 and 1001 bech32 characters.",
      "created_at": "2025-12-16T09:00:45Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622393486",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622393486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 366,
      "original_line": 366,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622398301",
      "pull_request_review_id": 3523108086,
      "id": 2622398301,
      "node_id": "PRRC_kwDOAN28mc6cTp9d",
      "diff_hunk": "@@ -353,11 +368,28 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 data characters.",
      "path": "bip-0093.mediawiki",
      "position": 302,
      "original_position": 302,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Change \"data part\" to \"length\" and add 1 for the separator.",
      "created_at": "2025-12-16T09:02:13Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622398301",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622398301"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 369,
      "original_line": 369,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622408648",
      "pull_request_review_id": 3523108086,
      "id": 2622408648,
      "node_id": "PRRC_kwDOAN28mc6cTsfI",
      "diff_hunk": "@@ -353,11 +368,28 @@ A long codex32 string follows the same specification as a regular codex32 string\n \n A codex32 string with a data part of 94 or 95 characters is never legal as a regular codex32 string is limited to 93 data characters and a long codex32 string is at least 96 data characters.\n \n-Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>ms32_interpolate</code> function.\n+Generation of long shares and recovery of the long secret from long shares proceeds in exactly the same way as for regular shares with the <code>codex32_interpolate</code> function.\n \n The long checksum is designed to be an error correcting code that can correct up to 4 character substitutions, up to 8 unreadable characters (called erasures), or up to 15 consecutive erasures.\n As with regular checksums we do not specify how an implementation should implement error correction, and all our recommendations for error correction of regular codex32 strings also apply to long codex32 strings.\n \n+===Master seed format===\n+\n+When the human-readable part of a valid codex32 secret (converted to lowercase) is the string \"ms\", we call it a codex32-encoded master seed or secret seed. The payload in this case is a direct encoding of a BIP-0032 HD master seed.\n+\n+A secret seed is a codex32 encoding of:\n+\n+* The human-readable part \"ms\" for master seed.\n+* The data-part values:\n+** A threshold parameter, which MUST be a single digit between \"2\" and \"9\", or the digit \"0\".\n+** An identifier consisting of 4 bech32 characters.\n+*** We do not define how to choose the identifier, beyond noting that it SHOULD be distinct for every master seed and share set the user may need to disambiguate.\n+** The share index \"s\".\n+** A conversion of the 16-to-64-byte BIP-0032 HD master seed to bech32:\n+*** Start with the bits of the master seed, most significant bit per byte first.\n+*** Re-arrange those bits into groups of 5, and pad with arbitrary bits at the end if needed.\n+*** Translate those bits to characters using the bech32 character table from BIP-0173.\n+",
      "path": "bip-0093.mediawiki",
      "position": 326,
      "original_position": 326,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Delete this duplicate section.",
      "created_at": "2025-12-16T09:05:06Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622408648",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622408648"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": 376,
      "original_start_line": 376,
      "start_side": "RIGHT",
      "line": 392,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622416656",
      "pull_request_review_id": 3523108086,
      "id": 2622416656,
      "node_id": "PRRC_kwDOAN28mc6cTucQ",
      "diff_hunk": "@@ -439,6 +471,15 @@ Instead, users who wish to switch to codex32 should generate a fresh seed and sw\n Our [https://github.com/BlockstreamResearch/codex32  reference implementation repository] contains implementations in Rust and PostScript.\n The inline code in this BIP text can be used as a Python reference.\n \n+==Registered Human-readable Prefixes==\n+\n+SatoshiLabs maintains a full list of registered human-readable parts for other uses of codex32:\n+\n+[https://github.com/satoshilabs/slips/blob/master/slip-0173.md#uses-of-codex32 SLIP-0173 : Registered human-readable parts for BIP-0093]\n+\n+The sequence of lower 5 bits of each character's US-ASCII value in a registered codex32 human-readable part SHOULD be unique.",
      "path": "bip-0093.mediawiki",
      "position": 355,
      "original_position": 355,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This sentence is a mouthful, I'll need to think about how to say it more clearly.",
      "created_at": "2025-12-16T09:07:35Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622416656",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622416656"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 480,
      "original_line": 480,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622428122",
      "pull_request_review_id": 3523108086,
      "id": 2622428122,
      "node_id": "PRRC_kwDOAN28mc6cTxPa",
      "diff_hunk": "@@ -548,6 +589,41 @@ payload (bech32): <code>M32ZXFGUHPCHTLUPZRY9X8GF2TVDW0S3JN54KHCE6MUA7LQPZYGSFJD6\n * Master seed (hex): <code>dc5423251cb87175ff8110c8531d0952d8d73e1194e95b5f19d6f9df7c01111104c9baecdfea8cccc677fb9ddc8aec5553b86e528bcadfdcc201c17c638c47e9</code>\n * master node xprv: <code>xprv9s21ZrQH143K4UYT4rP3TZVKKbmRVmfRqTx9mG2xCy2JYipZbkLV8rwvBXsUbEv9KQiUD7oED1Wyi9evZzUn2rqK9skRgPkNaAzyw3YrpJN</code>\n \n+===Test vector 6===\n+\n+This example shows converting an existing 256-bit Core Lightning HSM secret into a codex32 secret using a human-readable part of <code>cl</code> and an identifier of <code>luea</code> and then relabeling the secret. Four zero bits are appended in order to obtain 52 bech32 payload characters (260 bits of data) from the 256-bit HSM secret.\n+\n+Core Lightning HSM secret (hex): <code>83634b3b43a3734b73396989980000000000000000000000000000000000000000</code>\n+\n+* payload: <code>d35kw6r5de5kueedxyesqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq</code>\n+* checksum: <code>anvrktzhlhusz</code>\n+* codex32-encoded HSM secret: <code>cl10lueasd35kw6r5de5kueedxyesqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqanvrktzhlhusz</code>\n+\n+Note the identifier choice is arbitrary, any identifier would have been valid; however a different identifier produces a different checksum. For example:\n+\n+* identifier: <code>cln2</code>\n+* checksum: <code>n9lcvcu7cez4s</code>\n+* codex32-encoded HSM secret: <code>cl10cln2sd35kw6r5de5kueedxyesqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqn9lcvcu7cez4s</code>\n+\n+===Test vector 7===\n+\n+This example shows the codex32 format, when used with a different human-readable part.\n+The payload contains 52 bech32 characters, which corresponds to 260 bits. We truncate the last four bits in order to obtain a 256-bit HSM secret.\n+\n+codex32-encoded HSM secret (bech32): <code>cl10peevst6cqh0wu7p5ssjyf4z4ez42ks9jlt3zneju9uuypr2hddak6tlqsjhsks4laxts8q</code>\n+\n+* human-readable part: <code>cl</code>\n+* separator: <code>1</code>\n+* k value: <code>0</code> (no secret splitting)\n+* identifier: <code>peev</code>\n+* share index: <code>s</code> (the secret)\n+* payload: <code>t6cqh0wu7p5ssjyf4z4ez42ks9jlt3zneju9uuypr2hddak6tlqs</code>\n+* checksum: <code>jhsks4laxts8q</code>\n+* HSM secret (hex): <code>82f5805deee7834842444d455c8aaab40b2fae229e65c2f38408d576b7b6d2fe08</code>\n+\n+\n+\n+\n ===Invalid test vectors===",
      "path": "bip-0093.mediawiki",
      "position": 400,
      "original_position": 400,
      "commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "original_commit_id": "8e4256807d81dde5531dc9593667c86700050dfc",
      "in_reply_to_id": null,
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm working on a list of BIP-0173 style valid and invalid vectors and will add them when complete.",
      "created_at": "2025-12-16T09:10:56Z",
      "updated_at": "2025-12-16T09:20:36Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2040#discussion_r2622428122",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2622428122"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2040"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 627,
      "original_line": 627,
      "side": "RIGHT"
    }
  ]
}