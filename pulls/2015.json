{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/2015",
    "id": 2933286538,
    "node_id": "PR_kwDOAN28mc6u1maK",
    "html_url": "https://github.com/bitcoin/bips/pull/2015",
    "diff_url": "https://github.com/bitcoin/bips/pull/2015.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/2015.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2015",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/2015/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/0777a81367e36dd16af101fb264af141f199e86a",
    "number": 2015,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "BIP54: Consensus Cleanup test vectors",
    "user": {
      "login": "darosior",
      "id": 22457751,
      "node_id": "MDQ6VXNlcjIyNDU3NzUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/darosior",
      "html_url": "https://github.com/darosior",
      "followers_url": "https://api.github.com/users/darosior/followers",
      "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
      "organizations_url": "https://api.github.com/users/darosior/orgs",
      "repos_url": "https://api.github.com/users/darosior/repos",
      "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/darosior/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This introduces test vectors for BIP54. There is one set of vectors per each of the 4 mitigations.\r\n\r\nThe vectors were generated using the BIP54 implementation against Bitcoin Inquisition available [here](https://github.com/bitcoin-inquisition/bitcoin/pull/99), as well as a custom miner as a Bitcoin Core unit test available [here](https://github.com/darosior/bitcoin/commits/bip54_miner/). Documentation is provided with more details about each set of test vectors and describing how to use them.",
    "labels": [
      {
        "id": 275846070,
        "node_id": "MDU6TGFiZWwyNzU4NDYwNzA=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Proposed%20BIP%20modification",
        "name": "Proposed BIP modification",
        "color": "5319e7",
        "default": false
      }
    ],
    "created_at": "2025-10-21T12:56:29Z",
    "updated_at": "2025-11-25T23:19:31Z",
    "closed_at": "2025-11-25T17:56:13Z",
    "mergeable_state": "unknown",
    "merged": true,
    "merged_at": "2025-11-25T17:56:13Z",
    "merged_by": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "merge_commit_sha": "2624ef7b83dd1241f283f14d5f5f72456224eb85",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "darosior:2509_consensus_cleanup_test_vectors",
      "ref": "2509_consensus_cleanup_test_vectors",
      "sha": "0777a81367e36dd16af101fb264af141f199e86a",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 208778505,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMDg3Nzg1MDU=",
        "name": "bips",
        "full_name": "darosior/bips",
        "owner": {
          "login": "darosior",
          "id": 22457751,
          "node_id": "MDQ6VXNlcjIyNDU3NzUx",
          "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/darosior",
          "html_url": "https://github.com/darosior",
          "followers_url": "https://api.github.com/users/darosior/followers",
          "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
          "organizations_url": "https://api.github.com/users/darosior/orgs",
          "repos_url": "https://api.github.com/users/darosior/repos",
          "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/darosior/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/darosior/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/darosior/bips",
        "archive_url": "https://api.github.com/repos/darosior/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/darosior/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/darosior/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/darosior/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/darosior/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/darosior/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/darosior/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/darosior/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/darosior/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/darosior/bips/contributors",
        "deployments_url": "https://api.github.com/repos/darosior/bips/deployments",
        "downloads_url": "https://api.github.com/repos/darosior/bips/downloads",
        "events_url": "https://api.github.com/repos/darosior/bips/events",
        "forks_url": "https://api.github.com/repos/darosior/bips/forks",
        "git_commits_url": "https://api.github.com/repos/darosior/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/darosior/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/darosior/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/darosior/bips.git",
        "issue_comment_url": "https://api.github.com/repos/darosior/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/darosior/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/darosior/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/darosior/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/darosior/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/darosior/bips/languages",
        "merges_url": "https://api.github.com/repos/darosior/bips/merges",
        "milestones_url": "https://api.github.com/repos/darosior/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/darosior/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/darosior/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/darosior/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:darosior/bips.git",
        "stargazers_url": "https://api.github.com/repos/darosior/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/darosior/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/darosior/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/darosior/bips/subscription",
        "tags_url": "https://api.github.com/repos/darosior/bips/tags",
        "teams_url": "https://api.github.com/repos/darosior/bips/teams",
        "trees_url": "https://api.github.com/repos/darosior/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/darosior/bips.git",
        "hooks_url": "https://api.github.com/repos/darosior/bips/hooks",
        "svn_url": "https://github.com/darosior/bips",
        "homepage": "bitcoin.org",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 18480,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-25T23:18:39Z",
        "created_at": "2019-09-16T11:02:25Z",
        "updated_at": "2025-03-27T12:51:10Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "c9a6ca6297eb8de850f6b64dafb8e60ee9b64d66",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5828,
        "stargazers_count": 10380,
        "watchers_count": 10380,
        "size": 18452,
        "default_branch": "master",
        "open_issues_count": 71,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-25T17:56:13Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2025-11-25T17:56:19Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 26112,
    "deletions": 1,
    "changed_files": 6,
    "commits": 3,
    "review_comments": 18,
    "comments": 4
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDg5ZGZlMDNhNjQ0OGE1MzliYjQ4NzQ1MTkyMWI5NTBlN2VjZTQ3MmM",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/89dfe03a6448a539bb487451921b950e7ece472c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/89dfe03a6448a539bb487451921b950e7ece472c",
      "tree": {
        "sha": "fca35f53b12a31c8d7dfd517ec8326d85fc87974",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/fca35f53b12a31c8d7dfd517ec8326d85fc87974"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/869fd7765fcb2a5899a9f4d166e4df6f65e8c771",
          "sha": "869fd7765fcb2a5899a9f4d166e4df6f65e8c771",
          "html_url": "https://github.com/bitcoin/bips/commit/869fd7765fcb2a5899a9f4d166e4df6f65e8c771"
        }
      ],
      "message": "bip-0054: add a reference implementation section",
      "committer": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-10-20T12:53:51Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-10-19T03:43:11Z"
      },
      "sha": "89dfe03a6448a539bb487451921b950e7ece472c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDMwYjAwODQ4MDhmNjZhZWNmZDY3ZmNlY2VkZDgzYjk4ZDU3ZDNlMDc",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/30b0084808f66aecfd67fcecedd83b98d57d3e07",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/30b0084808f66aecfd67fcecedd83b98d57d3e07",
      "tree": {
        "sha": "d5cc61ea50b677dc598a53405fa95ddb8646603f",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/d5cc61ea50b677dc598a53405fa95ddb8646603f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/89dfe03a6448a539bb487451921b950e7ece472c",
          "sha": "89dfe03a6448a539bb487451921b950e7ece472c",
          "html_url": "https://github.com/bitcoin/bips/commit/89dfe03a6448a539bb487451921b950e7ece472c"
        }
      ],
      "message": "bip-0054: add test vectors for each mitigation\n\nThis introduces a set of test vectors for each of the 4 mitigations in the BIP. The sigops and\ntransaction size vectors were generated using the unit tests included with the Bitcoin Core\nimplementation of BIP54, available at https://github.com/darosior/bitcoin/tree/2509_inquisition_consensus_cleanup.\nThe timestamps and coinbases required mainnet blocks for maximum compatibility, and were generated\nby two dedicated unit tests not included with the Bitcoin Core implementation above but available at\nhttps://github.com/darosior/bitcoin/tree/bip54_miner.",
      "committer": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-10-20T12:53:57Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-09-16T19:03:36Z"
      },
      "sha": "30b0084808f66aecfd67fcecedd83b98d57d3e07"
    },
    {
      "event": "labeled",
      "id": 20406732448,
      "node_id": "LE_lADOAN28mc7SybYWzwAAAATAVgag",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/20406732448",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T14:29:42Z",
      "label": {
        "name": "Proposed BIP modification",
        "color": "5319e7"
      }
    },
    {
      "event": "reviewed",
      "id": 3361510159,
      "node_id": "PRR_kwDOAN28mc7IXJMP",
      "url": null,
      "actor": null,
      "commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-21T16:13:27Z",
      "author_association": "MEMBER",
      "body": "Concept ACK, successfully built the test branch at  https://github.com/darosior/bitcoin/blob/2509_inquisition_consensus_cleanup and ran the unit and functional tests.\n\n```\n$ ./build/bin/test_bitcoin --run_test=bip54_tests\nRunning 4 test cases...\n\n*** No errors detected\n```\n\n```\n$ ./build/test/functional/feature_bip54.py     \n2025-10-21T16:05:13.483000Z TestFramework (INFO): PRNG seed is: 80635940825195715\n2025-10-21T16:05:13.483000Z TestFramework (INFO): Initializing test directory /var/folders/bz/mn3hr6td37bczwp7j89frs4w0000gn/T/bitcoin_func_test_dznr0x1z\n2025-10-21T16:05:14.300000Z TestFramework (INFO): BIP54 tests before activation\n2025-10-21T16:05:14.558000Z TestFramework (INFO): Activating BIP54\n2025-10-21T16:05:14.745000Z TestFramework (INFO): BIP54 tests after activation\n2025-10-21T16:05:15.296000Z TestFramework (INFO): Stopping nodes\n2025-10-21T16:05:15.460000Z TestFramework (INFO): Cleaning up /var/folders/bz/mn3hr6td37bczwp7j89frs4w0000gn/T/bitcoin_func_test_dznr0x1z on exit\n2025-10-21T16:05:15.460000Z TestFramework (INFO): Tests successful\n```\n\nAre the functional tests worth mentioning in the test_vectors README? Perhaps with some of the content in the commit message:\n\n    The previously introduced unit tests extensively test the specific implementation of each\n    mitigation. This functional test complements them by sanity checking all mitigations in a \"black\n    box\" manner. For the added timestamp constraints, it mimicks how they would get exploited (by\n    implementing pseudo timewarp and Murch-Zawy attacks) and demonstrates those exploits are not\n    possible anymore after BIP54 activates.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#pullrequestreview-3361510159",
      "submitted_at": "2025-10-21T16:13:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
    },
    {
      "event": "reviewed",
      "id": 3364117315,
      "node_id": "PRR_kwDOAN28mc7IhFtD",
      "url": null,
      "actor": null,
      "commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-22T07:57:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Looks good, see nit",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#pullrequestreview-3364117315",
      "submitted_at": "2025-10-22T07:57:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDA3NzdhODEzNjdlMzZkZDE2YWYxMDFmYjI2NGFmMTQxZjE5OWU4NmE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/0777a81367e36dd16af101fb264af141f199e86a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/0777a81367e36dd16af101fb264af141f199e86a",
      "tree": {
        "sha": "0b0f328f07cc50a5f0f72e97833e9eb1a33bddb6",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/0b0f328f07cc50a5f0f72e97833e9eb1a33bddb6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/30b0084808f66aecfd67fcecedd83b98d57d3e07",
          "sha": "30b0084808f66aecfd67fcecedd83b98d57d3e07",
          "html_url": "https://github.com/bitcoin/bips/commit/30b0084808f66aecfd67fcecedd83b98d57d3e07"
        }
      ],
      "message": "bip-0054: document the test vectors",
      "committer": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-10-27T08:10:26Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-10-19T03:47:18Z"
      },
      "sha": "0777a81367e36dd16af101fb264af141f199e86a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20518314986,
      "node_id": "HRFPE_lADOAN28mc7SybYWzwAAAATG_KPq",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/20518314986",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "commit_url": "https://api.github.com/repos/darosior/bips/commits/0777a81367e36dd16af101fb264af141f199e86a",
      "created_at": "2025-10-27T08:10:43Z"
    },
    {
      "event": "commented",
      "id": 3449992226,
      "node_id": "IC_kwDOAN28mc7NorQi",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3449992226",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T08:12:05Z",
      "updated_at": "2025-10-27T08:12:05Z",
      "author_association": "MEMBER",
      "body": "> Are the functional tests worth mentioning in the test_vectors README?\r\n\r\nNo, i don't think so. The functional test sanity checks the implementation with a blackbox approach, but does not implement test vectors. Hence they don't need to be mentioned in the test vectors README.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#issuecomment-3449992226",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2015"
    },
    {
      "event": "reviewed",
      "id": 3397426563,
      "node_id": "PRR_kwDOAN28mc7KgJ2D",
      "url": null,
      "actor": null,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-30T04:51:37Z",
      "author_association": "NONE",
      "body": "Started to review the code and test coverage on the branch in bitcoin-inquisition.\r\n\r\nFor the current `bip-0054.md`, maybe it could be valuable to have an editorial refinement of the “Specification” section where the new rules are each categorized in its section (“difficulty adjustement fix”, “long block validation time fix”, \"merkle tree malleability fix” and “duplicate coinbase tx”) as it’s done for the `test-vectors/README.md`”. Believing it’s fruitful to review that for each line of specification, and corresponding line of code, there is adequate test coverage.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#pullrequestreview-3397426563",
      "submitted_at": "2025-10-30T04:51:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
    },
    {
      "event": "unsubscribed",
      "id": 20814959984,
      "node_id": "UE_lADOAN28mc7SybYWzwAAAATYqxVw",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/20814959984",
      "actor": {
        "login": "alex-fang",
        "id": 4167973,
        "node_id": "MDQ6VXNlcjQxNjc5NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4167973?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alex-fang",
        "html_url": "https://github.com/alex-fang",
        "followers_url": "https://api.github.com/users/alex-fang/followers",
        "following_url": "https://api.github.com/users/alex-fang/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alex-fang/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alex-fang/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alex-fang/subscriptions",
        "organizations_url": "https://api.github.com/users/alex-fang/orgs",
        "repos_url": "https://api.github.com/users/alex-fang/repos",
        "events_url": "https://api.github.com/users/alex-fang/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alex-fang/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-09T01:12:12Z"
    },
    {
      "event": "reviewed",
      "id": 3440470554,
      "node_id": "PRR_kwDOAN28mc7NEWoa",
      "url": null,
      "actor": null,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-10T00:23:45Z",
      "author_association": "NONE",
      "body": "I had a first overview on all the test vector files (`timestamps.json`, `sigops.json`, `txsize.json` and `coinbases.json`). Left already few comments, and I’ll pursue review on the code implementation on bitcoin-inquisition.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#pullrequestreview-3440470554",
      "submitted_at": "2025-11-10T00:23:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
    },
    {
      "event": "commented",
      "id": 3576205710,
      "node_id": "IC_kwDOAN28mc7VKJGO",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3576205710",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T15:20:29Z",
      "updated_at": "2025-11-25T15:20:29Z",
      "author_association": "MEMBER",
      "body": "Thanks for the comments. There are some suggestions that i believe to be overkill, but i think may be worth including: the marginal cost of an additional test case is overall quite low and if even the slightest reduction in risk of a bug in consensus code is probably worth it.\r\n\r\nThat said i think those can wait for a follow-up. I think what's here is a pretty solid base for anyone to start testing an implementation, and that the more overkill test cases can wait for now. I am also waiting for more feedback, and want to address all of it an once since it will require re-mining a bunch of blocks/headers.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#issuecomment-3576205710",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2015"
    },
    {
      "event": "merged",
      "id": 21170743878,
      "node_id": "ME_lADOAN28mc7SybYWzwAAAATt3-pG",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21170743878",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2624ef7b83dd1241f283f14d5f5f72456224eb85",
      "commit_url": "https://api.github.com/repos/bitcoin/bips/commits/2624ef7b83dd1241f283f14d5f5f72456224eb85",
      "created_at": "2025-11-25T17:56:13Z"
    },
    {
      "event": "closed",
      "id": 21170743902,
      "node_id": "CE_lADOAN28mc7SybYWzwAAAATt3-pe",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21170743902",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T17:56:13Z"
    },
    {
      "event": "commented",
      "id": 3576846531,
      "node_id": "IC_kwDOAN28mc7VMljD",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3576846531",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T17:56:57Z",
      "updated_at": "2025-11-25T17:56:57Z",
      "author_association": "MEMBER",
      "body": "Feel free to continue the review discussion here until an eventual follow-up is opened.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#issuecomment-3576846531",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2015"
    },
    {
      "event": "commented",
      "id": 3577151135,
      "node_id": "IC_kwDOAN28mc7VNv6f",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3577151135",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T19:05:29Z",
      "updated_at": "2025-11-25T19:05:29Z",
      "author_association": "MEMBER",
      "body": "Ironic that this PR's number is 2015, the number of block intervals considered by the difficulty adjustment instead of 2016, which opens up the Timewarp attack fixed in BIP 54. :smile: ",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#issuecomment-3577151135",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2015"
    },
    {
      "event": "reviewed",
      "id": 3507196197,
      "node_id": "PRR_kwDOAN28mc7RC5El",
      "url": null,
      "actor": null,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T22:41:43Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Christewart",
        "id": 3514957,
        "node_id": "MDQ6VXNlcjM1MTQ5NTc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3514957?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Christewart",
        "html_url": "https://github.com/Christewart",
        "followers_url": "https://api.github.com/users/Christewart/followers",
        "following_url": "https://api.github.com/users/Christewart/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Christewart/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Christewart/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Christewart/subscriptions",
        "organizations_url": "https://api.github.com/users/Christewart/orgs",
        "repos_url": "https://api.github.com/users/Christewart/repos",
        "events_url": "https://api.github.com/users/Christewart/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Christewart/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2015#pullrequestreview-3507196197",
      "submitted_at": "2025-11-25T22:41:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
    },
    {
      "event": "head_ref_deleted",
      "id": 21176253812,
      "node_id": "HRDE_lADOAN28mc7SybYWzwAAAATuM_10",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21176253812",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T23:16:44Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2448855597",
      "pull_request_review_id": 3361510159,
      "id": 2448855597,
      "node_id": "PRRC_kwDOAN28mc6R9pIt",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 1,
      "original_position": 4,
      "commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\npresents them in more detail.\n```",
      "created_at": "2025-10-21T15:54:48Z",
      "updated_at": "2025-10-21T16:13:27Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2448855597",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2448855597"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2450759000",
      "pull_request_review_id": 3364117315,
      "id": 2450759000,
      "node_id": "PRRC_kwDOAN28mc6SE51Y",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Possibility of duplicate coinbase transactions\n+\n+The [`coinbases.json`](./coinbases.json) file contains test cases exercising the new restrictions on\n+coinbase transactions introduced in BIP54 to prevent duplicate coinbase transactions without\n+resorting to BIP30 validation. Each test case contains a chain of mainnet blocks (including the\n+genesis block), and whether this block chain is valid according to BIP54. All test cases are valid\n+according to current Bitcoin's consensus rules, except one that features a block containing a\n+coinbase transaction timelocked to a future block height.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 88,
      "original_position": 88,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Should there then perhaps also be a test case that has a coinbase transaction locked to a block height that is lower than required?",
      "created_at": "2025-10-22T07:53:30Z",
      "updated_at": "2025-10-22T07:57:15Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2450759000",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2450759000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": 86,
      "original_start_line": 86,
      "start_side": "RIGHT",
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2450936314",
      "pull_request_review_id": 3364334506,
      "id": 2450936314,
      "node_id": "PRRC_kwDOAN28mc6SFlH6",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Possibility of duplicate coinbase transactions\n+\n+The [`coinbases.json`](./coinbases.json) file contains test cases exercising the new restrictions on\n+coinbase transactions introduced in BIP54 to prevent duplicate coinbase transactions without\n+resorting to BIP30 validation. Each test case contains a chain of mainnet blocks (including the\n+genesis block), and whether this block chain is valid according to BIP54. All test cases are valid\n+according to current Bitcoin's consensus rules, except one that features a block containing a\n+coinbase transaction timelocked to a future block height.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 88,
      "original_position": 88,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": 2450759000,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There definitely *was* one but looks like i messed up somewhere in re-generating the vectors. Will re-add it, thank you.",
      "created_at": "2025-10-22T08:37:58Z",
      "updated_at": "2025-10-22T08:37:58Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2450936314",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2450936314"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": 86,
      "original_start_line": 86,
      "start_side": "RIGHT",
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2454323565",
      "pull_request_review_id": 3368774585,
      "id": 2454323565,
      "node_id": "PRRC_kwDOAN28mc6SSgFt",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Possibility of duplicate coinbase transactions\n+\n+The [`coinbases.json`](./coinbases.json) file contains test cases exercising the new restrictions on\n+coinbase transactions introduced in BIP54 to prevent duplicate coinbase transactions without\n+resorting to BIP30 validation. Each test case contains a chain of mainnet blocks (including the\n+genesis block), and whether this block chain is valid according to BIP54. All test cases are valid\n+according to current Bitcoin's consensus rules, except one that features a block containing a\n+coinbase transaction timelocked to a future block height.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 88,
      "original_position": 88,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": 2450759000,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Just to be clear, I was just looking at the description, I did not check the test vectors, so it might just be the description that is off.",
      "created_at": "2025-10-23T08:24:41Z",
      "updated_at": "2025-10-23T08:24:42Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2454323565",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2454323565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": 86,
      "original_start_line": 86,
      "start_side": "RIGHT",
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2455011165",
      "pull_request_review_id": 3369763357,
      "id": 2455011165,
      "node_id": "PRRC_kwDOAN28mc6SVH9d",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Possibility of duplicate coinbase transactions\n+\n+The [`coinbases.json`](./coinbases.json) file contains test cases exercising the new restrictions on\n+coinbase transactions introduced in BIP54 to prevent duplicate coinbase transactions without\n+resorting to BIP30 validation. Each test case contains a chain of mainnet blocks (including the\n+genesis block), and whether this block chain is valid according to BIP54. All test cases are valid\n+according to current Bitcoin's consensus rules, except one that features a block containing a\n+coinbase transaction timelocked to a future block height.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 88,
      "original_position": 88,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": 2450759000,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh, then i just checked and it still is in here! [Link](https://github.com/darosior/bips/blob/2fead0c179f32656f338f05aceb979558ae8025b/bip-0054/test_vectors/coinbases.json#L33).",
      "created_at": "2025-10-23T12:46:27Z",
      "updated_at": "2025-10-23T12:46:27Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2455011165",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2455011165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": 86,
      "original_start_line": 86,
      "start_side": "RIGHT",
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2464748899",
      "pull_request_review_id": 3382237496,
      "id": 2464748899,
      "node_id": "PRRC_kwDOAN28mc6S6RVj",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more details.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 1,
      "original_position": 4,
      "commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "original_commit_id": "2fead0c179f32656f338f05aceb979558ae8025b",
      "in_reply_to_id": 2448855597,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, thanks.",
      "created_at": "2025-10-27T08:10:51Z",
      "updated_at": "2025-10-27T08:10:51Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2464748899",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2464748899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2476406112",
      "pull_request_review_id": 3397426563,
      "id": 2476406112,
      "node_id": "PRRC_kwDOAN28mc6TmvVg",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a",
      "path": "bip-0054/test_vectors/README.md",
      "position": 30,
      "original_position": 30,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Started to look on the `timestamps.json` file, I’m understanding that the headers for the 9 chain of headers have been drawn the historical mainnet chain, and then permutation of a subset of those chain of headers have been made accordingly to make some of them (in)valid according to BIP54, assuming that BIP54 would have been enforced as a rule since the genesis block.\r\n\r\nGiven the difficulty adjustment is proposing rules for the validation state where block is equal to height `N % 2016` equal 0 and the state where block is equal to height `N % 2016` equal 2016, and there is at least >, =, < to test for each boundary check, there should be at least 6 tests. From checking `timestamps.json`, there at least 9 test chains in the file.\r\n\r\nWondering if there is full coverage for the first equality check, given you have > and = to test each for the variations of minus 7200 (and then same, you have >, =, < I think that are valuable to test for).",
      "created_at": "2025-10-30T04:46:27Z",
      "updated_at": "2025-10-30T04:51:37Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2476406112",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2476406112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 30,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2476407516",
      "pull_request_review_id": 3397426563,
      "id": 2476407516,
      "node_id": "PRRC_kwDOAN28mc6Tmvrc",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 42,
      "original_position": 42,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Very open question: how hard it would be to coordinate a Murch-Zawy attack variant on testnet3.",
      "created_at": "2025-10-30T04:47:42Z",
      "updated_at": "2025-10-30T04:51:37Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2476407516",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2476407516"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2508430708",
      "pull_request_review_id": 3440470554,
      "id": 2508430708,
      "node_id": "PRRC_kwDOAN28mc6Vg510",
      "diff_hunk": "@@ -0,0 +1,62 @@\n+[\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff0100000000000000000300515200000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 63-byte legacy transaction.\"\n+    },\n+    {\n+        \"tx\": \"02000000000101827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000000010000000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 61-byte legacy transaction with a witness.\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff010000000000000000040051525400000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte legacy transaction (4 bytes in spk).\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c883150000000403424242ffffffff010040075af07507000000000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte legacy transaction (4 bytes in scriptsig).\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000005005152545800000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 65-byte legacy transaction.\"\n+    },\n+    {\n+        \"tx\": \"02000000000101827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000004005152540108213245576281941200000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte Segwit transaction.\"",
      "path": "bip-0054/test_vectors/txsize.json",
      "position": 30,
      "original_position": 30,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I’m not sure if there is a coverage for a 64-byte Taproot transaction. Not sure if it’s either strictly necessary as Taproot transactions are Segwit transactions, even if the other way isn’t necessarily true.\r\n\r\nThere is no change with Segwit transactions, but having cases for a Taproot + annex (empty) and a Taproot + annex (full) to be sure that the 64-byte verification logic is checking the code correctly, can be valuable in my opinion.",
      "created_at": "2025-11-10T00:15:49Z",
      "updated_at": "2025-11-10T00:23:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2508430708",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2508430708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 30,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2508436000",
      "pull_request_review_id": 3440470554,
      "id": 2508436000,
      "node_id": "PRRC_kwDOAN28mc6Vg7Ig",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 78,
      "original_position": 78,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I had a read of the `sigops.json` but I cannot comment directly on it because it is considered as a “diff too large” by Github.\r\n\r\nOn the test vector: \"Mixed input types reaching exactly 2500 BIP54-sigops + a future Segwit program input”, I think it could be valuable to multiply it for the whole range of future Segwit program (i.e from OP_02 to OP_16) to ensure the `CheckSigopsBIP54` parser works well.",
      "created_at": "2025-11-10T00:21:27Z",
      "updated_at": "2025-11-10T00:23:45Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2508436000",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2508436000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560221439",
      "pull_request_review_id": 3505371717,
      "id": 2560221439,
      "node_id": "PRRC_kwDOAN28mc6YmeD_",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a",
      "path": "bip-0054/test_vectors/README.md",
      "position": 30,
      "original_position": 30,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2476406112,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not exactly. Only the genesis block's header is in common with the historical main chain. But you are correct in how it's used: creating various forks which test the Timewarp and Murch-Zawy fixes in various conditions.\r\n\r\nRather than >, =, <, i think what's important to test is the boundary: the last value for which the test pass and the first for which it fails. So using your terms it would be <, =. Plus of course also testing that it does not trigger at other heights, especially those off-by-one from the height that needs to be checked.\r\n\r\nAt the moment the tests exercise for Timewarp that:\r\n- The check is not performed on heights in the difficulty adjustment period (heights 41 and 2001)\r\n- The lowest value for which the check passes for the correct height (2016)\r\n- The first value for which the check fails for the correct height\r\n- The check is not performed on the height just preceding the one on which it should be enforced (2015) to check for off-by-one in implementations\r\n- The check is not performed on the height just following the one on which it should be enforced (2017) to check for off-by-one in implementations\r\n\r\nAt the moment the tests exercise for Murch-Zawy that:\r\n- The check fails on the first value for which it is supposed to fail\r\n- The passes on the first value for which it is not supposed to fail\r\n- The check is not enforced on the height just following the one on which it should be enforced (4032 instead of 4031)\r\n\r\nWhich test cases do you think should be added exactly and for what reason? I think the above is sufficient for a first shot, but i'm happy to consider re-mining the chain of headers and add the test cases you would suggest in a followup.",
      "created_at": "2025-11-25T14:34:30Z",
      "updated_at": "2025-11-25T14:34:30Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2560221439",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560221439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 30,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560287424",
      "pull_request_review_id": 3505455341,
      "id": 2560287424,
      "node_id": "PRRC_kwDOAN28mc6YmuLA",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 42,
      "original_position": 42,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2476407516,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We'd need some non-trivial hash power to mine at least 3 difficulty adjustment periods without publishing them. We'd also need to ramp up the difficulty first, which is currently 1 on testnet3. A Murch-Zawy can also be done on testnet4, for what it's worth.\r\n\r\nIf we can find someone with some hashrate that could be interesting to do.",
      "created_at": "2025-11-25T14:51:00Z",
      "updated_at": "2025-11-25T14:51:08Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2560287424",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560287424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560313485",
      "pull_request_review_id": 3505486412,
      "id": 2560313485,
      "node_id": "PRRC_kwDOAN28mc6Ym0iN",
      "diff_hunk": "@@ -0,0 +1,62 @@\n+[\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff0100000000000000000300515200000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 63-byte legacy transaction.\"\n+    },\n+    {\n+        \"tx\": \"02000000000101827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000000010000000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 61-byte legacy transaction with a witness.\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff010000000000000000040051525400000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte legacy transaction (4 bytes in spk).\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c883150000000403424242ffffffff010040075af07507000000000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte legacy transaction (4 bytes in scriptsig).\"\n+    },\n+    {\n+        \"tx\": \"0200000001827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000005005152545800000000\",\n+        \"valid\": true,\n+        \"comment\": \"A 65-byte legacy transaction.\"\n+    },\n+    {\n+        \"tx\": \"02000000000101827da3d85a6547d6b03662d2cb86982d655a6f390547285a3bf9ec9f28e0c8831500000000ffffffff01000000000000000004005152540108213245576281941200000000\",\n+        \"valid\": false,\n+        \"comment\": \"A 64-byte Segwit transaction.\"",
      "path": "bip-0054/test_vectors/txsize.json",
      "position": 30,
      "original_position": 30,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2508430708,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There is coverage for a 64-byte Taproot transaction, see the test case just below your comment:\r\n> A 64-byte Segwit transaction (1 p2tr input, 1 p2a output).\r\n\r\nThe annex is just another witness stack element, so i'm not sure it would add more value, but it also doesn't hurt to have. I'm happy to add it in a follow-up.",
      "created_at": "2025-11-25T14:57:46Z",
      "updated_at": "2025-11-25T14:57:46Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2560313485",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560313485"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 30,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560370500",
      "pull_request_review_id": 3505558355,
      "id": 2560370500,
      "node_id": "PRRC_kwDOAN28mc6YnCdE",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and\n+the test vectors are persisted as a JSON file if the `UPDATE_JSON_TESTS` preprocessor directive is\n+set (off by default).\n+\n+To compile the [header][header-miner] and [block][block-miner] miners you may have to link to\n+libatomic explicitly. This can be achieved like so:\n+```\n+cmake -B atomicbuild -DAPPEND_LDFLAGS=\"-latomic\"\n+cmake --build atomicbuild/ -j $(nproc)\n+```\n+\n+[Premined headers][premined-headers] are also provided along with the header miner to allow changing\n+some of the last headers without having to re-generate the whole chain.\n+\n+\n+### Difficulty adjustment exploits\n+\n+The [`timestamps.json`](./timestamps.json) test vectors exercise the two constraints on block header\n+timestamps introduced by BIP54 to mitigate the Timewarp and Murch-Zawy attacks. Each test case\n+features a chain of mainnet headers starting from the genesis block, and whether this header chain\n+is valid by BIP54 rules. Each test case also contains a comment describing why this particular chain\n+is (in)valid according to BIP54.  All test cases are valid according to current Bitcoin consensus\n+rules. It is intended to be used to test a BIP54 implementation by feeding the header chain to a\n+Bitcoin node implementation, enforcing the BIP54 rules on this chain from genesis.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `header_chain`: a JSON array of strings. An ordered list of hex-encoded mainnet block headers.\n+- `valid`: a JSON boolean. Whether this chain of headers is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+For the purpose of testing a Timewarp fix, a Timewarp attack was included early on in the history of\n+testnet3. An implementer of BIP54 may want to ensure that syncing testnet3 by enforcing BIP54 since\n+genesis will treat block `00000000118da1e2165a19307b86f87eba814845e8a0f99734dce279ca3fb029` as\n+invalid.\n+\n+\n+### Long block validation time\n+\n+The [`sigops.json`](sigops.json) file contains test vectors for the limit on the number of\n+potentially-executed legacy signature operations in a single transaction, introduced by BIP54 in\n+order to mitigate long block validation times. Each test case represents a transaction and whether a\n+block containing it would be valid according to BIP54. The test cases feature an extensive set of\n+combinations of inputs and output types, ways to run into the limit, historical violations and some\n+pathological transactions exhibiting the specific implementation details. All test cases but those\n+belonging to this last category feature transactions that are valid under current Bitcoin consensus\n+rules. Each test case also features a comment describing why the transaction is (in)valid according\n+to BIP54.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `spent_outputs`: a JSON array of strings. An ordered list of hex-encoded Bitcoin-serialized\n+  transaction outputs spent by each input of this test case's transaction.\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to current consensus rules\n+  supplemented by BIP54.\n+- `comment`: a JSON string. Description of the test case.\n+\n+\n+### Merkle tree malleability with 64-byte transactions\n+\n+The [`txsize.json`](./txsize.json) file contains test cases exercising the new constraint on\n+non-witness transaction size introduced in BIP54. Each test case contains a transaction and whether\n+it would be valid according to BIP54, as well as a comment describing why it is (in)valid. All test\n+cases are otherwise valid according to current Bitcoin consensus rules.\n+\n+The test vector file features a JSON array of JSON objects, each corresponding to a test case. Each\n+JSON object features the following entries:\n+- `tx`: a JSON string. A hex-encoded Bitcoin-serialized transaction to be evaluated.\n+- `valid`: a JSON boolean. Whether this transaction is valid according to BIP54.\n+- `comment`: a JSON string. Description of the test case.",
      "path": "bip-0054/test_vectors/README.md",
      "position": 78,
      "original_position": 78,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2508436000,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Now i think that would be overkill, each of these cases takes quite a lot of space and i don't think there is much value in testing every single Segwit version here. We already test for versions 0, 1 and 2. Maybe i could add a version 16 in a followup if you really think it's worthwhile.",
      "created_at": "2025-11-25T15:10:40Z",
      "updated_at": "2025-11-25T15:10:41Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2560370500",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2560370500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561756024",
      "pull_request_review_id": 3507196197,
      "id": 2561756024,
      "node_id": "PRRC_kwDOAN28mc6YsUt4",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and",
      "path": "bip-0054/test_vectors/README.md",
      "position": 8,
      "original_position": 8,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": null,
      "user": {
        "login": "Christewart",
        "id": 3514957,
        "node_id": "MDQ6VXNlcjM1MTQ5NTc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3514957?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Christewart",
        "html_url": "https://github.com/Christewart",
        "followers_url": "https://api.github.com/users/Christewart/followers",
        "following_url": "https://api.github.com/users/Christewart/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Christewart/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Christewart/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Christewart/subscriptions",
        "organizations_url": "https://api.github.com/users/Christewart/orgs",
        "repos_url": "https://api.github.com/users/Christewart/repos",
        "events_url": "https://api.github.com/users/Christewart/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Christewart/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The `bip54-miner` link seems to be broken? Admittedly I'm not sure how this linking format works (such as `other-vectors`), but here is what i see \r\n<img width=\"1450\" height=\"500\" alt=\"Screenshot 2025-11-25 at 16 41 19\" src=\"https://github.com/user-attachments/assets/ae81ebba-cc95-4c38-a92c-841e37096d62\" />",
      "created_at": "2025-11-25T22:41:43Z",
      "updated_at": "2025-11-25T22:41:44Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2561756024",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561756024"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 8,
      "original_line": 8,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561879507",
      "pull_request_review_id": 3507318523,
      "id": 2561879507,
      "node_id": "PRRC_kwDOAN28mc6Ysy3T",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and",
      "path": "bip-0054/test_vectors/README.md",
      "position": 8,
      "original_position": 8,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2561756024,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Indeed this should link to https://github.com/darosior/bitcoin/commits/bip54_miner/ instead of https://github.com/darosior/bitcoin/blob/bip54_miner/commits my bad.",
      "created_at": "2025-11-25T23:16:31Z",
      "updated_at": "2025-11-25T23:16:31Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2561879507",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561879507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 8,
      "original_line": 8,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887669",
      "pull_request_review_id": 3507326953,
      "id": 2561887669,
      "node_id": "PRRC_kwDOAN28mc6Ys021",
      "diff_hunk": "@@ -0,0 +1,102 @@\n+## BIP54 test vectors\n+\n+This folder contains a set of test vectors for each mitigation introduced in the BIP. This document\n+presents them in more detail.\n+\n+The code used to generate half of the test vectors is included with the implementation and available\n+[here][other-vectors]. The other half requires mining mainnet blocks and is [published\n+separately][bip54-miner]. In both cases it is implemented as a regular Bitcoin Core unit test, and",
      "path": "bip-0054/test_vectors/README.md",
      "position": 8,
      "original_position": 8,
      "commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "original_commit_id": "0777a81367e36dd16af101fb264af141f199e86a",
      "in_reply_to_id": 2561756024,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Fixed in https://github.com/bitcoin/bips/pull/2045, nice catch thanks.",
      "created_at": "2025-11-25T23:19:31Z",
      "updated_at": "2025-11-25T23:19:31Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2015#discussion_r2561887669",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2561887669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2015"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 8,
      "original_line": 8,
      "side": "RIGHT"
    }
  ]
}