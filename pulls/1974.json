{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/1974",
    "id": 2843895712,
    "node_id": "PR_kwDOAN28mc6pgmeg",
    "html_url": "https://github.com/bitcoin/bips/pull/1974",
    "diff_url": "https://github.com/bitcoin/bips/pull/1974.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/1974.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/1974/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/1974/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1974/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/aa790efee91f56b123d679f6fdef4c955903b2b4",
    "number": 1974,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Add OP_TEMPLATEHASH and TH+CSFS+IK bundle BIP",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Opening this here for wider discussion and feedback.\r\n\r\nedit: Probably need to add implementation section: https://github.com/instagibbs/bitcoin/tree/2025-07-op_templatehash\r\n",
    "labels": [
      {
        "id": 275845989,
        "node_id": "MDU6TGFiZWwyNzU4NDU5ODk=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/New%20BIP",
        "name": "New BIP",
        "color": "5319e7",
        "default": false
      }
    ],
    "created_at": "2025-09-19T13:41:19Z",
    "updated_at": "2025-09-30T19:48:07Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merged": false,
    "merge_commit_sha": "1d9ca39dc6950a0a22e3665e15fff33a640bbe59",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "instagibbs:bip_op_templatehash",
      "ref": "bip_op_templatehash",
      "sha": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 17830834,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzgzMDgzNA==",
        "name": "bips",
        "full_name": "instagibbs/bips",
        "owner": {
          "login": "instagibbs",
          "id": 5767891,
          "node_id": "MDQ6VXNlcjU3Njc4OTE=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/instagibbs",
          "html_url": "https://github.com/instagibbs",
          "followers_url": "https://api.github.com/users/instagibbs/followers",
          "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
          "organizations_url": "https://api.github.com/users/instagibbs/orgs",
          "repos_url": "https://api.github.com/users/instagibbs/repos",
          "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/instagibbs/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/instagibbs/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/instagibbs/bips",
        "archive_url": "https://api.github.com/repos/instagibbs/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/instagibbs/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/instagibbs/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/instagibbs/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/instagibbs/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/instagibbs/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/instagibbs/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/instagibbs/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/instagibbs/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/instagibbs/bips/contributors",
        "deployments_url": "https://api.github.com/repos/instagibbs/bips/deployments",
        "downloads_url": "https://api.github.com/repos/instagibbs/bips/downloads",
        "events_url": "https://api.github.com/repos/instagibbs/bips/events",
        "forks_url": "https://api.github.com/repos/instagibbs/bips/forks",
        "git_commits_url": "https://api.github.com/repos/instagibbs/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/instagibbs/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/instagibbs/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/instagibbs/bips.git",
        "issue_comment_url": "https://api.github.com/repos/instagibbs/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/instagibbs/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/instagibbs/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/instagibbs/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/instagibbs/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/instagibbs/bips/languages",
        "merges_url": "https://api.github.com/repos/instagibbs/bips/merges",
        "milestones_url": "https://api.github.com/repos/instagibbs/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/instagibbs/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/instagibbs/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/instagibbs/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:instagibbs/bips.git",
        "stargazers_url": "https://api.github.com/repos/instagibbs/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/instagibbs/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/instagibbs/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/instagibbs/bips/subscription",
        "tags_url": "https://api.github.com/repos/instagibbs/bips/tags",
        "teams_url": "https://api.github.com/repos/instagibbs/bips/teams",
        "trees_url": "https://api.github.com/repos/instagibbs/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/instagibbs/bips.git",
        "hooks_url": "https://api.github.com/repos/instagibbs/bips/hooks",
        "svn_url": "https://github.com/instagibbs/bips",
        "homepage": "bitcoin.org",
        "language": "Wikitext",
        "forks_count": 1,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 16787,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-24T15:38:59Z",
        "created_at": "2014-03-17T14:32:12Z",
        "updated_at": "2025-09-19T13:34:16Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "6730ee8a1e767ccc5594938f8a73aca8a639a1cf",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5759,
        "stargazers_count": 10226,
        "watchers_count": 10226,
        "size": 16700,
        "default_branch": "master",
        "open_issues_count": 57,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-24T22:49:24Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2025-09-30T19:37:07Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/1974"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 882,
    "deletions": 0,
    "changed_files": 5,
    "commits": 1,
    "review_comments": 2,
    "comments": 12
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGFhNzkwZWZlZTkxZjU2YjEyM2Q2NzlmNmZkZWY0Yzk1NTkwM2IyYjQ",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/aa790efee91f56b123d679f6fdef4c955903b2b4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/aa790efee91f56b123d679f6fdef4c955903b2b4",
      "tree": {
        "sha": "cc1c71f28d4aa9da02aa44cfb11af8e65327c16b",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/cc1c71f28d4aa9da02aa44cfb11af8e65327c16b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/6730ee8a1e767ccc5594938f8a73aca8a639a1cf",
          "sha": "6730ee8a1e767ccc5594938f8a73aca8a639a1cf",
          "html_url": "https://github.com/bitcoin/bips/commit/6730ee8a1e767ccc5594938f8a73aca8a639a1cf"
        }
      ],
      "message": "Add OP_TEMPLATEHASH and TH+CSFS+IK bundle BIP",
      "committer": {
        "name": "Greg Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2025-09-19T13:32:54Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2025-04-15T14:53:22Z"
      },
      "sha": "aa790efee91f56b123d679f6fdef4c955903b2b4"
    },
    {
      "event": "labeled",
      "id": 19800272281,
      "node_id": "LE_lADOAN28mc7MtTV-zwAAAAScMC2Z",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19800272281",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T13:59:17Z",
      "label": {
        "name": "New BIP",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 3312632171,
      "node_id": "IC_kwDOAN28mc7FcsFr",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3312632171",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T15:23:31Z",
      "updated_at": "2025-09-19T15:23:31Z",
      "author_association": "MEMBER",
      "body": "Some previous related discussions:\r\n- [\"What's a good stopping point? Making the case for the capabilities enabled by CTV+CSFS\"](https://gnusha.org/pi/bitcoindev/F5vsDVNGXP_hmCvp4kFnptFLBCXOoRxWk9d05kSInq_kXj0ePqVAJGADkBFJxYIGkjk8Pw1gzBonTivH6WUUb4f6mwNCmJIwdXBMrjjQ0lI=@protonmail.com/) - Bitcoin dev mailing list thread discussing the capabilities offered in this proposal.\r\n- [\"A Taproot-native (re-)bindable transaction bundle proposal\"](https://gnusha.org/pi/bitcoindev/26b96fb1-d916-474a-bd23-920becc3412cn@googlegroups.com/) - Bitcoin dev mailing list thread announcing this proposal.\r\n- [Reference implementation](https://github.com/instagibbs/bitcoin/pull/3) of this proposal.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3312632171",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3321878856,
      "node_id": "IC_kwDOAN28mc7F_9lI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3321878856",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-22T23:29:29Z",
      "updated_at": "2025-09-23T00:15:24Z",
      "author_association": "NONE",
      "body": "I'm afraid I'm going to write a lot and say very little, but I have a few thoughts **maybe** worth sharing.\r\n**TL;DR I like this proposal. As-is I prefer it slightly over CTV, but I think committing to the annex may be undesirable, and it's worth further discussion (as much as I'd like to avoid excessive bikeshedding).**\r\n\r\nThe improvements on CTV are obvious, pushing the hash onto the stack is better, leveraging only cached intermediate hashes is better.\r\n\r\n# scriptSig Commitment\r\n\r\nDropping the scriptSig commitment seems debatable, but I accept the given rationale for omitting it. Furthermore, CTV's scriptSig commitment introduces a new variable length chunk of data to hash. \r\n\r\n# The Annex Commitment\r\n\r\nThe annex commitment is of course the most controversial addition. On the one hand, it is incredibly useful to eltoo style protocols, and `TEMPLATEHASH` commits to similar items as the taproot sighash, which includes the annex. On the other hand, the annex is the only witness item committed to, and there are plausible conflicts with future annex usage. I have to plead ignorance on the future annex usage issues, I can only say it seems *plausible*. Furthermore, it could be desirable to commit to only part of the annex, which is not permitted by `TEMPLATEHASH`, and developing a structured annex format adds a significant development dependency to TEMPLATEHASH.\r\n\r\nI can imagine, for example, that CISA might leverage the annex to set the order of public keys in an aggregate key. In this scenario, committing to the entire annex ahead of time would prevent using CISA, though once again I confess I don't know what such a scheme would actually look like.\r\n\r\nMy instinct here is to reduce the scope of `TEMPLATEHASH`. When in doubt, leave it out (how can it be wrong if it rhymes?) I could envision a future `OP_TEMPLATEHASH_ANNEX` if annex commitments proved to be that desirable, but at present it seems to me like the practical motivation for committing to the annex is entirely around eltoo, and there's a non-zero chance it could conflict with other annex usages.\r\n\r\nOn the other hand, introducing a future `OP_TEMPLATEHASH_NO_ANNEX` would be similarly simple if the annex commitment proved to be a problem, and `OP_TEMPLATEHASH` (with annex) would be immediately useful for, and remain useful for eltoo style constructions.\r\n\r\nThis is why I'm ok with the proposal as-is, if the annex commitment proves to be a mistake, it can still serve a useful purpose now and into the future, and a second opcode could be introduced to address the annex-less case.\r\n\r\n# Crazy Talk\r\n\r\nI'd like to very tentatively float another way to dodge the annex issue: a hash selector bitfield. To this, instagibbs said something like \"why not go full TXHASH then?\" Unlike TXHASH which has a huge amount of flexibility, a bitfield that permits choosing to commit to all or none of the sequences, all or none of the outputs, and all or none of the annex *should* not change the stopping point. One could also leverage the other five bits of a 1 byte stack item to potentially commit to the first N<32 outpoints, to support the sibling commitments. This last one in particular changes the performance profile of `TEMPLATEHASH` by an order of magnitude (though 5 bits is arbitrary, it could be 1, it could be 32) and drastically increases the surface area to consider, but it might be worth considering if it's useful enough to the BitVM crowd. (The sibling commitment might be well past the point of \"we should just go full TXHASH\" however)\r\n\r\nI can say that for me, committing to all of the outputs but none of the input sequences (and therefore not the input count) would be very useful for one of my projects which currently uses a deleted key ALL|ANYONECANPAY signature.\r\n\r\n# Hashing Performance\r\n\r\nToday one can use the script `PUSHDATA2 0x0802 <520 bytes> DUP SHA256 DROP` to hash 520 bytes, requiring a 526 byte script. Repeating `DUP SHA256 DROP` can cause a verifier to hash 520 more bytes. You can cause a verifier to hash `hashed_bytes(n) = 520 * n` bytes for a script of `script_len(n) = 523 + 3 * n` bytes.\r\n\r\nWith `TEMPLATEHASH` as proposed and implemented, one can use the script `1 TEMPLATEHASH DROP` to hash 109 bytes. Repeating `TEMPLATEHASH DROP` can cause a verifier to hash 109 more bytes. Therefore, you can cause a verifier to hash `hashed_bytes(n) = 2 * n` bytes for a script of `script_len(n) = 2 * n` bytes.\r\n\r\nAt exactly n = 80, the SHA256 script will hash 41600 bytes with a 763 byte script. `TEMPLATEHASH` on the other hand, will hash only 41529 bytes with a 763 byte script, and the SHA256 script's worst case hashing will get considerably worse from there.\r\n\r\nLess naively, one can use the script `PUSHDATA2 0x0802 <520 bytes> 3DUP SHA256 DROP SHA256 DROP SHA256 DROP` to hash 1560 bytes, requiring a 530 byte script. Repeating `3DUP SHA256 DROP SHA256 DROP SHA256 DROP` will cause a verifier to hash 1560 more bytes. This works out to `hashed_bytes(n) = 1560 * n` bytes for a script of length `script_len(n) = 523 + 7 * n` bytes.\r\n\r\nSimilarly, the `TEMPLATEHASH` abusing script can be made more efficient with `1 TEMPLATEHASH TEMPLATEHASH 2DROP` to hash 218 bytes. Repeating `TEMPLATEHASH TEMPLATEHASH 2DROP` can cause a verifier to hash 218 more bytes. Therefore you can cause a verifier to hash `hashed_bytes(n) = 218 * n` bytes for a script of length `script_len(n) = 1 + 3 * n` bytes.\r\n\r\nThe less naive SHA256 script will hash 57720 bytes in 782 script bytes, and the less naive `TEMPLATEHASH` hashes 56898 bytes in 784 script bytes. Once again, beyond this point, the SHA256 script is worse, therefore at the limit of script size, the SHA256 script will be worse.\r\n\r\nI suppose all of that is to say \"This is strictly less hashing than is necessary for other existing operations.\" seems correct, assuming there aren't more clever pathological scripts. Furthermore, the result of `TEMPLATEHASH` would be trivial to cache, while the result of `DUP SHA256 DROP` would be more difficult.\r\n",
      "user": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3321878856",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3323818448,
      "node_id": "IC_kwDOAN28mc7GHXHQ",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3323818448",
      "actor": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T12:31:21Z",
      "updated_at": "2025-09-23T12:31:21Z",
      "author_association": "NONE",
      "body": "> the `TEMPLATEHASH` abusing script\r\n\r\nWouldn't the hash naturally be cached in implementation?",
      "user": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3323818448",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3324070413,
      "node_id": "IC_kwDOAN28mc7GIUoN",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324070413",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T13:39:36Z",
      "updated_at": "2025-09-23T13:39:36Z",
      "author_association": "MEMBER",
      "body": "Thanks for the feedback @Ademan.\r\n\r\n> as much as I'd like to avoid excessive bikeshedding\r\n\r\nSome amount of bikeshedding is justified for a proposal as consequential as a consensus change. :)\r\n\r\n> annex commitment\r\n\r\nIf i understand correctly, your criticism is that while committing to the annex is very useful for the flagship usecase of this proposal, this may clash with potential future usages of the annex. That on its own i don't think is a valid reason not to have the annex commitment, if only because you can make the same argument in the other direction: not committing to the annex would be a design mistake as it allows to be forward-compatible with future usages of the annex, and is already provably useful for some of the main applications enabled by this proposal.\r\n\r\nTo substantiate your point you bring up that the annex would be the only witness element committed to by `TEMPLATEHASH` and that it might be useful for CISA. But the annex is different from other witness elements, it was a new field expected to be useful precisely because it is committed to by signatures. In this sense, it's the only witness element committed to by `TEMPLATEHASH` in the same way it is by `CHECKSIG`/`CHECKSIGADD` today. Now, i don't quite understand your point about CISA. You present a scenario where \"committing to the entire annex ahead of time would prevent using CISA\", but in this case it would also prevent any other opcode that commits to the transaction, like the signature opcodes. If those needs to be re-designed (new pubkey types?) then it seems fine to do `TEMPLATEHASH` along with it. And until then, i'd much rather the opcodes that commit to a transaction be consistent with each other.\r\n\r\nAs more of a general point, i think starting from `CTV` to analyze `TEMPLATEHASH` is the wrong way to approach this. We should start from what we want to enable and argue the best way to achieve it. If what we want to enable is committing to a transaction, then since Taproot the annex is just another transaction field that should be committed to.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324070413",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "mentioned",
      "id": 19866950810,
      "node_id": "MEE_lADOAN28mc7MtTV-zwAAAASgKZya",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19866950810",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T13:39:37Z"
    },
    {
      "event": "subscribed",
      "id": 19866950864,
      "node_id": "SE_lADOAN28mc7MtTV-zwAAAASgKZzQ",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19866950864",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T13:39:38Z"
    },
    {
      "event": "commented",
      "id": 3324103370,
      "node_id": "IC_kwDOAN28mc7GIcrK",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324103370",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T13:48:20Z",
      "updated_at": "2025-09-23T13:48:20Z",
      "author_association": "MEMBER",
      "body": "> Wouldn't the hash naturally be cached in implementation?\r\n\r\nIn the Taproot signature hash (which this proposal re-uses), various parts of the transaction are pre-hashed such that the hash can be cached across signatures. For each signature, those pre-computed hashes are hashed together along with some fixed-size transaction fields, such that the maximum amount of data hashed per signature is capped:\r\nhttps://github.com/bitcoin/bips/blob/87f3fe164484f73c30cdb122481bed96a1f79af9/bip-0341.mediawiki#L128\r\n\r\nThis final hash is pointless to cache, because other opcodes let you hash strictly more arbitrary (i.e. uncachable) data (and even have less restrictions on them).",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324103370",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3324107998,
      "node_id": "IC_kwDOAN28mc7GIdze",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324107998",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T13:49:36Z",
      "updated_at": "2025-09-23T13:49:36Z",
      "author_association": "MEMBER",
      "body": "> The Annex Commitment\r\n\r\nClearly, I think, this is the most debatable point precisely because there isn't widespread use (or demand yet) for such space. \r\n\r\n> the practical motivation for committing to the annex is entirely around eltoo\r\n\r\nAny scheme that wants to shift from sign-time OP_RETURN to witness data may want to use it in the same manner. It's my fault for making ln-symmetry the go-to during discussion. Granted, this is a fairly minimal improvement, and can be done by many other means with CSFS and friends, or just eating the OP_RETURN cost.\r\n\r\nIn the end, \"Any annex scheme that is compatible with OP_CHECKSIG(ADD) is compatible with OP_TEMPLATEHASH\" seems the most straight-forward and least foot-gunny to me.\r\n\r\n> Crazy Talk\r\n\r\nI feel like without a specific proposal, we're going to miss the real costs in terms of complexity.\r\n\r\nI'm also worried that if a proposal becomes \"general purpose\" without actually being general, it won't capture the behavior we actually want, with respect to \"programmable money\". \r\n\r\n> (The sibling commitment might be well past the point of \"we should just go full TXHASH\" however)\r\n\r\nNo BitVM bridge has launched, and the space is moving very very fast. It's on my docket to try to learn more about the fundamental requirements of these systems to transition from permissioned systems to permissionless for both safety of funds and unilateral exit (these are different concepts IIUC), but I think this is out of scope, and the answer may be \"we need GSR / btclisp / Simplicity\" and stop trying to guess what specific systems need? I have plenty of controversial thoughts on this but seems way out of scope here, unless we find the next-tx capability and rebindable signatures insufficient motivation for a softfork.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324107998",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3324324179,
      "node_id": "IC_kwDOAN28mc7GJSlT",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324324179",
      "actor": {
        "login": "stevenroose",
        "id": 853468,
        "node_id": "MDQ6VXNlcjg1MzQ2OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/853468?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stevenroose",
        "html_url": "https://github.com/stevenroose",
        "followers_url": "https://api.github.com/users/stevenroose/followers",
        "following_url": "https://api.github.com/users/stevenroose/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stevenroose/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stevenroose/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stevenroose/subscriptions",
        "organizations_url": "https://api.github.com/users/stevenroose/orgs",
        "repos_url": "https://api.github.com/users/stevenroose/repos",
        "events_url": "https://api.github.com/users/stevenroose/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stevenroose/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T14:40:38Z",
      "updated_at": "2025-09-23T14:40:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "My take on the annex is as long as there is no clear potential use for the annex proposed, treating it consistently seems to make the most sense. We treat it exactly like the taproot sighashes are, so that's consistent. Take note that we're only committing the current input's annex, if the annex would be used for something that doesn't work with TEMPLATEHASH, it just means they can't be used together, which seems fine. It would also not be able to be used together with any other sighash-(all/default)-using scheme.\r\n\r\nI feel that since new use-cases for the annex will almost certainly come with their own soft fork, they can be resolved when the time comes. You speak about CISA, which I think is a great example, but in my opinion by the time we have a solid CISA soft fork proposal, the TXHASH and TXSIGHASH ideas will hopefully also be more mature and they can solve the annex aspect more elegantly.\r\n\r\nThis proposal is trying to move the needle for simple next-tx commitment and basic rebindable signatures. Two arguably very simple features that are undeniably useful for almost all second-layer protocols currently being developed and used.",
      "user": {
        "login": "stevenroose",
        "id": 853468,
        "node_id": "MDQ6VXNlcjg1MzQ2OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/853468?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stevenroose",
        "html_url": "https://github.com/stevenroose",
        "followers_url": "https://api.github.com/users/stevenroose/followers",
        "following_url": "https://api.github.com/users/stevenroose/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stevenroose/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stevenroose/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stevenroose/subscriptions",
        "organizations_url": "https://api.github.com/users/stevenroose/orgs",
        "repos_url": "https://api.github.com/users/stevenroose/repos",
        "events_url": "https://api.github.com/users/stevenroose/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stevenroose/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324324179",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "unsubscribed",
      "id": 19868395999,
      "node_id": "UE_lADOAN28mc7MtTV-zwAAAASgP6nf",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19868395999",
      "actor": {
        "login": "0xf0xx0",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xf0xx0",
        "html_url": "https://github.com/0xf0xx0",
        "followers_url": "https://api.github.com/users/0xf0xx0/followers",
        "following_url": "https://api.github.com/users/0xf0xx0/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xf0xx0/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xf0xx0/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xf0xx0/subscriptions",
        "organizations_url": "https://api.github.com/users/0xf0xx0/orgs",
        "repos_url": "https://api.github.com/users/0xf0xx0/repos",
        "events_url": "https://api.github.com/users/0xf0xx0/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xf0xx0/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T14:43:28Z"
    },
    {
      "event": "commented",
      "id": 3324451016,
      "node_id": "IC_kwDOAN28mc7GJxjI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324451016",
      "actor": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T15:12:05Z",
      "updated_at": "2025-09-23T15:12:33Z",
      "author_association": "NONE",
      "body": "If nodes start relaying transactions with non-empty annex the result will predictably a new exogenous asset protocols and a new simpler more efficient ways to inscribe arbitrary data without the need for pre-commitment.\r\n\r\nUnleashing the annex is a predictable footgun socially speaking.",
      "user": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324451016",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3324458056,
      "node_id": "IC_kwDOAN28mc7GJzRI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324458056",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T15:14:00Z",
      "updated_at": "2025-09-23T15:14:00Z",
      "author_association": "MEMBER",
      "body": "> Unleashing the annex is a predictable footgun socially speaking.\r\n\r\nTo be clear, this PR / implementation isn't about relaxing these rules for relay.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324458056",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "commented",
      "id": 3324471452,
      "node_id": "IC_kwDOAN28mc7GJ2ic",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324471452",
      "actor": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T15:17:27Z",
      "updated_at": "2025-09-23T15:18:05Z",
      "author_association": "NONE",
      "body": "> To be clear, this PR / implementation isn't about relaxing these rules for relay.\r\n\r\nYes, this is only relevant further down the line. I think what @Ademan was also picking at is that this proposal feels predictive direction wise.",
      "user": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324471452",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "mentioned",
      "id": 19869165232,
      "node_id": "MEE_lADOAN28mc7MtTV-zwAAAASgS2aw",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19869165232",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T15:17:29Z"
    },
    {
      "event": "subscribed",
      "id": 19869165267,
      "node_id": "SE_lADOAN28mc7MtTV-zwAAAASgS2bT",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19869165267",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T15:17:29Z"
    },
    {
      "event": "commented",
      "id": 3324992999,
      "node_id": "IC_kwDOAN28mc7GL13n",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3324992999",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T17:50:08Z",
      "updated_at": "2025-09-23T17:50:08Z",
      "author_association": "NONE",
      "body": "@darosior \r\n\r\n> Thanks for the feedback @Ademan.\r\n\r\nSure! I hope it's productive...\r\n\r\n> you can make the same argument in the other direction: not committing to the annex would be a design mistake as it allows to be forward-compatible with future usages of the annex,\r\n\r\nFrom my very limited perspective, that seems considerably less likely than the opposite, but that is kind of the problem, this is ~guessing. **Maybe it would be useful to at least attempt to identify concrete or partially specified proposals that use the annex.** I suppose the onus is on me since I'm the one suggesting they may conflict, but you, instagibbs, steven and moonsettler are all likely closer to the people who might be working on them.\r\n\r\n> and is already provably useful for some of the main applications enabled by this proposal.\r\n\r\nAbsolutely! I just want to ensure that \"it's useful\" isn't overriding compatibility concerns. There are other ways to do data publication, it doesn't *necessarily* need to be a part of `TEMPLATEHASH`.\r\n\r\n> but in this case it would also prevent any other opcode that commits to the transaction, like the signature opcodes.\r\n\r\nTo be clear, I'm distinguishing between ahead of time commitment (via `TEMPLATEHASH` or a pre-signed transaction) and signing time commitment. Obviously with `CHECKSIG{,VERIFY,ADD}` you can typically modify the annex and re-sign at any point before confirmation. This is a significant difference in flexibility. (OTOH, you can also modify the non-witness portions of the TX and re-sign, but I don't accept that as an argument against committing to sequences or outputs... after all that's the whole point here.)\r\n\r\n_I think I may have been talked out of my position, but I still think it deserves some litigation (perhaps with a better advocate than I)._\r\n\r\nTo give it one last go, I suspect (admittedly without evidence!) that varying annex data independently of the rest of the TX will be the norm and desirable if/when the annex finds uses besides data publication.\r\n\r\n> i think starting from CTV to analyze TEMPLATEHASH is the wrong way to approach this. We should start from what we want to enable and argue the best way to achieve it.\r\n\r\nFair enough, I definitely agree with the second part.",
      "user": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3324992999",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "mentioned",
      "id": 19871925458,
      "node_id": "MEE_lADOAN28mc7MtTV-zwAAAASgdYTS",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19871925458",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T17:50:09Z"
    },
    {
      "event": "subscribed",
      "id": 19871925490,
      "node_id": "SE_lADOAN28mc7MtTV-zwAAAASgdYTy",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19871925490",
      "actor": {
        "login": "Ademan",
        "id": 18740,
        "node_id": "MDQ6VXNlcjE4NzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18740?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ademan",
        "html_url": "https://github.com/Ademan",
        "followers_url": "https://api.github.com/users/Ademan/followers",
        "following_url": "https://api.github.com/users/Ademan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Ademan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Ademan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Ademan/subscriptions",
        "organizations_url": "https://api.github.com/users/Ademan/orgs",
        "repos_url": "https://api.github.com/users/Ademan/repos",
        "events_url": "https://api.github.com/users/Ademan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Ademan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T17:50:09Z"
    },
    {
      "event": "mentioned",
      "id": 19871925523,
      "node_id": "MEE_lADOAN28mc7MtTV-zwAAAASgdYUT",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19871925523",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T17:50:09Z"
    },
    {
      "event": "subscribed",
      "id": 19871925541,
      "node_id": "SE_lADOAN28mc7MtTV-zwAAAASgdYUl",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19871925541",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-23T17:50:09Z"
    },
    {
      "event": "reviewed",
      "id": 3269717374,
      "node_id": "PRR_kwDOAN28mc7C4-1-",
      "url": null,
      "actor": null,
      "commit_id": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-09-25T23:33:15Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#pullrequestreview-3269717374",
      "submitted_at": "2025-09-25T23:33:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/1974"
    },
    {
      "event": "commented",
      "id": 3353568840,
      "node_id": "IC_kwDOAN28mc7H42ZI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/comments/3353568840",
      "actor": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-30T19:48:07Z",
      "updated_at": "2025-09-30T19:48:07Z",
      "author_association": "NONE",
      "body": "@instagibbs how do you feel about adding OP_SHA256TAGGED to this mix? Even with the \"French CTV\" it would be a pretty viable LNhance alternative I could support without any misgivings.",
      "user": {
        "login": "moonsettler",
        "id": 90689674,
        "node_id": "MDQ6VXNlcjkwNjg5Njc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90689674?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/moonsettler",
        "html_url": "https://github.com/moonsettler",
        "followers_url": "https://api.github.com/users/moonsettler/followers",
        "following_url": "https://api.github.com/users/moonsettler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/moonsettler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/moonsettler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/moonsettler/subscriptions",
        "organizations_url": "https://api.github.com/users/moonsettler/orgs",
        "repos_url": "https://api.github.com/users/moonsettler/repos",
        "events_url": "https://api.github.com/users/moonsettler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/moonsettler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/1974#issuecomment-3353568840",
      "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1974"
    },
    {
      "event": "mentioned",
      "id": 20018170358,
      "node_id": "MEE_lADOAN28mc7MtTV-zwAAAASpLQn2",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/20018170358",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-30T19:48:08Z"
    },
    {
      "event": "subscribed",
      "id": 20018170393,
      "node_id": "SE_lADOAN28mc7MtTV-zwAAAASpLQoZ",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/20018170393",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-30T19:48:08Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2380527896",
      "pull_request_review_id": 3269717374,
      "id": 2380527896,
      "node_id": "PRRC_kwDOAN28mc6N4_kY",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+```\n+  BIP: ?\n+  Layer: Consensus (soft fork)\n+  Title: OP_TEMPLATEHASH\n+  Author: Gregory Sanders <gsanders87@gmail.com>\n+          Antoine Poinsot <mail@antoinep.com>\n+          Steven Roose <steven@stevenroose.org>\n+  Comments-Summary: No comments yet.\n+  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-?\n+  Status: Draft\n+  Type: Standards Track\n+  Created: ?\n+  License: CC0-1.0\n+```\n+\n+## Abstract\n+\n+This document proposes a new operation for [Tapscript][tapscript-bip]: `OP_TEMPLATEHASH`. It introduces the ability to\n+push on the stack a hash of the transaction spending an output.\n+\n+## Motivation\n+\n+`OP_TEMPLATEHASH` can be used to commit to the transaction spending an output[^commit-exact-tx]. This capability\n+can replace the use of pre-signed transactions in second-layer protocols. By reducing interactivity it makes such\n+protocols simpler, safer, and sometimes notably more efficient. For instance it can remove the need to share HTLC\n+signatures in the Lightning Network protocol's [`commitment_signed` message][ln-commit-signed][^ln-second-stage], make\n+receiving an Ark \"VTXO\" [non-interactive][ark-case-ctv], and [reduces roundtrips][symmetric-greg] in the implementation\n+of LN-Symmetry. It is also a [significant optimisation][fournier-ctv-dlcs] for [Discreet Log Contracts][optech-dlcs].\n+\n+## Specification\n+\n+`OP_TEMPLATEHASH` redefines `OP_SUCCESS187` (0xbb) in the Tapscript execution context with further restrictions.\n+\n+Upon execution of the opcode, the template hash of the transaction in context is pushed onto the stack as defined below,\n+and script execution continues.\n+\n+The template hash uses a tagged hash as introduced by [BIP340][schnorr-bip] and [BIP341][taproot-bip]. We use a new tag\n+for this purpose: *TemplateHash*.\n+\n+The template hash re-uses the *sha_sequences*, *sha_outputs* and *sha_annex* pre-computed transaction data introduced in\n+BIP341. Numerical values in 4-byte are encoded in little-endian.\n+\n+The template hash is the *hash<sub>TemplateHash</sub>* of the following transaction fields concatenated:\n+\n+- Transaction data:\n+    - *nVersion* (4): the version of the transaction.\n+    - *nLockTime* (4): the locktime of the transaction.\n+    - *sha_sequences* (32): the SHA256 of the serialization of all input sequence, as per BIP341.\n+    - *sha_outputs* (32): the SHA256 of the serialization of all outputs in `CTxOut` format, as per BIP341.\n+- Data about this input:\n+    - *annex_present* (1): as defined in BIP341 (0 if no annex is present, or 1 otherwise).\n+    - *input_index* (4): index of this input in the transaction input vector. Index of the first input is 0.\n+    - If an annex is present:\n+        - *sha_annex* (32): the SHA256 of the annex, as per BIP341.\n+\n+## Rationale\n+\n+The template hash follows BIP341's signature message format, with minimal necessary deviations. This reuses a\n+tried-and-proven approach to hashed messages, and importantly makes it possible to reuse the pre-computed subfields\n+introduced by BIP341 to prevent quadratic hashing. Besides the hash tags, this results in at most 109 bytes being hashed\n+upon execution of the operation[^hashed-msg-max-size]. This is strictly less hashing than is necessary for other\n+existing operations.\n+\n+The specific fields from the BIP341 signature message that are ommitted when computing the template hash are the\n+following:\n+- *hash_type*: this is the sighash type identifier. Only a single hash type is supported by `OP_TEMPLATEHASH`, so there\n+  is no need to commit to such an identifier.\n+- *spend_type*: this value is defined by BIP341 as *2\\*ext_flag + annex_present*. Since no extension is appended to the\n+  signature message, *ext_flag* is set to 0. Therefore we commit directly to *annex_present*.\n+- *sha_prevouts* / *sha_scriptpubkeys*: committing to these fields as is would introduce a hash cycle when the hash is\n+  committed in the output itself. Committing to all other prevouts or scriptpubkeys would introduce hashing a quantity\n+  of data quadratic in the number of inputs. It would also prevent spending two coins encumbered by a template hash\n+  check in the same transaction. Finally, the flexibility of not committing to the specific coins spent is also\n+  desirable to recover from mistakes[^no-commit-other-coins].\n+- *sha_amounts*: the BIP341 rationale for committing to the amounts of all spent coins is to be able to prove to an offline\n+  signer the fees of a transaction. Although `OP_TEMPLATEHASH` can be used as a building block for rebindable\n+  signatures, the utility of committing to spent amounts but not spent scriptpubkeys [is\n+  limited][greg-attack-input-ownership]. Still for rebindable signatures, committing to spent amounts can be justified\n+  as defense-in-depth against implementation mistakes[^commit-spent-amounts]. However, the lack of flexibility this\n+  introduces also makes it harder to recover from a mistake in committing to the next\n+  transaction[^no-commit-other-coins]. Furthermore, committing to all spent amounts also makes overcommitting funds to\n+  such a script result in the output being forever unspendable instead of the excess just going to fees at spend time.\n+\n+The design of `OP_TEMPLATEHASH` was inspired by the design of [BIP119][ctv-bip] `OP_CHECKTEMPLATEVERIFY` but differs in\n+several important ways.\n+\n+First of all, `OP_TEMPLATEHASH` is only defined for Tapscript, as modifying legacy Script comes with an unnecessarily\n+increased risk surface. In addition, sticking to Tapscript allows leveraging more powerful upgrade hooks (`OP_SUCCESS`s\n+instead of `OP_NOP`s) which make it possible to push the template hash on the stack instead of being constrained to\n+strict assertions with no stack modification. Pushing the template hash on the stack substantially improves the\n+efficiency of using `OP_TEMPLATEHASH` as a building block for rebindable signatures.\n+\n+Unlike `OP_TEMPLATEHASH`, `OP_CHECKTEMPLATEVERIFY` also commits to the scriptSig of all inputs of the spending\n+transaction. `OP_CHECKTEMPLATEVERIFY` gives txid stability when the committed spending transaction has a single input,\n+and when the scriptSig of this single input has been committed by the hash.\n+Taproot scriptSigs must be empty and therefore under the single input case `OP_TEMPLATEHASH` has no requirement\n+to commit to scriptSigs to achieve txid stability.",
      "path": "bip-templatehash.md",
      "position": 97,
      "original_position": 97,
      "commit_id": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "original_commit_id": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "in_reply_to_id": null,
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "everytime I read through this always my biggest question is \"why not commit to all script sigs being empty\" or \"what are the potential downsides to having multi input malleability\"\n\nwould be nice to have an explanation in this to explain why this trade off is okay",
      "created_at": "2025-09-25T23:33:15Z",
      "updated_at": "2025-09-25T23:33:15Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1974#discussion_r2380527896",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2380527896"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1974"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 97,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2382281313",
      "pull_request_review_id": 3272053829,
      "id": 2382281313,
      "node_id": "PRRC_kwDOAN28mc6N_rph",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+```\n+  BIP: ?\n+  Layer: Consensus (soft fork)\n+  Title: OP_TEMPLATEHASH\n+  Author: Gregory Sanders <gsanders87@gmail.com>\n+          Antoine Poinsot <mail@antoinep.com>\n+          Steven Roose <steven@stevenroose.org>\n+  Comments-Summary: No comments yet.\n+  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-?\n+  Status: Draft\n+  Type: Standards Track\n+  Created: ?\n+  License: CC0-1.0\n+```\n+\n+## Abstract\n+\n+This document proposes a new operation for [Tapscript][tapscript-bip]: `OP_TEMPLATEHASH`. It introduces the ability to\n+push on the stack a hash of the transaction spending an output.\n+\n+## Motivation\n+\n+`OP_TEMPLATEHASH` can be used to commit to the transaction spending an output[^commit-exact-tx]. This capability\n+can replace the use of pre-signed transactions in second-layer protocols. By reducing interactivity it makes such\n+protocols simpler, safer, and sometimes notably more efficient. For instance it can remove the need to share HTLC\n+signatures in the Lightning Network protocol's [`commitment_signed` message][ln-commit-signed][^ln-second-stage], make\n+receiving an Ark \"VTXO\" [non-interactive][ark-case-ctv], and [reduces roundtrips][symmetric-greg] in the implementation\n+of LN-Symmetry. It is also a [significant optimisation][fournier-ctv-dlcs] for [Discreet Log Contracts][optech-dlcs].\n+\n+## Specification\n+\n+`OP_TEMPLATEHASH` redefines `OP_SUCCESS187` (0xbb) in the Tapscript execution context with further restrictions.\n+\n+Upon execution of the opcode, the template hash of the transaction in context is pushed onto the stack as defined below,\n+and script execution continues.\n+\n+The template hash uses a tagged hash as introduced by [BIP340][schnorr-bip] and [BIP341][taproot-bip]. We use a new tag\n+for this purpose: *TemplateHash*.\n+\n+The template hash re-uses the *sha_sequences*, *sha_outputs* and *sha_annex* pre-computed transaction data introduced in\n+BIP341. Numerical values in 4-byte are encoded in little-endian.\n+\n+The template hash is the *hash<sub>TemplateHash</sub>* of the following transaction fields concatenated:\n+\n+- Transaction data:\n+    - *nVersion* (4): the version of the transaction.\n+    - *nLockTime* (4): the locktime of the transaction.\n+    - *sha_sequences* (32): the SHA256 of the serialization of all input sequence, as per BIP341.\n+    - *sha_outputs* (32): the SHA256 of the serialization of all outputs in `CTxOut` format, as per BIP341.\n+- Data about this input:\n+    - *annex_present* (1): as defined in BIP341 (0 if no annex is present, or 1 otherwise).\n+    - *input_index* (4): index of this input in the transaction input vector. Index of the first input is 0.\n+    - If an annex is present:\n+        - *sha_annex* (32): the SHA256 of the annex, as per BIP341.\n+\n+## Rationale\n+\n+The template hash follows BIP341's signature message format, with minimal necessary deviations. This reuses a\n+tried-and-proven approach to hashed messages, and importantly makes it possible to reuse the pre-computed subfields\n+introduced by BIP341 to prevent quadratic hashing. Besides the hash tags, this results in at most 109 bytes being hashed\n+upon execution of the operation[^hashed-msg-max-size]. This is strictly less hashing than is necessary for other\n+existing operations.\n+\n+The specific fields from the BIP341 signature message that are ommitted when computing the template hash are the\n+following:\n+- *hash_type*: this is the sighash type identifier. Only a single hash type is supported by `OP_TEMPLATEHASH`, so there\n+  is no need to commit to such an identifier.\n+- *spend_type*: this value is defined by BIP341 as *2\\*ext_flag + annex_present*. Since no extension is appended to the\n+  signature message, *ext_flag* is set to 0. Therefore we commit directly to *annex_present*.\n+- *sha_prevouts* / *sha_scriptpubkeys*: committing to these fields as is would introduce a hash cycle when the hash is\n+  committed in the output itself. Committing to all other prevouts or scriptpubkeys would introduce hashing a quantity\n+  of data quadratic in the number of inputs. It would also prevent spending two coins encumbered by a template hash\n+  check in the same transaction. Finally, the flexibility of not committing to the specific coins spent is also\n+  desirable to recover from mistakes[^no-commit-other-coins].\n+- *sha_amounts*: the BIP341 rationale for committing to the amounts of all spent coins is to be able to prove to an offline\n+  signer the fees of a transaction. Although `OP_TEMPLATEHASH` can be used as a building block for rebindable\n+  signatures, the utility of committing to spent amounts but not spent scriptpubkeys [is\n+  limited][greg-attack-input-ownership]. Still for rebindable signatures, committing to spent amounts can be justified\n+  as defense-in-depth against implementation mistakes[^commit-spent-amounts]. However, the lack of flexibility this\n+  introduces also makes it harder to recover from a mistake in committing to the next\n+  transaction[^no-commit-other-coins]. Furthermore, committing to all spent amounts also makes overcommitting funds to\n+  such a script result in the output being forever unspendable instead of the excess just going to fees at spend time.\n+\n+The design of `OP_TEMPLATEHASH` was inspired by the design of [BIP119][ctv-bip] `OP_CHECKTEMPLATEVERIFY` but differs in\n+several important ways.\n+\n+First of all, `OP_TEMPLATEHASH` is only defined for Tapscript, as modifying legacy Script comes with an unnecessarily\n+increased risk surface. In addition, sticking to Tapscript allows leveraging more powerful upgrade hooks (`OP_SUCCESS`s\n+instead of `OP_NOP`s) which make it possible to push the template hash on the stack instead of being constrained to\n+strict assertions with no stack modification. Pushing the template hash on the stack substantially improves the\n+efficiency of using `OP_TEMPLATEHASH` as a building block for rebindable signatures.\n+\n+Unlike `OP_TEMPLATEHASH`, `OP_CHECKTEMPLATEVERIFY` also commits to the scriptSig of all inputs of the spending\n+transaction. `OP_CHECKTEMPLATEVERIFY` gives txid stability when the committed spending transaction has a single input,\n+and when the scriptSig of this single input has been committed by the hash.\n+Taproot scriptSigs must be empty and therefore under the single input case `OP_TEMPLATEHASH` has no requirement\n+to commit to scriptSigs to achieve txid stability.",
      "path": "bip-templatehash.md",
      "position": 97,
      "original_position": 97,
      "commit_id": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "original_commit_id": "aa790efee91f56b123d679f6fdef4c955903b2b4",
      "in_reply_to_id": 2380527896,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "1. the input is segwit, so it already explicitly commits to its own scriptSig being blank\r\n2. the purported benefit to committing to *other* scriptSigs in addition was to ensure txid stability, but without fixing the other inputs' prevout ahead of time, this cannot be achieved in general. (The \"BitVM Trick\" was to ensure this was actually possible, but I consider this not an intentional design decision; I'd rather the \"sibling input commitment\" be done properly if that's what we want!) \r\n\r\nGiven that it doesn't ensure the \"next transaction\" commitment we are aiming for which includes additional hashing on top of taproot hashes already existing, it was not added to the proposal.",
      "created_at": "2025-09-26T12:35:54Z",
      "updated_at": "2025-09-26T12:35:54Z",
      "html_url": "https://github.com/bitcoin/bips/pull/1974#discussion_r2382281313",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2382281313"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/1974"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 97,
      "original_line": 97,
      "side": "RIGHT"
    }
  ]
}