{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/1964",
    "id": 2819203916,
    "node_id": "PR_kwDOAN28mc6oCaNM",
    "html_url": "https://github.com/bitcoin/bips/pull/1964",
    "diff_url": "https://github.com/bitcoin/bips/pull/1964.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/1964.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/1964",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/1964/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/1964/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1964/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/bf696165b32a59d71d0ddece8482c356e00afb88",
    "number": 1964,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Caution on tweaking in bip 327",
    "user": {
      "login": "AdamISZ",
      "id": 4278257,
      "node_id": "MDQ6VXNlcjQyNzgyNTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4278257?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AdamISZ",
      "html_url": "https://github.com/AdamISZ",
      "followers_url": "https://api.github.com/users/AdamISZ/followers",
      "following_url": "https://api.github.com/users/AdamISZ/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/AdamISZ/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/AdamISZ/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/AdamISZ/subscriptions",
      "organizations_url": "https://api.github.com/users/AdamISZ/orgs",
      "repos_url": "https://api.github.com/users/AdamISZ/repos",
      "events_url": "https://api.github.com/users/AdamISZ/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/AdamISZ/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "The BIP is quite difficult to parse in terms of understanding the functionality and safety of tweaking keys.\r\n\r\nIn particular, while it is a terrible idea for more than one reason, constructing a MuSig2 aggregated key using related (bip32 unhardened) individual keys in the list is very specifically insecure, but that is not noted.\r\n\r\nIt's admittedly debatable whether you ever have to specify that a certain kind of stupid behaviour is to be warned against, but my justification is:\r\n\r\n1. The BIP is very explicitly \"supporting tweaking\" right from the Abstract. It isn't immediately clear that this means tweaking the ouput, not the input. Perhaps a minor note early on would help with that.\r\n\r\n2. Pre- this patch, in the section I'm editing, the document again explicitly says it supports tweaking, and this time, in relation to the *input* keys. It then goes on to explain the background of the attack outlined on the mailing list (I updated to a gnusha link: https://gnusha.org/pi/bitcoindev/576db60c-b05b-5b9a-75e5-9610f3e04eda@gmail.com/ ), which is much more \"in scope\" in the sense that the honest signer behaviour isn't stupid, but at the same time, the conditions of that attack are quite obscure.\r\n\r\n3. While the behaviour is stupid, it's not inconceivable, and it sits within perhaps the most likely/common usage pattern of MuSig2: multisig for better cold storage/savings security. Multiple keys controlled by the same signer, using multiple hardware devices for redundant security. As noted by Jonas Nick in an earlier email convo we had, there is at least one reason such stupid behaviour might be considered: less backup (and/or laziness). I admit that a large majority would have the common sense to not reuse the same wallet seed across devices, but in case anyone did it, they are exposed in a specific way that is very unobvious.\r\n\r\n4. To generalize the above, for me the BIP is not sufficiently explicit that the design of the MuSig2 algorithm does not address the possibility of related input keys at all (and it would be easy as an engineer consumer to assume that related keys would be safe, if they didn't look at the mathematical formulas too much).\r\n\r\nIf you want a concrete description of the attack, here you go (see Appendix A.2 of [DahLIAS](https://eprint.iacr.org/2025/692) for what I mean by \"multipliers:\"):\r\n\r\n2 devices set up with one secret key each, where the keys are on the same branch so that sk1 = sk2 + t for \"public\" t (handwave).\r\n\r\nThe network is compromised by the attacker. It exchanges messages with device 1 (sk1); receives nonces, maliciously calculates the response nonces (with the multipliers), receives a partial sig for sk1 and can complete the signing protocol just from knowing t.\r\n\r\nThe higher-level idea here is (I'm cribbing from an earlier email I wrote):\r\n\r\n> ... which I think nicely illustrates something that occurred to me earlier: there's a question of \"what is authorization?\" being raised here. In a single key signature, there is a single authorizing event, so we never worry too much about the \"semantics\" of the action of signing. It's one action, and it's all or nothing: you authorize, or you don't.\r\n\r\n> In multi-signing it's not atomic. The semantics of individual signing events are something decided on by the operator(s) of the protocol. I might want to say \"I authorize if and only if 3 different hardware devices sign\" (or 3 people or whatever). How does the security definition represent this? I believe the rationale for applying EUF-CMA as in the paper is \"we take a maximally pessimistic approach and assume that all except honest are the adversary, then we demand the adversary produce a signature without authorizing events from the honest signer\" on the basis that, if the honest signer did authorize, then there is no security failure (the honest signer wanted it!) - but that's exactly the point I'm questioning.\r\n\r\n> So it's back to the slightly confusion position of \"that this is possible is worrying, but all the obvious ways of exploiting it as a weakness reduce to an already fundamentally insecure multisig setup (using calculable tweaks of existing keys), and the base security model does not include this\" (\"capture\", perhaps).\r\n\r\n> Whimsically I wonder if this can be seen as analogous to EUF style security vs SUF style security: for most purposes you don't need strong unforgeability but it can cause implementation headaches if you don't have it (MtGox,  hehe).",
    "labels": [],
    "created_at": "2025-09-11T13:25:01Z",
    "updated_at": "2025-09-11T14:24:43Z",
    "mergeable": true,
    "mergeable_state": "unstable",
    "merged": false,
    "merge_commit_sha": "e33020e814b7c5ae48294a7596aaf88c1aaa4935",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "AdamISZ:patch-1",
      "ref": "patch-1",
      "sha": "bf696165b32a59d71d0ddece8482c356e00afb88",
      "user": {
        "login": "AdamISZ",
        "id": 4278257,
        "node_id": "MDQ6VXNlcjQyNzgyNTc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4278257?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/AdamISZ",
        "html_url": "https://github.com/AdamISZ",
        "followers_url": "https://api.github.com/users/AdamISZ/followers",
        "following_url": "https://api.github.com/users/AdamISZ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/AdamISZ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/AdamISZ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/AdamISZ/subscriptions",
        "organizations_url": "https://api.github.com/users/AdamISZ/orgs",
        "repos_url": "https://api.github.com/users/AdamISZ/repos",
        "events_url": "https://api.github.com/users/AdamISZ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/AdamISZ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 220524295,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMjA1MjQyOTU=",
        "name": "bips",
        "full_name": "AdamISZ/bips",
        "owner": {
          "login": "AdamISZ",
          "id": 4278257,
          "node_id": "MDQ6VXNlcjQyNzgyNTc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/4278257?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/AdamISZ",
          "html_url": "https://github.com/AdamISZ",
          "followers_url": "https://api.github.com/users/AdamISZ/followers",
          "following_url": "https://api.github.com/users/AdamISZ/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/AdamISZ/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/AdamISZ/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/AdamISZ/subscriptions",
          "organizations_url": "https://api.github.com/users/AdamISZ/orgs",
          "repos_url": "https://api.github.com/users/AdamISZ/repos",
          "events_url": "https://api.github.com/users/AdamISZ/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/AdamISZ/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/AdamISZ/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/AdamISZ/bips",
        "archive_url": "https://api.github.com/repos/AdamISZ/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/AdamISZ/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/AdamISZ/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/AdamISZ/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/AdamISZ/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/AdamISZ/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/AdamISZ/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/AdamISZ/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/AdamISZ/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/AdamISZ/bips/contributors",
        "deployments_url": "https://api.github.com/repos/AdamISZ/bips/deployments",
        "downloads_url": "https://api.github.com/repos/AdamISZ/bips/downloads",
        "events_url": "https://api.github.com/repos/AdamISZ/bips/events",
        "forks_url": "https://api.github.com/repos/AdamISZ/bips/forks",
        "git_commits_url": "https://api.github.com/repos/AdamISZ/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/AdamISZ/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/AdamISZ/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/AdamISZ/bips.git",
        "issue_comment_url": "https://api.github.com/repos/AdamISZ/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/AdamISZ/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/AdamISZ/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/AdamISZ/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/AdamISZ/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/AdamISZ/bips/languages",
        "merges_url": "https://api.github.com/repos/AdamISZ/bips/merges",
        "milestones_url": "https://api.github.com/repos/AdamISZ/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/AdamISZ/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/AdamISZ/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/AdamISZ/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:AdamISZ/bips.git",
        "stargazers_url": "https://api.github.com/repos/AdamISZ/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/AdamISZ/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/AdamISZ/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/AdamISZ/bips/subscription",
        "tags_url": "https://api.github.com/repos/AdamISZ/bips/tags",
        "teams_url": "https://api.github.com/repos/AdamISZ/bips/teams",
        "trees_url": "https://api.github.com/repos/AdamISZ/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/AdamISZ/bips.git",
        "hooks_url": "https://api.github.com/repos/AdamISZ/bips/hooks",
        "svn_url": "https://github.com/AdamISZ/bips",
        "homepage": "bitcoin.org",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 16759,
        "default_branch": "bip-schnorr",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-11T13:23:20Z",
        "created_at": "2019-11-08T18:20:49Z",
        "updated_at": "2019-11-08T18:20:50Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "abf3bdab2947cad5204b60d298b305adc597f04c",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5726,
        "stargazers_count": 10185,
        "watchers_count": 10185,
        "size": 16620,
        "default_branch": "master",
        "open_issues_count": 43,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-10T21:10:03Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2025-09-11T02:59:58Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/1964"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 5,
    "deletions": 3,
    "changed_files": 1,
    "commits": 1,
    "review_comments": 0,
    "comments": 0
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGJmNjk2MTY1YjMyYTU5ZDcxZDBkZGVjZTg0ODJjMzU2ZTAwYWZiODg",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/bf696165b32a59d71d0ddece8482c356e00afb88",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/bf696165b32a59d71d0ddece8482c356e00afb88",
      "tree": {
        "sha": "f2dc895afa4dc29e4a6854ac5f59b597021f4d91",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/f2dc895afa4dc29e4a6854ac5f59b597021f4d91"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f2dc895afa4dc29e4a6854ac5f59b597021f4d91\nparent abf3bdab2947cad5204b60d298b305adc597f04c\nauthor Adam Gibson <ekaggata@gmail.com> 1757596999 -0300\ncommitter GitHub <noreply@github.com> 1757596999 -0300\n\nUpdate bip-0327.mediawiki\n\nThe BIP is quite difficult to parse in terms of understanding the functionality and safety of tweaking keys.\r\n\r\nIn particular, while it is a terrible idea for more than one reason, constructing a MuSig2 aggregated key using related (bip32 unhardened) individual keys in the list is very specifically insecure, but that is not noted.\r\n\r\nIt's admittedly debatable whether you ever have to specify that a certain kind of stupid behaviour is to be warned against, but my justification is:\r\n\r\n1. The BIP is very explicitly \"supporting tweaking\" right from the Abstract. It isn't immediately clear that this means tweaking the ouput, not the input. Perhaps a minor note early on would help with that.\r\n\r\n2. Pre- this patch, in the section I'm editing, the document again explicitly says it supports tweaking, and this time, in relation to the *input* keys. It then goes on to explain the background of the attack outlined on the mailing list (I updated to a gnusha link: https://gnusha.org/pi/bitcoindev/576db60c-b05b-5b9a-75e5-9610f3e04eda@gmail.com/ ), which is much more \"in scope\" in the sense that the honest signer behaviour isn't stupid, but at the same time, the conditions of that attack are quite obscure.\r\n\r\n3. While the behaviour is stupid, it's not inconceivable, and it sits within perhaps the most likely/common usage pattern of MuSig2: multisig for better cold storage/savings security. Multiple keys controlled by the same signer, using multiple hardware devices for redundant security. As noted by Jonas Nick in an earlier email convo we had, there is at least one reason such stupid behaviour might be considered: less backup (and/or laziness). I admit that a large majority would have the common sense to not reuse the same wallet seed across devices, but in case anyone did it, they are exposed in a specific way that is very unobvious.\r\n\r\n4. To generalize the above, for me the BIP is not sufficiently explicit that the design of the MuSig2 algorithm does not address the possibility of related input keys at all (and it would be easy as an engineer consumer to assume that related keys would be safe, if they didn't look at the mathematical formulas too much).\r\n\r\nIf you want a concrete description of the attack, here you go (see Appendix A.2 of [DahLIAS](https://eprint.iacr.org/2025/692) for what I mean by \"multipliers:\"):\r\n\r\n2 devices set up with one secret key each, where the keys are on the same branch so that sk1 = sk2 + t for \"public\" t (handwave).\r\n\r\nThe network is compromised by the attacker. It exchanges messages with device 1 (sk1); receives nonces, maliciously calculates the response nonces (with the multipliers), receives a partial sig for sk1 and can complete the signing protocol just from knowing t.\r\n\r\nThe higher-level idea here is (I'm cribbing from an earlier email I wrote):\r\n\r\n> ... which I think nicely illustrates something that occurred to me earlier: there's a question of \"what is authorization?\" being raised here. In a single key signature, there is a single authorizing event, so we never worry too much about the \"semantics\" of the action of signing. It's one action, and it's all or nothing: you authorize, or you don't.\r\n\r\n> In multi-signing it's not atomic. The semantics of individual signing events are something decided on by the operator(s) of the protocol. I might want to say \"I authorize if and only if 3 different hardware devices sign\" (or 3 people or whatever). How does the security definition represent this? I believe the rationale for applying EUF-CMA as in the paper is \"we take a maximally pessimistic approach and assume that all except honest are the adversary, then we demand the adversary produce a signature without authorizing events from the honest signer\" on the basis that, if the honest signer did authorize, then there is no security failure (the honest signer wanted it!) - but that's exactly the point I'm questioning.\r\n\r\n> So it's back to the slightly confusion position of \"that this is possible is worrying, but all the obvious ways of exploiting it as a weakness reduce to an already fundamentally insecure multisig setup (using calculable tweaks of existing keys), and the base security model does not include this\" (\"capture\", perhaps).\r\n\r\n> Whimsically I wonder if this can be seen as analogous to EUF style security vs SUF style security: for most purposes you don't need strong unforgeability but it can cause implementation headaches if you don't have it (MtGox,  hehe).",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsFcBAABCAAQBQJows1HCRC1aQ7uu5UhlAAAD4wQACb1oJsJKqTe58T/PP0DHQI4\nbNMwJdiKZFHZMSxOGkTXIriSPNciQhYcrYOAogkxKbZye5ZcmB7PVnItJQq2/qJv\nw6T9VfYCpBx3sKMIOi5qx5W8Mhc4lmBjNkXmscURoc3hatPhv77eGh1qoyDGHWah\nitxlxnXAXR1/OQpj3YpgHA0fjk1aQ/tW4T+ZtE7FZYSuJm3EzjXNOmD4qrxyAyRu\ncizhS7P4TEWGChdCi6Ze4tb/tnfWm9XQam+/WqCy2+jNQdvx4HxuNO3m5RFNXjTP\nCCmPzBXzZ4Osrd7rxD0D0gtFZfWpKSterQbD2L95ZVnj9kDhWWpLkomLOyQBMQSF\ntUowhWFkainzc1tM9dm2pLhJwgq2LWsiwL/W1zdthDNbxHY8XMHWZpQJCGNragXb\nfw3jetq0lVX2SX6Rm5MntB6922gnGy58Umy6VPM835rCP6z4dGjEl4Z0I1Zum22c\nUaZxuAcg1iQm7jIEd2Rs9X1UTZG1Cdcs7R+8gZouuNRyk7CEQ0kz4wKCJkVdpK8L\n13o8Ho7PgE63VUShOi6WY9meJXFhsjUwHR57bgyA5v58m/Tu4DE69HmbcS+gi71v\n/r9nETGcvWP7KwGx7fEMm2XsETFeI4e+Xie8SXt1zVkcKtTpSoRebvZksYQfw46J\nMPNQmrWevQQu8N+TbOMT\n=I600\n-----END PGP SIGNATURE-----\n"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/abf3bdab2947cad5204b60d298b305adc597f04c",
          "sha": "abf3bdab2947cad5204b60d298b305adc597f04c",
          "html_url": "https://github.com/bitcoin/bips/commit/abf3bdab2947cad5204b60d298b305adc597f04c"
        }
      ],
      "message": "Update bip-0327.mediawiki\n\nThe BIP is quite difficult to parse in terms of understanding the functionality and safety of tweaking keys.\r\n\r\nIn particular, while it is a terrible idea for more than one reason, constructing a MuSig2 aggregated key using related (bip32 unhardened) individual keys in the list is very specifically insecure, but that is not noted.\r\n\r\nIt's admittedly debatable whether you ever have to specify that a certain kind of stupid behaviour is to be warned against, but my justification is:\r\n\r\n1. The BIP is very explicitly \"supporting tweaking\" right from the Abstract. It isn't immediately clear that this means tweaking the ouput, not the input. Perhaps a minor note early on would help with that.\r\n\r\n2. Pre- this patch, in the section I'm editing, the document again explicitly says it supports tweaking, and this time, in relation to the *input* keys. It then goes on to explain the background of the attack outlined on the mailing list (I updated to a gnusha link: https://gnusha.org/pi/bitcoindev/576db60c-b05b-5b9a-75e5-9610f3e04eda@gmail.com/ ), which is much more \"in scope\" in the sense that the honest signer behaviour isn't stupid, but at the same time, the conditions of that attack are quite obscure.\r\n\r\n3. While the behaviour is stupid, it's not inconceivable, and it sits within perhaps the most likely/common usage pattern of MuSig2: multisig for better cold storage/savings security. Multiple keys controlled by the same signer, using multiple hardware devices for redundant security. As noted by Jonas Nick in an earlier email convo we had, there is at least one reason such stupid behaviour might be considered: less backup (and/or laziness). I admit that a large majority would have the common sense to not reuse the same wallet seed across devices, but in case anyone did it, they are exposed in a specific way that is very unobvious.\r\n\r\n4. To generalize the above, for me the BIP is not sufficiently explicit that the design of the MuSig2 algorithm does not address the possibility of related input keys at all (and it would be easy as an engineer consumer to assume that related keys would be safe, if they didn't look at the mathematical formulas too much).\r\n\r\nIf you want a concrete description of the attack, here you go (see Appendix A.2 of [DahLIAS](https://eprint.iacr.org/2025/692) for what I mean by \"multipliers:\"):\r\n\r\n2 devices set up with one secret key each, where the keys are on the same branch so that sk1 = sk2 + t for \"public\" t (handwave).\r\n\r\nThe network is compromised by the attacker. It exchanges messages with device 1 (sk1); receives nonces, maliciously calculates the response nonces (with the multipliers), receives a partial sig for sk1 and can complete the signing protocol just from knowing t.\r\n\r\nThe higher-level idea here is (I'm cribbing from an earlier email I wrote):\r\n\r\n> ... which I think nicely illustrates something that occurred to me earlier: there's a question of \"what is authorization?\" being raised here. In a single key signature, there is a single authorizing event, so we never worry too much about the \"semantics\" of the action of signing. It's one action, and it's all or nothing: you authorize, or you don't.\r\n\r\n> In multi-signing it's not atomic. The semantics of individual signing events are something decided on by the operator(s) of the protocol. I might want to say \"I authorize if and only if 3 different hardware devices sign\" (or 3 people or whatever). How does the security definition represent this? I believe the rationale for applying EUF-CMA as in the paper is \"we take a maximally pessimistic approach and assume that all except honest are the adversary, then we demand the adversary produce a signature without authorizing events from the honest signer\" on the basis that, if the honest signer did authorize, then there is no security failure (the honest signer wanted it!) - but that's exactly the point I'm questioning.\r\n\r\n> So it's back to the slightly confusion position of \"that this is possible is worrying, but all the obvious ways of exploiting it as a weakness reduce to an already fundamentally insecure multisig setup (using calculable tweaks of existing keys), and the base security model does not include this\" (\"capture\", perhaps).\r\n\r\n> Whimsically I wonder if this can be seen as analogous to EUF style security vs SUF style security: for most purposes you don't need strong unforgeability but it can cause implementation headaches if you don't have it (MtGox,  hehe).",
      "committer": {
        "name": "GitHub",
        "email": "noreply@github.com",
        "date": "2025-09-11T13:23:19Z"
      },
      "author": {
        "name": "Adam Gibson",
        "email": "ekaggata@gmail.com",
        "date": "2025-09-11T13:23:19Z"
      },
      "sha": "bf696165b32a59d71d0ddece8482c356e00afb88"
    },
    {
      "event": "renamed",
      "id": 19638986933,
      "node_id": "RTE_lADOAN28mc7LC_8zzwAAAASSkyi1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/19638986933",
      "actor": {
        "login": "AdamISZ",
        "id": 4278257,
        "node_id": "MDQ6VXNlcjQyNzgyNTc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4278257?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/AdamISZ",
        "html_url": "https://github.com/AdamISZ",
        "followers_url": "https://api.github.com/users/AdamISZ/followers",
        "following_url": "https://api.github.com/users/AdamISZ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/AdamISZ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/AdamISZ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/AdamISZ/subscriptions",
        "organizations_url": "https://api.github.com/users/AdamISZ/orgs",
        "repos_url": "https://api.github.com/users/AdamISZ/repos",
        "events_url": "https://api.github.com/users/AdamISZ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/AdamISZ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-11T14:24:43Z",
      "rename": {
        "from": "Update bip-0327.mediawiki",
        "to": "Caution on tweaking in bip 327"
      }
    }
  ],
  "comments": []
}