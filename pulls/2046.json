{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bips/pulls/2046",
    "id": 3048932942,
    "node_id": "PR_kwDOAN28mc61uwZO",
    "html_url": "https://github.com/bitcoin/bips/pull/2046",
    "diff_url": "https://github.com/bitcoin/bips/pull/2046.diff",
    "patch_url": "https://github.com/bitcoin/bips/pull/2046.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bips/issues/2046",
    "commits_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bips/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/2046/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/45106322ef3b809e61a13d9b817eb38193fa19fa",
    "number": 2046,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "BIP375: Add test vectors + runner",
    "user": {
      "login": "macgyver13",
      "id": 4712150,
      "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macgyver13",
      "html_url": "https://github.com/macgyver13",
      "followers_url": "https://api.github.com/users/macgyver13/followers",
      "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
      "organizations_url": "https://api.github.com/users/macgyver13/orgs",
      "repos_url": "https://api.github.com/users/macgyver13/repos",
      "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/macgyver13/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This PR adds the test runner `test_runner.py` and `test_vectors.json` for demonstrating BIP 375 behavior.\r\nCare was taken to minimize dependencies required to evaluate the test vectors.\r\n\r\nDependencies are referenced at runtime from bip-0374 instead of cloning locally.\r\n\r\nTest generation tools moved to external repo\r\n\r\nFeedback welcome @andrewtoth @achow101 @josibake \r\n\r\n### Test runner output\r\n```\r\nInvalid test cases: 13\r\n=== Running Invalid Test Cases ===\r\nTest 1: Missing DLEQ proof for ECDH share\r\nTest 2: Invalid DLEQ proof\r\nTest 3: Non-SIGHASH_ALL signature with silent payments\r\nTest 4: Mixed segwit versions with silent payments\r\nTest 5: Silent payment outputs but no ECDH shares\r\nTest 6: Global ECDH share without DLEQ proof\r\nTest 7: Wrong SP_V0_INFO field size\r\nTest 8: Mixed eligible and ineligible input types\r\nTest 9: Wrong ECDH share size\r\nTest 10: Wrong DLEQ proof size\r\nTest 11: Label without SP_V0_INFO\r\nTest 12: Address mismatch\r\nTest 13: Both global and per-input ECDH shares\r\n\r\n=== Running Valid Test Cases ===\r\nTest 14: Single signer with global ECDH share\r\nTest 15: Multi-party with per-input ECDH shares\r\nTest 16: P2WPKH to silent payment with change detection\r\nTest 17: Silent payment to recipient with SP change (label=0)\r\nTest 18: Multiple silent payment outputs to same scan key\r\n```",
    "labels": [
      {
        "id": 275846070,
        "node_id": "MDU6TGFiZWwyNzU4NDYwNzA=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Proposed%20BIP%20modification",
        "name": "Proposed BIP modification",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 286161898,
        "node_id": "MDU6TGFiZWwyODYxNjE4OTg=",
        "url": "https://api.github.com/repos/bitcoin/bips/labels/Pending%20acceptance",
        "name": "Pending acceptance",
        "description": "This BIP modification requires sign-off by the champion of the BIP being modified",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2025-11-26T21:09:05Z",
    "updated_at": "2026-01-15T18:27:46Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merged": false,
    "merge_commit_sha": "44e7332977627e80fe33047238cd185f352dcaeb",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "macgyver13:bip375-reference-testvectors-pr",
      "ref": "bip375-reference-testvectors-pr",
      "sha": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "user": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1050488233,
        "node_id": "R_kgDOPp0tqQ",
        "name": "bips",
        "full_name": "macgyver13/bips",
        "owner": {
          "login": "macgyver13",
          "id": 4712150,
          "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/macgyver13",
          "html_url": "https://github.com/macgyver13",
          "followers_url": "https://api.github.com/users/macgyver13/followers",
          "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
          "organizations_url": "https://api.github.com/users/macgyver13/orgs",
          "repos_url": "https://api.github.com/users/macgyver13/repos",
          "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/macgyver13/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/macgyver13/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": true,
        "url": "https://api.github.com/repos/macgyver13/bips",
        "archive_url": "https://api.github.com/repos/macgyver13/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/macgyver13/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/macgyver13/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/macgyver13/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/macgyver13/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/macgyver13/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/macgyver13/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/macgyver13/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/macgyver13/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/macgyver13/bips/contributors",
        "deployments_url": "https://api.github.com/repos/macgyver13/bips/deployments",
        "downloads_url": "https://api.github.com/repos/macgyver13/bips/downloads",
        "events_url": "https://api.github.com/repos/macgyver13/bips/events",
        "forks_url": "https://api.github.com/repos/macgyver13/bips/forks",
        "git_commits_url": "https://api.github.com/repos/macgyver13/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/macgyver13/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/macgyver13/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/macgyver13/bips.git",
        "issue_comment_url": "https://api.github.com/repos/macgyver13/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/macgyver13/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/macgyver13/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/macgyver13/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/macgyver13/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/macgyver13/bips/languages",
        "merges_url": "https://api.github.com/repos/macgyver13/bips/merges",
        "milestones_url": "https://api.github.com/repos/macgyver13/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/macgyver13/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/macgyver13/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/macgyver13/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:macgyver13/bips.git",
        "stargazers_url": "https://api.github.com/repos/macgyver13/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/macgyver13/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/macgyver13/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/macgyver13/bips/subscription",
        "tags_url": "https://api.github.com/repos/macgyver13/bips/tags",
        "teams_url": "https://api.github.com/repos/macgyver13/bips/teams",
        "trees_url": "https://api.github.com/repos/macgyver13/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/macgyver13/bips.git",
        "hooks_url": "https://api.github.com/repos/macgyver13/bips/hooks",
        "svn_url": "https://github.com/macgyver13/bips",
        "homepage": "",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 18708,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-08T00:38:50Z",
        "created_at": "2025-09-04T13:56:58Z",
        "updated_at": "2025-09-04T13:56:58Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "e2f9fe0c04123553644a9641bc861f6092c9763a",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 14531737,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDUzMTczNw==",
        "name": "bips",
        "full_name": "bitcoin/bips",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bips",
        "description": "Bitcoin Improvement Proposals",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bips",
        "archive_url": "https://api.github.com/repos/bitcoin/bips/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bips/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bips/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bips/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bips/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bips/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bips/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bips/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bips/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bips/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bips/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bips/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bips/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bips/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bips/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bips/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bips/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bips.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bips/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bips/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bips/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bips/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bips/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bips/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bips/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bips/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bips/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bips/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bips/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bips.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bips/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bips/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bips/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bips/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bips/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bips/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bips/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bips.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bips/hooks",
        "svn_url": "https://github.com/bitcoin/bips",
        "homepage": "",
        "language": "Wikitext",
        "forks_count": 5870,
        "stargazers_count": 10495,
        "watchers_count": 10495,
        "size": 18029,
        "default_branch": "master",
        "open_issues_count": 71,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": false,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-14T21:44:18Z",
        "created_at": "2013-11-19T17:18:41Z",
        "updated_at": "2026-01-15T13:52:07Z",
        "allow_forking": true
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 1864,
    "deletions": 0,
    "changed_files": 8,
    "commits": 7,
    "review_comments": 8,
    "comments": 0
  },
  "events": [
    {
      "event": "mentioned",
      "id": 21205428668,
      "node_id": "MEE_lADOAN28mc7asTtGzwAAAATv8Sm8",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428668",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "subscribed",
      "id": 21205428684,
      "node_id": "SE_lADOAN28mc7asTtGzwAAAATv8SnM",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428684",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "mentioned",
      "id": 21205428711,
      "node_id": "MEE_lADOAN28mc7asTtGzwAAAATv8Snn",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428711",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "subscribed",
      "id": 21205428725,
      "node_id": "SE_lADOAN28mc7asTtGzwAAAATv8Sn1",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428725",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "mentioned",
      "id": 21205428744,
      "node_id": "MEE_lADOAN28mc7asTtGzwAAAATv8SoI",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428744",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "subscribed",
      "id": 21205428762,
      "node_id": "SE_lADOAN28mc7asTtGzwAAAATv8Soa",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21205428762",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T21:09:06Z"
    },
    {
      "event": "labeled",
      "id": 21225396898,
      "node_id": "LE_lADOAN28mc7asTtGzwAAAATxIdqi",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225396898",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:03:56Z",
      "label": {
        "name": "Proposed BIP modification",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 21225396913,
      "node_id": "LE_lADOAN28mc7asTtGzwAAAATxIdqx",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21225396913",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T17:03:56Z",
      "label": {
        "name": "Pending acceptance",
        "color": "fbca04"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21280944769,
      "node_id": "HRFPE_lADOAN28mc7asTtGzwAAAAT0cXKB",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21280944769",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "0018e4fc0f7c199f10c62168a638e07fbf9ae49a",
      "commit_url": "https://api.github.com/repos/macgyver13/bips/commits/0018e4fc0f7c199f10c62168a638e07fbf9ae49a",
      "created_at": "2025-12-01T16:25:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21338201577,
      "node_id": "HRFPE_lADOAN28mc7asTtGzwAAAAT32x3p",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21338201577",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d540a481cf8de748ab4c4c558d469d1b171eac1a",
      "commit_url": "https://api.github.com/repos/macgyver13/bips/commits/d540a481cf8de748ab4c4c558d469d1b171eac1a",
      "created_at": "2025-12-03T17:11:09Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21392102089,
      "node_id": "HRFPE_lADOAN28mc7asTtGzwAAAAT7EZLJ",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21392102089",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "88dec03debe1ce0dc4d765a52a7689a852fa4fde",
      "commit_url": "https://api.github.com/repos/macgyver13/bips/commits/88dec03debe1ce0dc4d765a52a7689a852fa4fde",
      "created_at": "2025-12-05T19:54:26Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDYxZDBjN2JkODA5MmVkNWRmNGE2NDZiZmVlMjQxYmM3NDUwNWYxYjM",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "tree": {
        "sha": "bbeec08e583b4d7c5b58c6f20b1acae7cae3e079",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/bbeec08e583b4d7c5b58c6f20b1acae7cae3e079"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/e2f9fe0c04123553644a9641bc861f6092c9763a",
          "sha": "e2f9fe0c04123553644a9641bc861f6092c9763a",
          "html_url": "https://github.com/bitcoin/bips/commit/e2f9fe0c04123553644a9641bc861f6092c9763a"
        }
      ],
      "message": "Add foundational PSBT parsing and basic validation\n\n- Add constants.py with BIP 375 PSBT field type definitions\n- Add parser.py with PSBT v2 structure parsing functions\n- Add minimal test_runner.py for basic structure validation\n- Validates PSBT magic bytes and parse-ability\n- All 17 test vectors pass basic structure checks\n- - Basic structure validation complete: 4 passed, 13 failed",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T16:22:46Z"
      },
      "sha": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDY3OGE1MTI3MGZjOTJiOWUyZjhmOGRjOGQ5YWQwOGI2NTNkNmEyZWI",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb",
      "tree": {
        "sha": "6db991998346240744feb310a09b67958dccdf3a",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/6db991998346240744feb310a09b67958dccdf3a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
          "sha": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
          "html_url": "https://github.com/bitcoin/bips/commit/61d0c7bd8092ed5df4a646bfee241bc74505f1b3"
        }
      ],
      "message": "Add input validation for silent payment eligibility\n\n- Add inputs.py with input type validation helpers\n- Add dependencies from previous work\n- - deps/bip352_utils.py\n- - deps/secp256k1_374.py\n- Validate eligible input types (P2PKH, P2WPKH, P2TR, P2SH-P2WPKH)\n- Check segwit version restrictions (v0-v1 only)\n- Verify P2SH inputs are P2SH-P2WPKH\n- Update test_runner.py to validate inputs\nInput validation complete: 6 passed, 11 failed",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T16:30:58Z"
      },
      "sha": "678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKGYzNWIyZTg2NjVjNGQxY2JkMmQ5NGM1OWNmNmVkNTZkM2QwNDFjNDM",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43",
      "tree": {
        "sha": "558769638aecfaedeb6a24f837b02260cb8a6bf5",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/558769638aecfaedeb6a24f837b02260cb8a6bf5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb",
          "sha": "678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb",
          "html_url": "https://github.com/bitcoin/bips/commit/678a51270fc92b9e2f8f8dc8d9ad08b653d6a2eb"
        }
      ],
      "message": "Add DLEQ proof validation for ECDH shares\n\n- Add dleq.py with DLEQ proof validation functions\n- Extract public keys from BIP32 derivation fields\n- Validate global and per-input DLEQ proofs using BIP-374\n- Verify scan key consistency between ECDH and DLEQ fields\n- Prevent conflicting global/per-input ECDH for same scan key\n- Check ECDH shares exist for silent payment outputs\n- Update test_runner.py with comprehensive DLEQ validation\nDLEQ validation complete: 14 passed, 3 failed",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T16:39:30Z"
      },
      "sha": "f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDdiNWVmNDY1YzgwY2QzMzZiN2Q1NTJmMWZkMjgzOTFmNjIxODVmMmE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/7b5ef465c80cd336b7d552f1fd28391f62185f2a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/7b5ef465c80cd336b7d552f1fd28391f62185f2a",
      "tree": {
        "sha": "909e4a74e426a4be386f2a7dec31cec0ff51257c",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/909e4a74e426a4be386f2a7dec31cec0ff51257c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43",
          "sha": "f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43",
          "html_url": "https://github.com/bitcoin/bips/commit/f35b2e8665c4d1cbd2d94c59cf6ed56d3d041c43"
        }
      ],
      "message": "Add complete BIP-375 PSBT validator\n\n- Add validator.py with comprehensive BIP-375 validation\n- Validate output field requirements (SCRIPT or SP_V0_INFO)\n- Check SP_V0_INFO field size (66 bytes)\n- Validate SP_V0_LABEL requires SP_V0_INFO\n- Enforce SIGHASH_ALL requirement for silent payments\n- Integrate all previous validation (inputs, DLEQ, ECDH)\n- Simplify test_runner.py to use validator module\n- Validation complete: 16 passed, 1 failed",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T16:49:51Z"
      },
      "sha": "7b5ef465c80cd336b7d552f1fd28391f62185f2a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDFkMzRhNDU0NzNkN2MxNmY5ZGY5YTdhMGExNTMwZDUzMzJmYjYwNjQ",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/1d34a45473d7c16f9df9a7a0a1530d5332fb6064",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/1d34a45473d7c16f9df9a7a0a1530d5332fb6064",
      "tree": {
        "sha": "c6f36c821899aeda37f6798ca3a8655b46b2da98",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/c6f36c821899aeda37f6798ca3a8655b46b2da98"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/7b5ef465c80cd336b7d552f1fd28391f62185f2a",
          "sha": "7b5ef465c80cd336b7d552f1fd28391f62185f2a",
          "html_url": "https://github.com/bitcoin/bips/commit/7b5ef465c80cd336b7d552f1fd28391f62185f2a"
        }
      ],
      "message": "Add BIP-352 output script validation - address mismatch test case\n\n- Add validate_bip352_outputs() for output script verification\n- Support both global and per-input ECDH share modes\n- Update test_runner.py to pass test material to validator",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T17:50:40Z"
      },
      "sha": "1d34a45473d7c16f9df9a7a0a1530d5332fb6064"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDI5ZjIzZTNkMWNhNDNiZmE1YmU0ZTYzMDI4Y2MxYzBjZmNiMzZkMjU",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25",
      "tree": {
        "sha": "440b09adfcea01940592f9bb90b9e882edc1261f",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/440b09adfcea01940592f9bb90b9e882edc1261f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/1d34a45473d7c16f9df9a7a0a1530d5332fb6064",
          "sha": "1d34a45473d7c16f9df9a7a0a1530d5332fb6064",
          "html_url": "https://github.com/bitcoin/bips/commit/1d34a45473d7c16f9df9a7a0a1530d5332fb6064"
        }
      ],
      "message": "Add README\n\n- Details core files and dependencies\n- Link to test_generator.py for vector generation\n- Provide usage instructions for test_runner.py",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:54Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2025-12-05T19:49:55Z"
      },
      "sha": "29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAN28mdoAKDQ1MTA2MzIyZWYzYjgwOWU2MWExM2Q5YjgxN2ViMzgxOTNmYTE5ZmE",
      "url": "https://api.github.com/repos/bitcoin/bips/git/commits/45106322ef3b809e61a13d9b817eb38193fa19fa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bips/commit/45106322ef3b809e61a13d9b817eb38193fa19fa",
      "tree": {
        "sha": "3a4da42c4c8d9809370ae27374d704f2d8c0e93c",
        "url": "https://api.github.com/repos/bitcoin/bips/git/trees/3a4da42c4c8d9809370ae27374d704f2d8c0e93c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bips/git/commits/29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25",
          "sha": "29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25",
          "html_url": "https://github.com/bitcoin/bips/commit/29f23e3d1ca43bfa5be4e63028cc1c0cfcb36d25"
        }
      ],
      "message": "Add new test vector \"Silent payment to recipient with SP change (label=0)\"\n\nFix compute output script ‘k’ bug - now increments for each output sharing the same scan key",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:37:03Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-07T21:34:16Z"
      },
      "sha": "45106322ef3b809e61a13d9b817eb38193fa19fa"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21911006939,
      "node_id": "HRFPE_lADOAN28mc7asTtGzwAAAAUZ_27b",
      "url": "https://api.github.com/repos/bitcoin/bips/issues/events/21911006939",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": "https://api.github.com/repos/macgyver13/bips/commits/45106322ef3b809e61a13d9b817eb38193fa19fa",
      "created_at": "2026-01-08T00:38:51Z"
    },
    {
      "event": "reviewed",
      "id": 3662407119,
      "node_id": "PRR_kwDOAN28mc7aS-XP",
      "url": null,
      "actor": null,
      "commit_id": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-14T19:29:09Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3662407119",
      "submitted_at": "2026-01-14T19:29:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3662438160,
      "node_id": "PRR_kwDOAN28mc7aTF8Q",
      "url": null,
      "actor": null,
      "commit_id": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-14T19:38:18Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3662438160",
      "submitted_at": "2026-01-14T19:38:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3662748681,
      "node_id": "PRR_kwDOAN28mc7aURwJ",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-14T20:58:34Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3662748681",
      "submitted_at": "2026-01-14T20:58:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3665712401,
      "node_id": "PRR_kwDOAN28mc7aflUR",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-15T13:43:23Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3665712401",
      "submitted_at": "2026-01-15T13:43:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3666917440,
      "node_id": "PRR_kwDOAN28mc7akLhA",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-15T18:05:59Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3666917440",
      "submitted_at": "2026-01-15T18:05:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3666923810,
      "node_id": "PRR_kwDOAN28mc7akNEi",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-15T18:08:05Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3666923810",
      "submitted_at": "2026-01-15T18:08:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3666956951,
      "node_id": "PRR_kwDOAN28mc7akVKX",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-15T18:15:10Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3666956951",
      "submitted_at": "2026-01-15T18:15:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    },
    {
      "event": "reviewed",
      "id": 3667008491,
      "node_id": "PRR_kwDOAN28mc7akhvr",
      "url": null,
      "actor": null,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-15T18:27:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "cACK 45106322ef3b809e61a13d9b817eb38193fa19fa\n\n- I haven't been able to decode the PSBT's using `bitcoin-cli decodepsbt` in a per test basis. Did you have any issues?\n\n- I would consider copying the approach taken in bitcoin/bips#2084, and use `secp256k1lab` here.\n\n- As each PSBT change is reflected in BIP 174, maybe is worth moving the parsing, fields and PSBT validation logic to BIP 174 directory, and keep the role logic of each protocol on its own directory, like here.\n\n\n\n",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bips/pull/2046#pullrequestreview-3667008491",
      "submitted_at": "2026-01-15T18:27:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2691755457",
      "pull_request_review_id": 3662407119,
      "id": 2691755457,
      "node_id": "PRRC_kwDOAN28mc6gcO3B",
      "diff_hunk": "@@ -0,0 +1,133 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+BIP 375: Test Runner\n+\n+Validates BIP 375 PSBT test vectors.\n+\"\"\"\n+\n+import argparse\n+import base64\n+import json\n+import sys\n+\n+from parser import parse_psbt_structure\n+\n+\n+def load_test_vectors(filename: str) -> dict:\n+    \"\"\"Load test vectors from JSON file\"\"\"\n+    try:\n+        with open(filename, \"r\") as f:\n+            return json.load(f)\n+    except FileNotFoundError:\n+        print(f\"Error: Test vector file '{filename}' not found\")\n+        sys.exit(1)\n+    except json.JSONDecodeError as e:\n+        print(f\"Error: Invalid JSON in test vector file: {e}\")\n+        sys.exit(1)\n+\n+\n+def validate_basic_structure(psbt_b64: str) -> tuple[bool, str]:\n+    \"\"\"Validate basic PSBT structure (magic bytes and parseability)\"\"\"\n+    try:\n+        # Decode PSBT\n+        psbt_data = base64.b64decode(psbt_b64)\n+\n+        # Check magic bytes\n+        if len(psbt_data) < 5 or psbt_data[:5] != b\"psbt\\xff\":\n+            return False, \"Invalid PSBT magic\"",
      "path": "bip-0375/test_runner.py",
      "position": 1,
      "original_position": 37,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This check is also in `parse_psbt_structure`. I would keep it only in one of both places.",
      "created_at": "2026-01-14T19:29:09Z",
      "updated_at": "2026-01-14T19:29:09Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2691755457",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2691755457"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2691781178",
      "pull_request_review_id": 3662438160,
      "id": 2691781178,
      "node_id": "PRRC_kwDOAN28mc6gcVI6",
      "diff_hunk": "@@ -0,0 +1,112 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+BIP 375: PSBT Structure Parser\n+\n+Functions for parsing PSBT v2 structure into global, input, and output field maps.\n+\"\"\"\n+\n+import struct\n+from typing import Dict, List, Tuple\n+\n+from constants import PSBTFieldType\n+\n+\n+def parse_psbt_structure(\n+    psbt_data: bytes,\n+) -> Tuple[Dict[int, bytes], List[Dict[int, bytes]], List[Dict[int, bytes]]]:\n+    \"\"\"Parse PSBT structure into global, input, and output field maps\"\"\"\n+\n+    def parse_compact_size_uint(data: bytes, offset: int) -> Tuple[int, int]:\n+        \"\"\"Parse compact size uint and return (value, new_offset)\"\"\"\n+        if offset >= len(data):\n+            raise ValueError(\"Not enough data\")\n+\n+        first_byte = data[offset]\n+        if first_byte < 0xFD:\n+            return first_byte, offset + 1\n+        elif first_byte == 0xFD:\n+            return struct.unpack(\"<H\", data[offset + 1 : offset + 3])[0], offset + 3\n+        elif first_byte == 0xFE:\n+            return struct.unpack(\"<L\", data[offset + 1 : offset + 5])[0], offset + 5\n+        else:\n+            return struct.unpack(\"<Q\", data[offset + 1 : offset + 9])[0], offset + 9\n+\n+    def parse_section(data: bytes, offset: int) -> Tuple[Dict[int, bytes], int]:\n+        \"\"\"Parse a PSBT section and return (field_map, new_offset)\"\"\"\n+        fields = {}\n+\n+        while offset < len(data):\n+            # Read key length\n+            key_len, offset = parse_compact_size_uint(data, offset)\n+            if key_len == 0:  # End of section\n+                break\n+\n+            # Read key data\n+            if offset + key_len > len(data):\n+                raise ValueError(\"Truncated key data\")\n+            key_data = data[offset : offset + key_len]\n+            offset += key_len\n+\n+            # Read value length\n+            value_len, offset = parse_compact_size_uint(data, offset)\n+\n+            # Read value data\n+            if offset + value_len > len(data):\n+                raise ValueError(\"Truncated value data\")\n+            value_data = data[offset : offset + value_len]\n+            offset += value_len\n+\n+            # Extract field type and handle key-value pairs\n+            if key_data:\n+                field_type = key_data[0]",
      "path": "bip-0375/parser.py",
      "position": 61,
      "original_position": 61,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "61d0c7bd8092ed5df4a646bfee241bc74505f1b3",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The extraction of `field_type` from `key_data` is odd. I would use de-structure assignment to keep them separated when assigning `key_data`, and also use the names stated in BIP 174, e.g.:\r\n```python\r\nkey_type, *key_data = data[offset : offset + key_len]\r\n```",
      "created_at": "2026-01-14T19:38:18Z",
      "updated_at": "2026-01-14T19:38:19Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2691781178",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2691781178"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 61,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2692028848",
      "pull_request_review_id": 3662748681,
      "id": 2692028848,
      "node_id": "PRRC_kwDOAN28mc6gdRmw",
      "diff_hunk": "@@ -0,0 +1,320 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+BIP 375: PSBT Validator\n+\n+Complete BIP 375 validation for PSBTs with silent payment outputs.\n+\"\"\"\n+\n+import hashlib\n+import struct\n+from typing import Tuple, List, Dict, Optional\n+\n+from constants import PSBTFieldType\n+from dleq import validate_global_dleq_proof, validate_input_dleq_proof\n+from inputs import validate_input_eligibility, check_invalid_segwit_version\n+from parser import parse_psbt_structure\n+# External references bip-0374\n+from secp256k1 import GE, G\n+\n+\n+def validate_bip375_psbt(\n+    psbt_data: bytes,\n+    input_keys: Optional[List[Dict]] = None,\n+) -> Tuple[bool, str]:\n+    \"\"\"Validate a PSBT according to BIP 375 rules\n+\n+    Args:\n+        psbt_data: Raw PSBT bytes\n+        input_keys: Optional list of input key material for BIP-352 validation\n+    \"\"\"\n+\n+    # Basic PSBT structure validation\n+    if len(psbt_data) < 5 or psbt_data[:5] != b\"psbt\\xff\":\n+        return False, \"Invalid PSBT magic\"\n+\n+    # Parse PSBT fields\n+    global_fields, input_maps, output_maps = parse_psbt_structure(psbt_data)\n+\n+    # Check if silent payment outputs exist\n+    # Either SP_V0_INFO or SP_V0_LABEL indicates silent payment intent\n+    has_silent_outputs = any(\n+        PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        or PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+        for output_fields in output_maps\n+    )\n+\n+    if not has_silent_outputs:\n+        # If no silent payment outputs, this is just a regular PSBT v2\n+        return True, \"Valid PSBT v2 (no silent payments)\"\n+\n+    # Critical structural validation - SP_V0_INFO field sizes and PSBT_OUT_SCRIPT requirements\n+    for i, output_fields in enumerate(output_maps):\n+        # BIP375: Each output must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO (or both)\n+        has_script = PSBTFieldType.PSBT_OUT_SCRIPT in output_fields\n+        has_sp_info = PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        has_sp_label = PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+\n+        if not has_script and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        # PSBT_OUT_SP_V0_LABEL requires PSBT_OUT_SP_V0_INFO\n+        if has_sp_label and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} has PSBT_OUT_SP_V0_LABEL but missing PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        if has_sp_info:\n+            sp_info = output_fields[PSBTFieldType.PSBT_OUT_SP_V0_INFO]\n+            if len(sp_info) != 66:  # 33 + 33 bytes for scan_key + spend_key\n+                return (\n+                    False,\n+                    f\"Output {i} SP_V0_INFO has wrong size ({len(sp_info)} bytes, expected 66)\",\n+                )\n+\n+    # ECDH shares must exist\n+    has_global_ecdh = PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE in global_fields\n+    has_input_ecdh = any(\n+        PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields\n+        for input_fields in input_maps\n+    )\n+\n+    if not has_global_ecdh and not has_input_ecdh:\n+        return False, \"Silent payment outputs present but no ECDH shares found\"\n+\n+    # Cannot have both global and per-input ECDH shares for same scan key\n+    if has_global_ecdh and has_input_ecdh:\n+        # Extract scan key from global ECDH share\n+        global_ecdh_field = global_fields[PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE]\n+        global_scan_key = global_ecdh_field[\"key\"]\n+\n+        # Check if any input has ECDH share for the same scan key\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                input_ecdh_field = input_fields[PSBTFieldType.PSBT_IN_SP_ECDH_SHARE]\n+                input_scan_key = input_ecdh_field[\"key\"]\n+                if input_scan_key == global_scan_key:\n+                    return (\n+                        False,\n+                        \"Cannot have both global and per-input ECDH shares for same scan key\",\n+                    )\n+\n+    # DLEQ proofs must exist for ECDH shares\n+    if has_global_ecdh:\n+        has_global_dleq = PSBTFieldType.PSBT_GLOBAL_SP_DLEQ in global_fields\n+        if not has_global_dleq:\n+            return False, \"Global ECDH share present but missing DLEQ proof\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if PSBTFieldType.PSBT_IN_SP_DLEQ not in input_fields:\n+                    return False, f\"Input {i} has ECDH share but missing DLEQ proof\"\n+\n+    # Verify DLEQ proofs\n+    if has_global_ecdh:\n+        if not validate_global_dleq_proof(global_fields, input_maps):\n+            return False, \"Global DLEQ proof verification failed\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if not validate_input_dleq_proof(input_fields, None, i):\n+                    return False, f\"Input {i} DLEQ proof verification failed\"\n+\n+    # Segwit version restrictions\n+    for i, input_fields in enumerate(input_maps):\n+        if PSBTFieldType.PSBT_IN_WITNESS_UTXO in input_fields:\n+            witness_utxo = input_fields[PSBTFieldType.PSBT_IN_WITNESS_UTXO]\n+            if check_invalid_segwit_version(witness_utxo):\n+                return False, f\"Input {i} uses segwit version > 1 with silent payments\"\n+\n+    # Eligible input type requirement\n+    # When silent payment outputs exist, ALL inputs must be eligible types",
      "path": "bip-0375/validator.py",
      "position": 136,
      "original_position": 136,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What does `ALL inputs must be eligible types` mean in this context?\r\nThis is checking all inputs are valid for shared secret derivation, which is not a condition all inputs must fulfill in order to create a silent payment transaction.",
      "created_at": "2026-01-14T20:58:34Z",
      "updated_at": "2026-01-14T21:24:10Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2692028848",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2692028848"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 136,
      "original_line": 136,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2694446003",
      "pull_request_review_id": 3665712401,
      "id": 2694446003,
      "node_id": "PRRC_kwDOAN28mc6gmfuz",
      "diff_hunk": "@@ -0,0 +1,320 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+BIP 375: PSBT Validator\n+\n+Complete BIP 375 validation for PSBTs with silent payment outputs.\n+\"\"\"\n+\n+import hashlib\n+import struct\n+from typing import Tuple, List, Dict, Optional\n+\n+from constants import PSBTFieldType\n+from dleq import validate_global_dleq_proof, validate_input_dleq_proof\n+from inputs import validate_input_eligibility, check_invalid_segwit_version\n+from parser import parse_psbt_structure\n+# External references bip-0374\n+from secp256k1 import GE, G\n+\n+\n+def validate_bip375_psbt(\n+    psbt_data: bytes,\n+    input_keys: Optional[List[Dict]] = None,\n+) -> Tuple[bool, str]:\n+    \"\"\"Validate a PSBT according to BIP 375 rules\n+\n+    Args:\n+        psbt_data: Raw PSBT bytes\n+        input_keys: Optional list of input key material for BIP-352 validation\n+    \"\"\"\n+\n+    # Basic PSBT structure validation\n+    if len(psbt_data) < 5 or psbt_data[:5] != b\"psbt\\xff\":\n+        return False, \"Invalid PSBT magic\"\n+\n+    # Parse PSBT fields\n+    global_fields, input_maps, output_maps = parse_psbt_structure(psbt_data)\n+\n+    # Check if silent payment outputs exist\n+    # Either SP_V0_INFO or SP_V0_LABEL indicates silent payment intent\n+    has_silent_outputs = any(\n+        PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        or PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+        for output_fields in output_maps\n+    )\n+\n+    if not has_silent_outputs:\n+        # If no silent payment outputs, this is just a regular PSBT v2\n+        return True, \"Valid PSBT v2 (no silent payments)\"\n+\n+    # Critical structural validation - SP_V0_INFO field sizes and PSBT_OUT_SCRIPT requirements\n+    for i, output_fields in enumerate(output_maps):\n+        # BIP375: Each output must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO (or both)\n+        has_script = PSBTFieldType.PSBT_OUT_SCRIPT in output_fields\n+        has_sp_info = PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        has_sp_label = PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+\n+        if not has_script and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        # PSBT_OUT_SP_V0_LABEL requires PSBT_OUT_SP_V0_INFO\n+        if has_sp_label and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} has PSBT_OUT_SP_V0_LABEL but missing PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        if has_sp_info:\n+            sp_info = output_fields[PSBTFieldType.PSBT_OUT_SP_V0_INFO]\n+            if len(sp_info) != 66:  # 33 + 33 bytes for scan_key + spend_key\n+                return (\n+                    False,\n+                    f\"Output {i} SP_V0_INFO has wrong size ({len(sp_info)} bytes, expected 66)\",\n+                )\n+\n+    # ECDH shares must exist\n+    has_global_ecdh = PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE in global_fields\n+    has_input_ecdh = any(\n+        PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields\n+        for input_fields in input_maps\n+    )\n+\n+    if not has_global_ecdh and not has_input_ecdh:\n+        return False, \"Silent payment outputs present but no ECDH shares found\"\n+\n+    # Cannot have both global and per-input ECDH shares for same scan key\n+    if has_global_ecdh and has_input_ecdh:\n+        # Extract scan key from global ECDH share\n+        global_ecdh_field = global_fields[PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE]\n+        global_scan_key = global_ecdh_field[\"key\"]\n+\n+        # Check if any input has ECDH share for the same scan key\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                input_ecdh_field = input_fields[PSBTFieldType.PSBT_IN_SP_ECDH_SHARE]\n+                input_scan_key = input_ecdh_field[\"key\"]\n+                if input_scan_key == global_scan_key:\n+                    return (\n+                        False,\n+                        \"Cannot have both global and per-input ECDH shares for same scan key\",\n+                    )\n+\n+    # DLEQ proofs must exist for ECDH shares\n+    if has_global_ecdh:\n+        has_global_dleq = PSBTFieldType.PSBT_GLOBAL_SP_DLEQ in global_fields\n+        if not has_global_dleq:\n+            return False, \"Global ECDH share present but missing DLEQ proof\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if PSBTFieldType.PSBT_IN_SP_DLEQ not in input_fields:\n+                    return False, f\"Input {i} has ECDH share but missing DLEQ proof\"\n+\n+    # Verify DLEQ proofs\n+    if has_global_ecdh:\n+        if not validate_global_dleq_proof(global_fields, input_maps):\n+            return False, \"Global DLEQ proof verification failed\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if not validate_input_dleq_proof(input_fields, None, i):\n+                    return False, f\"Input {i} DLEQ proof verification failed\"\n+\n+    # Segwit version restrictions\n+    for i, input_fields in enumerate(input_maps):\n+        if PSBTFieldType.PSBT_IN_WITNESS_UTXO in input_fields:\n+            witness_utxo = input_fields[PSBTFieldType.PSBT_IN_WITNESS_UTXO]\n+            if check_invalid_segwit_version(witness_utxo):\n+                return False, f\"Input {i} uses segwit version > 1 with silent payments\"\n+\n+    # Eligible input type requirement\n+    # When silent payment outputs exist, ALL inputs must be eligible types\n+    for i, input_fields in enumerate(input_maps):\n+        is_valid, error_msg = validate_input_eligibility(input_fields, i)\n+        if not is_valid:\n+            return False, error_msg\n+\n+    # SIGHASH_ALL requirement\n+    for i, input_fields in enumerate(input_maps):\n+        if PSBTFieldType.PSBT_IN_SIGHASH_TYPE in input_fields:\n+            sighash = input_fields[PSBTFieldType.PSBT_IN_SIGHASH_TYPE]\n+            if len(sighash) >= 4:\n+                sighash_type = struct.unpack(\"<I\", sighash[:4])[0]\n+                if sighash_type != 1:  # SIGHASH_ALL\n+                    return (\n+                        False,\n+                        f\"Input {i} uses non-SIGHASH_ALL ({sighash_type}) with silent payments\",\n+                    )\n+\n+    # Validate BIP-352 output scripts if test material provided\n+    if input_keys:\n+        is_valid, error_msg = validate_bip352_outputs(\n+            global_fields, input_maps, output_maps, input_keys\n+        )\n+        if not is_valid:\n+            return False, error_msg\n+\n+    return True, \"Valid BIP 375 PSBT\"\n+\n+\n+def validate_bip352_outputs(\n+    global_fields: Dict,\n+    input_maps: List[Dict],\n+    output_maps: List[Dict],\n+    input_keys: List[Dict],\n+) -> Tuple[bool, str]:\n+    \"\"\"Validate BIP-352 output script derivation (requires input_keys test material)\"\"\"\n+\n+    # Build outpoints list from PSBT inputs\n+    outpoints = []\n+    for input_fields in input_maps:\n+        if PSBTFieldType.PSBT_IN_PREVIOUS_TXID in input_fields:\n+            txid = input_fields[PSBTFieldType.PSBT_IN_PREVIOUS_TXID]\n+            output_index_bytes = input_fields.get(PSBTFieldType.PSBT_IN_OUTPUT_INDEX)\n+            if output_index_bytes and len(output_index_bytes) == 4:\n+                output_index = struct.unpack(\"<I\", output_index_bytes)[0]\n+                outpoints.append((txid, output_index))\n+\n+    # Track k values per scan key (k increments for each output per scan key)\n+    scan_key_k_values = {}\n+\n+    # Validate each silent payment output\n+    for output_idx, output_fields in enumerate(output_maps):\n+        # Only validate outputs with SP_V0_INFO (silent payment outputs)\n+        if PSBTFieldType.PSBT_OUT_SP_V0_INFO not in output_fields:\n+            continue\n+\n+        sp_info = output_fields[PSBTFieldType.PSBT_OUT_SP_V0_INFO]\n+        if len(sp_info) != 66:\n+            continue",
      "path": "bip-0375/validator.py",
      "position": 194,
      "original_position": 194,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Shouldn't this be a validation error?",
      "created_at": "2026-01-15T13:43:23Z",
      "updated_at": "2026-01-15T13:43:23Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2694446003",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2694446003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": 193,
      "original_start_line": 193,
      "start_side": "RIGHT",
      "line": 194,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2694459493",
      "pull_request_review_id": 3665728466,
      "id": 2694459493,
      "node_id": "PRRC_kwDOAN28mc6gmjBl",
      "diff_hunk": "@@ -0,0 +1,320 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+BIP 375: PSBT Validator\n+\n+Complete BIP 375 validation for PSBTs with silent payment outputs.\n+\"\"\"\n+\n+import hashlib\n+import struct\n+from typing import Tuple, List, Dict, Optional\n+\n+from constants import PSBTFieldType\n+from dleq import validate_global_dleq_proof, validate_input_dleq_proof\n+from inputs import validate_input_eligibility, check_invalid_segwit_version\n+from parser import parse_psbt_structure\n+# External references bip-0374\n+from secp256k1 import GE, G\n+\n+\n+def validate_bip375_psbt(\n+    psbt_data: bytes,\n+    input_keys: Optional[List[Dict]] = None,\n+) -> Tuple[bool, str]:\n+    \"\"\"Validate a PSBT according to BIP 375 rules\n+\n+    Args:\n+        psbt_data: Raw PSBT bytes\n+        input_keys: Optional list of input key material for BIP-352 validation\n+    \"\"\"\n+\n+    # Basic PSBT structure validation\n+    if len(psbt_data) < 5 or psbt_data[:5] != b\"psbt\\xff\":\n+        return False, \"Invalid PSBT magic\"\n+\n+    # Parse PSBT fields\n+    global_fields, input_maps, output_maps = parse_psbt_structure(psbt_data)\n+\n+    # Check if silent payment outputs exist\n+    # Either SP_V0_INFO or SP_V0_LABEL indicates silent payment intent\n+    has_silent_outputs = any(\n+        PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        or PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+        for output_fields in output_maps\n+    )\n+\n+    if not has_silent_outputs:\n+        # If no silent payment outputs, this is just a regular PSBT v2\n+        return True, \"Valid PSBT v2 (no silent payments)\"\n+\n+    # Critical structural validation - SP_V0_INFO field sizes and PSBT_OUT_SCRIPT requirements\n+    for i, output_fields in enumerate(output_maps):\n+        # BIP375: Each output must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO (or both)\n+        has_script = PSBTFieldType.PSBT_OUT_SCRIPT in output_fields\n+        has_sp_info = PSBTFieldType.PSBT_OUT_SP_V0_INFO in output_fields\n+        has_sp_label = PSBTFieldType.PSBT_OUT_SP_V0_LABEL in output_fields\n+\n+        if not has_script and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} must have either PSBT_OUT_SCRIPT or PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        # PSBT_OUT_SP_V0_LABEL requires PSBT_OUT_SP_V0_INFO\n+        if has_sp_label and not has_sp_info:\n+            return (\n+                False,\n+                f\"Output {i} has PSBT_OUT_SP_V0_LABEL but missing PSBT_OUT_SP_V0_INFO\",\n+            )\n+\n+        if has_sp_info:\n+            sp_info = output_fields[PSBTFieldType.PSBT_OUT_SP_V0_INFO]\n+            if len(sp_info) != 66:  # 33 + 33 bytes for scan_key + spend_key\n+                return (\n+                    False,\n+                    f\"Output {i} SP_V0_INFO has wrong size ({len(sp_info)} bytes, expected 66)\",\n+                )\n+\n+    # ECDH shares must exist\n+    has_global_ecdh = PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE in global_fields\n+    has_input_ecdh = any(\n+        PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields\n+        for input_fields in input_maps\n+    )\n+\n+    if not has_global_ecdh and not has_input_ecdh:\n+        return False, \"Silent payment outputs present but no ECDH shares found\"\n+\n+    # Cannot have both global and per-input ECDH shares for same scan key\n+    if has_global_ecdh and has_input_ecdh:\n+        # Extract scan key from global ECDH share\n+        global_ecdh_field = global_fields[PSBTFieldType.PSBT_GLOBAL_SP_ECDH_SHARE]\n+        global_scan_key = global_ecdh_field[\"key\"]\n+\n+        # Check if any input has ECDH share for the same scan key\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                input_ecdh_field = input_fields[PSBTFieldType.PSBT_IN_SP_ECDH_SHARE]\n+                input_scan_key = input_ecdh_field[\"key\"]\n+                if input_scan_key == global_scan_key:\n+                    return (\n+                        False,\n+                        \"Cannot have both global and per-input ECDH shares for same scan key\",\n+                    )\n+\n+    # DLEQ proofs must exist for ECDH shares\n+    if has_global_ecdh:\n+        has_global_dleq = PSBTFieldType.PSBT_GLOBAL_SP_DLEQ in global_fields\n+        if not has_global_dleq:\n+            return False, \"Global ECDH share present but missing DLEQ proof\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if PSBTFieldType.PSBT_IN_SP_DLEQ not in input_fields:\n+                    return False, f\"Input {i} has ECDH share but missing DLEQ proof\"\n+\n+    # Verify DLEQ proofs\n+    if has_global_ecdh:\n+        if not validate_global_dleq_proof(global_fields, input_maps):\n+            return False, \"Global DLEQ proof verification failed\"\n+\n+    if has_input_ecdh:\n+        for i, input_fields in enumerate(input_maps):\n+            if PSBTFieldType.PSBT_IN_SP_ECDH_SHARE in input_fields:\n+                if not validate_input_dleq_proof(input_fields, None, i):\n+                    return False, f\"Input {i} DLEQ proof verification failed\"\n+\n+    # Segwit version restrictions\n+    for i, input_fields in enumerate(input_maps):\n+        if PSBTFieldType.PSBT_IN_WITNESS_UTXO in input_fields:\n+            witness_utxo = input_fields[PSBTFieldType.PSBT_IN_WITNESS_UTXO]\n+            if check_invalid_segwit_version(witness_utxo):\n+                return False, f\"Input {i} uses segwit version > 1 with silent payments\"\n+\n+    # Eligible input type requirement\n+    # When silent payment outputs exist, ALL inputs must be eligible types\n+    for i, input_fields in enumerate(input_maps):\n+        is_valid, error_msg = validate_input_eligibility(input_fields, i)\n+        if not is_valid:\n+            return False, error_msg\n+\n+    # SIGHASH_ALL requirement\n+    for i, input_fields in enumerate(input_maps):\n+        if PSBTFieldType.PSBT_IN_SIGHASH_TYPE in input_fields:\n+            sighash = input_fields[PSBTFieldType.PSBT_IN_SIGHASH_TYPE]\n+            if len(sighash) >= 4:\n+                sighash_type = struct.unpack(\"<I\", sighash[:4])[0]\n+                if sighash_type != 1:  # SIGHASH_ALL\n+                    return (\n+                        False,\n+                        f\"Input {i} uses non-SIGHASH_ALL ({sighash_type}) with silent payments\",\n+                    )\n+\n+    # Validate BIP-352 output scripts if test material provided\n+    if input_keys:\n+        is_valid, error_msg = validate_bip352_outputs(\n+            global_fields, input_maps, output_maps, input_keys\n+        )\n+        if not is_valid:\n+            return False, error_msg\n+\n+    return True, \"Valid BIP 375 PSBT\"\n+\n+\n+def validate_bip352_outputs(\n+    global_fields: Dict,\n+    input_maps: List[Dict],\n+    output_maps: List[Dict],\n+    input_keys: List[Dict],\n+) -> Tuple[bool, str]:\n+    \"\"\"Validate BIP-352 output script derivation (requires input_keys test material)\"\"\"\n+\n+    # Build outpoints list from PSBT inputs\n+    outpoints = []\n+    for input_fields in input_maps:\n+        if PSBTFieldType.PSBT_IN_PREVIOUS_TXID in input_fields:\n+            txid = input_fields[PSBTFieldType.PSBT_IN_PREVIOUS_TXID]\n+            output_index_bytes = input_fields.get(PSBTFieldType.PSBT_IN_OUTPUT_INDEX)\n+            if output_index_bytes and len(output_index_bytes) == 4:\n+                output_index = struct.unpack(\"<I\", output_index_bytes)[0]\n+                outpoints.append((txid, output_index))\n+\n+    # Track k values per scan key (k increments for each output per scan key)\n+    scan_key_k_values = {}\n+\n+    # Validate each silent payment output\n+    for output_idx, output_fields in enumerate(output_maps):\n+        # Only validate outputs with SP_V0_INFO (silent payment outputs)\n+        if PSBTFieldType.PSBT_OUT_SP_V0_INFO not in output_fields:\n+            continue\n+\n+        sp_info = output_fields[PSBTFieldType.PSBT_OUT_SP_V0_INFO]\n+        if len(sp_info) != 66:\n+            continue",
      "path": "bip-0375/validator.py",
      "position": 194,
      "original_position": 194,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": 2694446003,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I see, you're doing validation before. Ignore this comment.",
      "created_at": "2026-01-15T13:47:10Z",
      "updated_at": "2026-01-15T13:47:10Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2694459493",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2694459493"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": 193,
      "original_start_line": 193,
      "start_side": "RIGHT",
      "line": 194,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695433074",
      "pull_request_review_id": 3666917440,
      "id": 2695433074,
      "node_id": "PRRC_kwDOAN28mc6gqQty",
      "diff_hunk": "@@ -0,0 +1,833 @@\n+{\n+  \"description\": \"BIP 375 Test Vectors - All Scenarios\",\n+  \"version\": \"1.0\",\n+  \"format_notes\": [\n+    \"All keys are hex-encoded\",\n+    \"PSBTs have all necessary fields\",\n+    \"Test vectors are organized into 'invalid' and 'valid' arrays\",\n+    \"Comment provides additional context for all test cases\"\n+  ],\n+  \"invalid\": [\n+    {\n+      \"description\": \"Missing DLEQ proof for ECDH share\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCrtYht20vGCALx8ZiisSkDZZzJ7nPgIx1FVehBiNyWQAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8BAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAXu7qlEuAw+8o+5RT3sjgH4RGDGkdFRHCRNMn5v0a2xAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"abb5886ddb4bc60802f1f198a2b12903659cc9ee73e0231d4555e84188dc9640\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": null,\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512017bbbaa512e030fbca3ee514f7b23807e111831a474544709134c9f9bf46b6c4\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"PSBT_IN_SP_ECDH_SHARE without corresponding PSBT_IN_SP_DLEQ\"\n+    },\n+    {\n+      \"description\": \"Invalid DLEQ proof\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiBJpgB4JAmRsNt6srOq9JqFCEYGmw7mPo8/4lJ2+/nPoAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+ECB1dab73m7/xP6o4gDeMISP8SUJ7Lb0cTBayb1WDeYZi1u5ekG4K3g7oO2Cor11Y5A758GvXy2nF0tx1E7u/5hAQMEAQAAAAABAwgYcwEAAAAAAAEEIlEgsuRy0TOUWM9fKDzk0MnUwzY/UdSp9SkkH4SdztRbddABCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"49a60078240991b0db7ab2b3aaf49a850846069b0ee63e8f3fe25276fbf9cfa0\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"81d5d69bef79bbff13faa3880378c2123fc49427b2dbd1c4c16b26f5583798662d6ee5e906e0ade0ee83b60a8af5d58e40ef9f06bd7cb69c5d2dc7513bbbfe61\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120b2e472d1339458cf5f283ce4d0c9d4c3363f51d4a9f529241f849dced45b75d0\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"DLEQ proof verification failed\"\n+    },\n+    {\n+      \"description\": \"Non-SIGHASH_ALL signature with silent payments\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCfF8iU72tyS4+7lJj0TTc8KFCARRz/QDHgOTLIuPm2twEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQCAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAfNn2bwSJU+NoXtyj8XaZFSWYvOykbyFO0rjN/aSdtqAHj4lLZt/ZimcG5oc68kn132TsyYRE6RNyl32W+tgrQwABAwgYcwEAAAAAAAEEIlEgdE4JlR8XtYJIPHoMCMBib+rDZmk8hPrzngNLYS3o3HEBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"9f17c894ef6b724b8fbb9498f44d373c285080451cff4031e03932c8b8f9b6b7\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"7cd9f66f048953e3685edca3f17699152598bceca46f214ed2b8cdfda49db6a0078f894b66dfd98a6706e6873af249f5df64ecc98444e91372977d96fad82b43\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120744e09951f17b582483c7a0c08c0626feac366693c84faf39e034b612de8dc71\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"Silent payment outputs require SIGHASH_ALL signatures only\"\n+    },\n+    {\n+      \"description\": \"Mixed segwit versions with silent payments\",",
      "path": "bip-0375/test_vectors.json",
      "position": 144,
      "original_position": 144,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I would prefer explicitness rather than conciseness in test case descriptions: `Input with segwit script version greater than 1`, even if it is more verbose.",
      "created_at": "2026-01-15T18:05:59Z",
      "updated_at": "2026-01-15T18:05:59Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2695433074",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695433074"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 144,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695438672",
      "pull_request_review_id": 3666923810,
      "id": 2695438672,
      "node_id": "PRRC_kwDOAN28mc6gqSFQ",
      "diff_hunk": "@@ -0,0 +1,833 @@\n+{\n+  \"description\": \"BIP 375 Test Vectors - All Scenarios\",\n+  \"version\": \"1.0\",\n+  \"format_notes\": [\n+    \"All keys are hex-encoded\",\n+    \"PSBTs have all necessary fields\",\n+    \"Test vectors are organized into 'invalid' and 'valid' arrays\",\n+    \"Comment provides additional context for all test cases\"\n+  ],\n+  \"invalid\": [\n+    {\n+      \"description\": \"Missing DLEQ proof for ECDH share\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCrtYht20vGCALx8ZiisSkDZZzJ7nPgIx1FVehBiNyWQAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8BAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAXu7qlEuAw+8o+5RT3sjgH4RGDGkdFRHCRNMn5v0a2xAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"abb5886ddb4bc60802f1f198a2b12903659cc9ee73e0231d4555e84188dc9640\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": null,\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512017bbbaa512e030fbca3ee514f7b23807e111831a474544709134c9f9bf46b6c4\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"PSBT_IN_SP_ECDH_SHARE without corresponding PSBT_IN_SP_DLEQ\"\n+    },\n+    {\n+      \"description\": \"Invalid DLEQ proof\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiBJpgB4JAmRsNt6srOq9JqFCEYGmw7mPo8/4lJ2+/nPoAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+ECB1dab73m7/xP6o4gDeMISP8SUJ7Lb0cTBayb1WDeYZi1u5ekG4K3g7oO2Cor11Y5A758GvXy2nF0tx1E7u/5hAQMEAQAAAAABAwgYcwEAAAAAAAEEIlEgsuRy0TOUWM9fKDzk0MnUwzY/UdSp9SkkH4SdztRbddABCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"49a60078240991b0db7ab2b3aaf49a850846069b0ee63e8f3fe25276fbf9cfa0\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"81d5d69bef79bbff13faa3880378c2123fc49427b2dbd1c4c16b26f5583798662d6ee5e906e0ade0ee83b60a8af5d58e40ef9f06bd7cb69c5d2dc7513bbbfe61\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120b2e472d1339458cf5f283ce4d0c9d4c3363f51d4a9f529241f849dced45b75d0\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"DLEQ proof verification failed\"\n+    },\n+    {\n+      \"description\": \"Non-SIGHASH_ALL signature with silent payments\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCfF8iU72tyS4+7lJj0TTc8KFCARRz/QDHgOTLIuPm2twEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQCAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAfNn2bwSJU+NoXtyj8XaZFSWYvOykbyFO0rjN/aSdtqAHj4lLZt/ZimcG5oc68kn132TsyYRE6RNyl32W+tgrQwABAwgYcwEAAAAAAAEEIlEgdE4JlR8XtYJIPHoMCMBib+rDZmk8hPrzngNLYS3o3HEBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"9f17c894ef6b724b8fbb9498f44d373c285080451cff4031e03932c8b8f9b6b7\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"7cd9f66f048953e3685edca3f17699152598bceca46f214ed2b8cdfda49db6a0078f894b66dfd98a6706e6873af249f5df64ecc98444e91372977d96fad82b43\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120744e09951f17b582483c7a0c08c0626feac366693c84faf39e034b612de8dc71\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"Silent payment outputs require SIGHASH_ALL signatures only\"\n+    },\n+    {\n+      \"description\": \"Mixed segwit versions with silent payments\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCuv6p7LnQnsTi6F7UesBJ3TJOXBoHuPhb2Y3hjUklAJAEPBAAAAAABASughgEAAAAAACJSIIYiz2yIzTx5hSOFG+T1WYNgEYY+sDBYObtzXueh9KPpARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgIZ6/eW18O5peg4tLa+KXfHTrjWr+b09YgAaz1sNh63wBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",",
      "path": "bip-0375/test_vectors.json",
      "position": 145,
      "original_position": 145,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I wasn't able to decode this psbt as it is using `bitcoin-cli`, have you?\r\n\r\nP.S.: I converted to hex and was able to decode, but it feels as something was off with `bitcoin-cli`.",
      "created_at": "2026-01-15T18:08:05Z",
      "updated_at": "2026-01-15T18:09:21Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2695438672",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695438672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 145,
      "original_line": 145,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695460669",
      "pull_request_review_id": 3666956951,
      "id": 2695460669,
      "node_id": "PRRC_kwDOAN28mc6gqXc9",
      "diff_hunk": "@@ -0,0 +1,833 @@\n+{\n+  \"description\": \"BIP 375 Test Vectors - All Scenarios\",\n+  \"version\": \"1.0\",\n+  \"format_notes\": [\n+    \"All keys are hex-encoded\",\n+    \"PSBTs have all necessary fields\",\n+    \"Test vectors are organized into 'invalid' and 'valid' arrays\",\n+    \"Comment provides additional context for all test cases\"\n+  ],\n+  \"invalid\": [\n+    {\n+      \"description\": \"Missing DLEQ proof for ECDH share\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCrtYht20vGCALx8ZiisSkDZZzJ7nPgIx1FVehBiNyWQAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8BAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAXu7qlEuAw+8o+5RT3sjgH4RGDGkdFRHCRNMn5v0a2xAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"abb5886ddb4bc60802f1f198a2b12903659cc9ee73e0231d4555e84188dc9640\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": null,\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512017bbbaa512e030fbca3ee514f7b23807e111831a474544709134c9f9bf46b6c4\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"PSBT_IN_SP_ECDH_SHARE without corresponding PSBT_IN_SP_DLEQ\"\n+    },\n+    {\n+      \"description\": \"Invalid DLEQ proof\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiBJpgB4JAmRsNt6srOq9JqFCEYGmw7mPo8/4lJ2+/nPoAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+ECB1dab73m7/xP6o4gDeMISP8SUJ7Lb0cTBayb1WDeYZi1u5ekG4K3g7oO2Cor11Y5A758GvXy2nF0tx1E7u/5hAQMEAQAAAAABAwgYcwEAAAAAAAEEIlEgsuRy0TOUWM9fKDzk0MnUwzY/UdSp9SkkH4SdztRbddABCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"49a60078240991b0db7ab2b3aaf49a850846069b0ee63e8f3fe25276fbf9cfa0\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"81d5d69bef79bbff13faa3880378c2123fc49427b2dbd1c4c16b26f5583798662d6ee5e906e0ade0ee83b60a8af5d58e40ef9f06bd7cb69c5d2dc7513bbbfe61\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120b2e472d1339458cf5f283ce4d0c9d4c3363f51d4a9f529241f849dced45b75d0\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"DLEQ proof verification failed\"\n+    },\n+    {\n+      \"description\": \"Non-SIGHASH_ALL signature with silent payments\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCfF8iU72tyS4+7lJj0TTc8KFCARRz/QDHgOTLIuPm2twEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQCAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAfNn2bwSJU+NoXtyj8XaZFSWYvOykbyFO0rjN/aSdtqAHj4lLZt/ZimcG5oc68kn132TsyYRE6RNyl32W+tgrQwABAwgYcwEAAAAAAAEEIlEgdE4JlR8XtYJIPHoMCMBib+rDZmk8hPrzngNLYS3o3HEBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"9f17c894ef6b724b8fbb9498f44d373c285080451cff4031e03932c8b8f9b6b7\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"7cd9f66f048953e3685edca3f17699152598bceca46f214ed2b8cdfda49db6a0078f894b66dfd98a6706e6873af249f5df64ecc98444e91372977d96fad82b43\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120744e09951f17b582483c7a0c08c0626feac366693c84faf39e034b612de8dc71\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"Silent payment outputs require SIGHASH_ALL signatures only\"\n+    },\n+    {\n+      \"description\": \"Mixed segwit versions with silent payments\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCuv6p7LnQnsTi6F7UesBJ3TJOXBoHuPhb2Y3hjUklAJAEPBAAAAAABASughgEAAAAAACJSIIYiz2yIzTx5hSOFG+T1WYNgEYY+sDBYObtzXueh9KPpARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgIZ6/eW18O5peg4tLa+KXfHTrjWr+b09YgAaz1sNh63wBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"aebfaa7b2e7427b138ba17b51eb012774c93970681ee3e16f663786352494024\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"52208622cf6c88cd3c798523851be4f559836011863eb0305839bb735ee7a1f4a3e9\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a0860100000000002252208622cf6c88cd3c798523851be4f559836011863eb0305839bb735ee7a1f4a3e9\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120219ebf796d7c3b9a5e838b4b6be2977c74eb8d6afe6f4f588006b3d6c361eb7c\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"mixed_segwit\"\n+    },\n+    {\n+      \"description\": \"Silent payment outputs but no ECDH shares\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiAkKwMCMdEgYFJ2eRmpLxfpzUNydadt47rD+2VnyyekwwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAE49PFUgTAYIPf3lo2ltGczidvHq5eXgsw3uhama8pVgEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"242b030231d1206052767919a92f17e9cd437275a76de3bac3fb6567cb27a4c3\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512004e3d3c55204c06083dfde5a3696d19cce276f1eae5e5e0b30dee85a99af2956\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"no_ecdh_shares\"\n+    },\n+    {\n+      \"description\": \"Global ECDH share without DLEQ proof\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAyIHAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/wABDiD2W3/BmfoPsrzNsfoGEte1D2K0+PqV1WXEoB9MWC6SpAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSCBAAI55HC7UjfZ+r6wGeJ5j8RXLnnJOQtdHV42G7fgIAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"f65b7fc199fa0fb2bccdb1fa0612d7b50f62b4f8fa95d565c4a01f4c582e92a4\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": null,\n+          \"is_global\": true,\n+          \"input_index\": null\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512081000239e470bb5237d9fabeb019e2798fc4572e79c9390b5d1d5e361bb7e020\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"missing_global_dleq\"\n+    },\n+    {\n+      \"description\": \"Wrong SP_V0_INFO field size\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiBhb07a0EqylXgp4bK5tBHX2y2Sc2xQAy4NalHiyZy13gEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgqx9NHhF5eGF2DneK22zBZvlqth3Rr4eZ5lH0FTIh7JMBCUEC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRAA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"616f4edad04ab2957829e1b2b9b411d7db2d92736c50032e0d6a51e2c99cb5de\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120ab1f4d1e11797861760e778adb6cc166f96ab61dd1af8799e651f4153221ec93\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde4921144\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"wrong_sp_info_size\"\n+    },\n+    {\n+      \"description\": \"Mixed eligible and ineligible input types\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQBAAAAAQYBAwABDiApw6Peut1f6dS0XD295x0CWioK+UM7tO+6i0Pv5za0oQEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+EDB1n84eIK/gXkV6hWCHWTVs4NcH8BcVYzj2CSSoX2QjBBIfbub3cEIDIwtnBlxsmYIPGkFTiIZPyRBKKxmc35gAAEOILbM9qpt6XebBi77G8FTHGWl57KukFWmYqsFQG8N9EfUAQ8EAAAAAAEQBP7///8BAFMCAAAAAeQ/TH2g2e+DCDNBekstaV4FoHWp1MBWN7X86t8ZX5WyAAAAAAD/////AfBJAgAAAAAAF6kUY3evt1S5inYSGc8WdvySwjeEULaHAAAAAAEER1IhAo8dCC1gAfpLqJmkA9r5sdsBvpJcIlM69jDuZJOwvp95IQM1iX7FrnBP5V2OpdRnsK69s3mb4Qw2BHHZt4nIEa/eO1KuAAEDCJBfAQAAAAAAAQQiUSDsAiz0NrWnm7cXwbLngQA8S0LMDyzAhBLXhwYsyqNHgwEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"29c3a3debadd5fe9d4b45c3dbde71d025a2a0af9433bb4efba8b43efe736b4a1\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        },\n+        {\n+          \"input_index\": 1,\n+          \"private_key\": \"b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056\",\n+          \"public_key\": \"028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79\",\n+          \"prevout_txid\": \"b6ccf6aa6de9779b062efb1bc1531c65a5e7b2ae9055a662ab05406f0df447d4\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"a9146377afb754b98a761219cf1676fc92c2378450b687\",\n+          \"amount\": 150000,\n+          \"witness_utxo\": \"0200000001e43f4c7da0d9ef830833417a4b2d695e05a075a9d4c05637b5fceadf195f95b20000000000ffffffff01f04902000000000017a9146377afb754b98a761219cf1676fc92c2378450b68700000000\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 90000,\n+          \"script\": \"5120ec022cf436b5a79bb717c1b2e781003c4b42cc0f2cc08412d787062ccaa34783\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"P2WPKH and P2SH multisig mixed - only P2WPKH is eligible\"\n+    },\n+    {\n+      \"description\": \"Wrong ECDH share size\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiC1ovhHRrNOgzq0ftE7S5hwtBwhRvo0a3NKnEftiiROwwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPggAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+YsAAQMIGHMBAAAAAAABBCJRIIAwkkgvJinSnZhZELCCxoyiB8DtQD2Nh7Ac6dO/cfgBAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAA==\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"b5a2f84746b34e833ab47ed13b4b9870b41c2146fa346b734a9c47ed8a244ec3\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120803092482f2629d29d985910b082c68ca207c0ed403d8d87b01ce9d3bf71f801\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"ECDH share must be 33 bytes\"\n+    },\n+    {\n+      \"description\": \"Wrong DLEQ proof size\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiA78BpakVw0yvjzRht09tYBDcMoUSAE43p653aHic5dEwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPg/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEDCBhzAQAAAAAAAQQiUSDtdP0G8Hjd7PFuoDosE3hSYzYMLSEIV++xEaqAMWmt+wEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"3bf01a5a915c34caf8f3461b74f6d6010dc328512004e37a7ae7768789ce5d13\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120ed74fd06f078ddecf16ea03a2c13785263360c2d210857efb111aa803169adfb\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"DLEQ proof must be 64 bytes\"\n+    },\n+    {\n+      \"description\": \"Label without SP_V0_INFO\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiCYIQIrPQiMfZ8vxvALHE0JCEOOoHYl2kTD+2DBdIFEqgEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAAAQMIGHMBAAAAAAABBCJRICPE97d2KoVw4KmW77zDea7n/IowriFuMhY4RHSeKDQ7AQoEAQAAAAA=\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"9821022b3d088c7d9f2fc6f00b1c4d0908438ea07625da44c3fb60c1748144aa\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [],\n+      \"expected_ecdh_shares\": [],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"512023c4f7b7762a8570e0a996efbcc379aee7fc8a30ae216e32163844749e28343b\",\n+          \"is_silent_payment\": false,\n+          \"sp_info\": null,\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"PSBT_OUT_SP_V0_LABEL requires PSBT_OUT_SP_V0_INFO\"\n+    },\n+    {\n+      \"description\": \"Address mismatch\",\n+      \"psbt\": \"cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAwABDiBumss8ldbK7k1KciUCaeuPPQVy7U+E9Lf8M6mavj46BQEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgzeOdiwW0lvjxjyCyfQr5oyMzCeBHIhnggT/ztdN4fikBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA\",\n+      \"input_keys\": [\n+        {\n+          \"input_index\": 0,\n+          \"private_key\": \"e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9\",\n+          \"public_key\": \"03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d\",\n+          \"prevout_txid\": \"6e9acb3c95d6caee4d4a72250269eb8f3d0572ed4f84f4b7fc33a99abe3e3a05\",\n+          \"prevout_index\": 0,\n+          \"prevout_scriptpubkey\": \"0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"amount\": 100000,\n+          \"witness_utxo\": \"a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c\",\n+          \"sequence\": 4294967295\n+        }\n+      ],\n+      \"scan_keys\": [\n+        {\n+          \"scan_pubkey\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"spend_pubkey\": \"024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"label\": null\n+        }\n+      ],\n+      \"expected_ecdh_shares\": [\n+        {\n+          \"scan_key\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8\",\n+          \"ecdh_result\": \"0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff\",\n+          \"dleq_proof\": \"c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60\",\n+          \"is_global\": false,\n+          \"input_index\": 0\n+        }\n+      ],\n+      \"expected_outputs\": [\n+        {\n+          \"output_index\": 0,\n+          \"amount\": 95000,\n+          \"script\": \"5120cde39d8b05b496f8f18f20b27d0af9a3233309e0472219e0813ff3b5d3787e29\",\n+          \"is_silent_payment\": true,\n+          \"sp_info\": \"02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b\",\n+          \"sp_label\": null\n+        }\n+      ],\n+      \"comment\": \"Output script doesn't match BIP-352 computed address\"",
      "path": "bip-0375/test_vectors.json",
      "position": 510,
      "original_position": 510,
      "commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "original_commit_id": "45106322ef3b809e61a13d9b817eb38193fa19fa",
      "in_reply_to_id": null,
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What's the difference between `comment` and `description`? Could we keep only one?",
      "created_at": "2026-01-15T18:15:10Z",
      "updated_at": "2026-01-15T18:15:10Z",
      "html_url": "https://github.com/bitcoin/bips/pull/2046#discussion_r2695460669",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/comments/2695460669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bips/pulls/2046"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 510,
      "original_line": 510,
      "side": "RIGHT"
    }
  ]
}